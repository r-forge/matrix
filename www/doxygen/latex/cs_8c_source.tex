\doxysection{cs.\+c}
\hypertarget{cs_8c_source}{}\label{cs_8c_source}\index{cs.c@{cs.c}}
\mbox{\hyperlink{cs_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00001}00001\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cs_8h}{cs.h}}"{}}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00002}00002\ \textcolor{comment}{/*\ C\ =\ alpha*A\ +\ beta*B\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00003}\mbox{\hyperlink{cs_8c_ac549d2c79490db68e4c9361a951144dd}{00003}}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *\mbox{\hyperlink{cs_8c_ac549d2c79490db68e4c9361a951144dd}{cs\_add}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *B,\ \textcolor{keywordtype}{double}\ alpha,\ \textcolor{keywordtype}{double}\ beta)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00004}00004\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00005}00005\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ p,\ j,\ nz\ =\ 0,\ anz,\ *Cp,\ *Ci,\ *Bp,\ m,\ n,\ bnz,\ *w,\ values\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00006}00006\ \ \ \ \ \textcolor{keywordtype}{double}\ *x,\ *Bx,\ *Cx\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00007}00007\ \ \ \ \ \mbox{\hyperlink{structcs__sparse}{cs}}\ *C\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00008}00008\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A)\ ||\ !\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (B))\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00009}00009\ \ \ \ \ \textcolor{keywordflow}{if}\ (A-\/>\mbox{\hyperlink{structcs__sparse_a8dab81f7d781bd65c7cb4f103db87ade}{m}}\ !=\ B-\/>\mbox{\hyperlink{structcs__sparse_a8dab81f7d781bd65c7cb4f103db87ade}{m}}\ ||\ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ !=\ B-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}})\ \textcolor{keywordflow}{return}\ (NULL)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00010}00010\ \ \ \ \ m\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a8dab81f7d781bd65c7cb4f103db87ade}{m}}\ ;\ anz\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ [A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00011}00011\ \ \ \ \ n\ =\ B-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;\ Bp\ =\ B-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Bx\ =\ B-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;\ bnz\ =\ Bp\ [n]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00012}00012\ \ \ \ \ w\ =\ \mbox{\hyperlink{cs_8c_a071e69dcb222391d3add6c5220a79f51}{cs\_calloc}}\ (m,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ get\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00013}00013\ \ \ \ \ values\ =\ (A-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ !=\ NULL)\ \&\&\ (Bx\ !=\ NULL)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00014}00014\ \ \ \ \ x\ =\ values\ ?\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (m,\ \textcolor{keyword}{sizeof}\ (\textcolor{keywordtype}{double}))\ :\ NULL\ ;\ \ \ \ \textcolor{comment}{/*\ get\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00015}00015\ \ \ \ \ C\ =\ \mbox{\hyperlink{cs_8c_af3ed6e2936760b1b53b79fe3ed5cc8b6}{cs\_spalloc}}\ (m,\ n,\ anz\ +\ bnz,\ values,\ 0)\ ;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ allocate\ result*/}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00016}00016\ \ \ \ \ \textcolor{keywordflow}{if}\ (!C\ ||\ !w\ ||\ (values\ \&\&\ !x))\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_afa27f1bfd7e5be4f160c24b0828d9178}{cs\_done}}\ (C,\ w,\ x,\ 0))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00017}00017\ \ \ \ \ Cp\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Ci\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Cx\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00018}00018\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0\ ;\ j\ <\ n\ ;\ j++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00019}00019\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00020}00020\ \ \ \ \ \ \ \ \ Cp\ [j]\ =\ nz\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ column\ j\ of\ C\ starts\ here\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00021}00021\ \ \ \ \ \ \ \ \ nz\ =\ \mbox{\hyperlink{cs_8c_a324e7bf547ed0b969275da4410563e6e}{cs\_scatter}}\ (A,\ j,\ alpha,\ w,\ x,\ j+1,\ C,\ nz)\ ;\ \ \ \textcolor{comment}{/*\ alpha*A(:,j)*/}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00022}00022\ \ \ \ \ \ \ \ \ nz\ =\ \mbox{\hyperlink{cs_8c_a324e7bf547ed0b969275da4410563e6e}{cs\_scatter}}\ (B,\ j,\ beta,\ w,\ x,\ j+1,\ C,\ nz)\ ;\ \ \ \ \textcolor{comment}{/*\ beta*B(:,j)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00023}00023\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (values)\ \textcolor{keywordflow}{for}\ (p\ =\ Cp\ [j]\ ;\ p\ <\ nz\ ;\ p++)\ Cx\ [p]\ =\ x\ [Ci\ [p]]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00024}00024\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00025}00025\ \ \ \ \ Cp\ [n]\ =\ nz\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ finalize\ the\ last\ column\ of\ C\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00026}00026\ \ \ \ \ \mbox{\hyperlink{cs_8c_a4f6f6d0b8acba23772fd254ec794e966}{cs\_sprealloc}}\ (C,\ 0)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ remove\ extra\ space\ from\ C\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00027}00027\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_afa27f1bfd7e5be4f160c24b0828d9178}{cs\_done}}\ (C,\ w,\ x,\ 1))\ ;\ \ \ \ \ \textcolor{comment}{/*\ success;\ free\ workspace,\ return\ C\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00028}00028\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00029}00029\ \textcolor{comment}{/*\ clear\ w\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00030}\mbox{\hyperlink{cs_8c_ab184799bb60f5e29155f267e3f96fb91}{00030}}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_ab184799bb60f5e29155f267e3f96fb91}{cs\_wclear}}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ mark,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ lemax,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *w,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ n)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00031}00031\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00032}00032\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ k\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00033}00033\ \ \ \ \ \textcolor{keywordflow}{if}\ (mark\ <\ 2\ ||\ (mark\ +\ lemax\ <\ 0))}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00034}00034\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00035}00035\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ n\ ;\ k++)\ \textcolor{keywordflow}{if}\ (w\ [k]\ !=\ 0)\ w\ [k]\ =\ 1\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00036}00036\ \ \ \ \ \ \ \ \ mark\ =\ 2\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00037}00037\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00038}00038\ \ \ \ \ \textcolor{keywordflow}{return}\ (mark)\ ;\ \ \ \ \ \textcolor{comment}{/*\ at\ this\ point,\ w\ [0..n-\/1]\ <\ mark\ holds\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00039}00039\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00041}00041\ \textcolor{comment}{/*\ keep\ off-\/diagonal\ entries;\ drop\ diagonal\ entries\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00042}\mbox{\hyperlink{cs_8c_ac8819c2025be41d056e1838fe1744a53}{00042}}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_ac8819c2025be41d056e1838fe1744a53}{cs\_diag}}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ i,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ j,\ \textcolor{keywordtype}{double}\ aij,\ \textcolor{keywordtype}{void}\ *other)\ \{\ \textcolor{keywordflow}{return}\ (i\ !=\ j)\ ;\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00044}00044\ \textcolor{comment}{/*\ p\ =\ amd(A+A')\ if\ symmetric\ is\ true,\ or\ amd(A'A)\ otherwise\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00045}\mbox{\hyperlink{cs_8c_a8c0812b53c0937ab04dc22eae0fb5259}{00045}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *\mbox{\hyperlink{cs_8c_a8c0812b53c0937ab04dc22eae0fb5259}{cs\_amd}}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ order,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A)\ \ \textcolor{comment}{/*\ order\ 0:natural,\ 1:Chol,\ 2:LU,\ 3:QR\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00046}00046\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00047}00047\ \ \ \ \ \mbox{\hyperlink{structcs__sparse}{cs}}\ *C,\ *A2,\ *AT\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00048}00048\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *Cp,\ *Ci,\ *last,\ *W,\ *len,\ *nv,\ *next,\ *P,\ *head,\ *elen,\ *degree,\ *w,}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00049}00049\ \ \ \ \ \ \ \ \ *hhead,\ *ATp,\ *ATi,\ d,\ dk,\ dext,\ lemax\ =\ 0,\ e,\ elenk,\ eln,\ i,\ j,\ k,\ k1,}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00050}00050\ \ \ \ \ \ \ \ \ k2,\ k3,\ jlast,\ ln,\ dense,\ nzmax,\ mindeg\ =\ 0,\ nvi,\ nvj,\ nvk,\ mark,\ wnvi,}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00051}00051\ \ \ \ \ \ \ \ \ ok,\ cnz,\ nel\ =\ 0,\ p,\ p1,\ p2,\ p3,\ p4,\ pj,\ pk,\ pk1,\ pk2,\ pn,\ q,\ n,\ m,\ t\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00052}00052\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ h\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00053}00053\ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/\ Construct\ matrix\ C\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00054}00054\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A)\ ||\ order\ <=\ 0\ ||\ order\ >\ 3)\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \textcolor{comment}{/*\ check\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00055}00055\ \ \ \ \ AT\ =\ \mbox{\hyperlink{cs_8c_a838dfaabdae54c408a4a696dfffa3dea}{cs\_transpose}}\ (A,\ 0)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ A'\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00056}00056\ \ \ \ \ \textcolor{keywordflow}{if}\ (!AT)\ \textcolor{keywordflow}{return}\ (NULL)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00057}00057\ \ \ \ \ m\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a8dab81f7d781bd65c7cb4f103db87ade}{m}}\ ;\ n\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00058}00058\ \ \ \ \ dense\ =\ \mbox{\hyperlink{cs_8h_a7447e0bed6bf453743551d158e019e8b}{CS\_MAX}}\ (16,\ 10\ *\ sqrt\ ((\textcolor{keywordtype}{double})\ n))\ ;\ \ \ \textcolor{comment}{/*\ find\ dense\ threshold\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00059}00059\ \ \ \ \ dense\ =\ \mbox{\hyperlink{cs_8h_a2635aa5c35f05bb0e4c88be5aabae949}{CS\_MIN}}\ (n-\/2,\ dense)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00060}00060\ \ \ \ \ \textcolor{keywordflow}{if}\ (order\ ==\ 1\ \&\&\ n\ ==\ m)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00061}00061\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00062}00062\ \ \ \ \ \ \ \ \ C\ =\ \mbox{\hyperlink{cs_8c_ac549d2c79490db68e4c9361a951144dd}{cs\_add}}\ (A,\ AT,\ 0,\ 0)\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ C\ =\ A+A'\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00063}00063\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00064}00064\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (order\ ==\ 2)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00065}00065\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00066}00066\ \ \ \ \ \ \ \ \ ATp\ =\ AT-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ drop\ dense\ columns\ from\ AT\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00067}00067\ \ \ \ \ \ \ \ \ ATi\ =\ AT-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00068}00068\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p2\ =\ 0,\ j\ =\ 0\ ;\ j\ <\ m\ ;\ j++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00069}00069\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00070}00070\ \ \ \ \ \ \ \ \ \ \ \ \ p\ =\ ATp\ [j]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ column\ j\ of\ AT\ starts\ here\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00071}00071\ \ \ \ \ \ \ \ \ \ \ \ \ ATp\ [j]\ =\ p2\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ new\ column\ j\ starts\ here\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00072}00072\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ATp\ [j+1]\ -\/\ p\ >\ dense)\ continue\ ;\ \ \ \textcolor{comment}{/*\ skip\ dense\ col\ j\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\ ;\ p\ <\ ATp\ [j+1]\ ;\ p++)\ ATi\ [p2++]\ =\ ATi\ [p]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00074}00074\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00075}00075\ \ \ \ \ \ \ \ \ ATp\ [m]\ =\ p2\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ finalize\ AT\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00076}00076\ \ \ \ \ \ \ \ \ A2\ =\ \mbox{\hyperlink{cs_8c_a838dfaabdae54c408a4a696dfffa3dea}{cs\_transpose}}\ (AT,\ 0)\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ A2\ =\ AT'\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00077}00077\ \ \ \ \ \ \ \ \ C\ =\ A2\ ?\ \mbox{\hyperlink{cs_8c_aa8d8dd148fab9e0a7811962c18d3ce61}{cs\_multiply}}\ (AT,\ A2)\ :\ NULL\ ;\ \ \textcolor{comment}{/*\ C=A'*A\ with\ no\ dense\ rows\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00078}00078\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8c_a01a74117bb6004b0b844de5940ddee0a}{cs\_spfree}}\ (A2)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00079}00079\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00080}00080\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00081}00081\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00082}00082\ \ \ \ \ \ \ \ \ C\ =\ \mbox{\hyperlink{cs_8c_aa8d8dd148fab9e0a7811962c18d3ce61}{cs\_multiply}}\ (AT,\ A)\ ;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ C=A'*A\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00083}00083\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00084}00084\ \ \ \ \ \mbox{\hyperlink{cs_8c_a01a74117bb6004b0b844de5940ddee0a}{cs\_spfree}}\ (AT)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00085}00085\ \ \ \ \ \textcolor{keywordflow}{if}\ (!C)\ \textcolor{keywordflow}{return}\ (NULL)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00086}00086\ \ \ \ \ \mbox{\hyperlink{cs_8c_a0467456f70ba2840b1876b42ae1f990b}{cs\_fkeep}}\ (C,\ \&\mbox{\hyperlink{cs_8c_ac8819c2025be41d056e1838fe1744a53}{cs\_diag}},\ NULL)\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ drop\ diagonal\ entries\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00087}00087\ \ \ \ \ Cp\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00088}00088\ \ \ \ \ cnz\ =\ Cp\ [n]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00089}00089\ \ \ \ \ P\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (n+1,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \ \ \ \ \textcolor{comment}{/*\ allocate\ result\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00090}00090\ \ \ \ \ W\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (8*(n+1),\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \textcolor{comment}{/*\ get\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00091}00091\ \ \ \ \ t\ =\ cnz\ +\ cnz/5\ +\ 2*n\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ add\ elbow\ room\ to\ C\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00092}00092\ \ \ \ \ \textcolor{keywordflow}{if}\ (!P\ ||\ !W\ ||\ !\mbox{\hyperlink{cs_8c_a4f6f6d0b8acba23772fd254ec794e966}{cs\_sprealloc}}\ (C,\ t))\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a5f172de9436558173ef0b873d9e1a5db}{cs\_idone}}\ (P,\ C,\ W,\ 0))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00093}00093\ \ \ \ \ len\ \ =\ W\ \ \ \ \ \ \ \ \ \ \ ;\ nv\ \ \ \ \ =\ W\ +\ \ \ (n+1)\ ;\ next\ \ \ =\ W\ +\ 2*(n+1)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00094}00094\ \ \ \ \ head\ =\ W\ +\ 3*(n+1)\ ;\ elen\ \ \ =\ W\ +\ 4*(n+1)\ ;\ degree\ =\ W\ +\ 5*(n+1)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00095}00095\ \ \ \ \ w\ \ \ \ =\ W\ +\ 6*(n+1)\ ;\ hhead\ \ =\ W\ +\ 7*(n+1)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00096}00096\ \ \ \ \ last\ =\ P\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ use\ P\ as\ workspace\ for\ last\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00097}00097\ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/\ Initialize\ quotient\ graph\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00098}00098\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ n\ ;\ k++)\ len\ [k]\ =\ Cp\ [k+1]\ -\/\ Cp\ [k]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00099}00099\ \ \ \ \ len\ [n]\ =\ 0\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00100}00100\ \ \ \ \ nzmax\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a4d98fb7ac430adab928f42e45d7c5504}{nzmax}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00101}00101\ \ \ \ \ Ci\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00102}00102\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0\ ;\ i\ <=\ n\ ;\ i++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00103}00103\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00104}00104\ \ \ \ \ \ \ \ \ head\ [i]\ =\ -\/1\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ degree\ list\ i\ is\ empty\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00105}00105\ \ \ \ \ \ \ \ \ last\ [i]\ =\ -\/1\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00106}00106\ \ \ \ \ \ \ \ \ next\ [i]\ =\ -\/1\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00107}00107\ \ \ \ \ \ \ \ \ hhead\ [i]\ =\ -\/1\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ hash\ list\ i\ is\ empty\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00108}00108\ \ \ \ \ \ \ \ \ nv\ [i]\ =\ 1\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ node\ i\ is\ just\ one\ node\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00109}00109\ \ \ \ \ \ \ \ \ w\ [i]\ =\ 1\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ node\ i\ is\ alive\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00110}00110\ \ \ \ \ \ \ \ \ elen\ [i]\ =\ 0\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Ek\ of\ node\ i\ is\ empty\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00111}00111\ \ \ \ \ \ \ \ \ degree\ [i]\ =\ len\ [i]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ degree\ of\ node\ i\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00112}00112\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00113}00113\ \ \ \ \ mark\ =\ \mbox{\hyperlink{cs_8c_ab184799bb60f5e29155f267e3f96fb91}{cs\_wclear}}\ (0,\ 0,\ w,\ n)\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ clear\ w\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00114}00114\ \ \ \ \ elen\ [n]\ =\ -\/2\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ n\ is\ a\ dead\ element\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00115}00115\ \ \ \ \ Cp\ [n]\ =\ -\/1\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ n\ is\ a\ root\ of\ assembly\ tree\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00116}00116\ \ \ \ \ w\ [n]\ =\ 0\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ n\ is\ a\ dead\ element\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00117}00117\ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/\ Initialize\ degree\ lists\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00118}00118\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0\ ;\ i\ <\ n\ ;\ i++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00119}00119\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00120}00120\ \ \ \ \ \ \ \ \ d\ =\ degree\ [i]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00121}00121\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (d\ ==\ 0)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ node\ i\ is\ empty\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00122}00122\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00123}00123\ \ \ \ \ \ \ \ \ \ \ \ \ elen\ [i]\ =\ -\/2\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ element\ i\ is\ dead\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00124}00124\ \ \ \ \ \ \ \ \ \ \ \ \ nel++\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00125}00125\ \ \ \ \ \ \ \ \ \ \ \ \ Cp\ [i]\ =\ -\/1\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ i\ is\ a\ root\ of\ assembly\ tree\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00126}00126\ \ \ \ \ \ \ \ \ \ \ \ \ w\ [i]\ =\ 0\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00127}00127\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00128}00128\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (d\ >\ dense)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ node\ i\ is\ dense\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00129}00129\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00130}00130\ \ \ \ \ \ \ \ \ \ \ \ \ nv\ [i]\ =\ 0\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ absorb\ i\ into\ element\ n\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00131}00131\ \ \ \ \ \ \ \ \ \ \ \ \ elen\ [i]\ =\ -\/1\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ node\ i\ is\ dead\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00132}00132\ \ \ \ \ \ \ \ \ \ \ \ \ nel++\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00133}00133\ \ \ \ \ \ \ \ \ \ \ \ \ Cp\ [i]\ =\ \mbox{\hyperlink{cs_8h_aa64f99348d6e0bd00fd5f974199b685a}{CS\_FLIP}}\ (n)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00134}00134\ \ \ \ \ \ \ \ \ \ \ \ \ nv\ [n]++\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00135}00135\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00136}00136\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00137}00137\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00138}00138\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (head\ [d]\ !=\ -\/1)\ last\ [head\ [d]]\ =\ i\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00139}00139\ \ \ \ \ \ \ \ \ \ \ \ \ next\ [i]\ =\ head\ [d]\ ;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ put\ node\ i\ in\ degree\ list\ d\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00140}00140\ \ \ \ \ \ \ \ \ \ \ \ \ head\ [d]\ =\ i\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00141}00141\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00142}00142\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00143}00143\ \ \ \ \ \textcolor{keywordflow}{while}\ (nel\ <\ n)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ while\ (selecting\ pivots)\ do\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00144}00144\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00145}00145\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/\ Select\ node\ of\ minimum\ approximate\ degree\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00146}00146\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ -\/1\ ;\ mindeg\ <\ n\ \&\&\ (k\ =\ head\ [mindeg])\ ==\ -\/1\ ;\ mindeg++)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00147}00147\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (next\ [k]\ !=\ -\/1)\ last\ [next\ [k]]\ =\ -\/1\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00148}00148\ \ \ \ \ \ \ \ \ head\ [mindeg]\ =\ next\ [k]\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ remove\ k\ from\ degree\ list\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00149}00149\ \ \ \ \ \ \ \ \ elenk\ =\ elen\ [k]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ elenk\ =\ |Ek|\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00150}00150\ \ \ \ \ \ \ \ \ nvk\ =\ nv\ [k]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ \#\ of\ nodes\ k\ represents\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00151}00151\ \ \ \ \ \ \ \ \ nel\ +=\ nvk\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ nv[k]\ nodes\ of\ A\ eliminated\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00152}00152\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/\ Garbage\ collection\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00153}00153\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (elenk\ >\ 0\ \&\&\ cnz\ +\ mindeg\ >=\ nzmax)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00154}00154\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00155}00155\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0\ ;\ j\ <\ n\ ;\ j++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00156}00156\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00157}00157\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((p\ =\ Cp\ [j])\ >=\ 0)\ \ \ \ \ \ \textcolor{comment}{/*\ j\ is\ a\ live\ node\ or\ element\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00158}00158\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00159}00159\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Cp\ [j]\ =\ Ci\ [p]\ ;\ \ \ \ \ \ \ \textcolor{comment}{/*\ save\ first\ entry\ of\ object\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00160}00160\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Ci\ [p]\ =\ \mbox{\hyperlink{cs_8h_aa64f99348d6e0bd00fd5f974199b685a}{CS\_FLIP}}\ (j)\ ;\ \ \textcolor{comment}{/*\ first\ entry\ is\ now\ CS\_FLIP(j)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00161}00161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00162}00162\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00163}00163\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (q\ =\ 0,\ p\ =\ 0\ ;\ p\ <\ cnz\ ;\ )\ \textcolor{comment}{/*\ scan\ all\ of\ memory\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00164}00164\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00165}00165\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((j\ =\ \mbox{\hyperlink{cs_8h_aa64f99348d6e0bd00fd5f974199b685a}{CS\_FLIP}}\ (Ci\ [p++]))\ >=\ 0)\ \ \textcolor{comment}{/*\ found\ object\ j\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00166}00166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00167}00167\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Ci\ [q]\ =\ Cp\ [j]\ ;\ \ \ \ \ \ \ \textcolor{comment}{/*\ restore\ first\ entry\ of\ object\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00168}00168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Cp\ [j]\ =\ q++\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ new\ pointer\ to\ object\ j\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00169}00169\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (k3\ =\ 0\ ;\ k3\ <\ len\ [j]-\/1\ ;\ k3++)\ Ci\ [q++]\ =\ Ci\ [p++]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00170}00170\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00171}00171\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00172}00172\ \ \ \ \ \ \ \ \ \ \ \ \ cnz\ =\ q\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Ci\ [cnz...nzmax-\/1]\ now\ free\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00173}00173\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00174}00174\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/\ Construct\ new\ element\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00175}00175\ \ \ \ \ \ \ \ \ dk\ =\ 0\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00176}00176\ \ \ \ \ \ \ \ \ nv\ [k]\ =\ -\/nvk\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ flag\ k\ as\ in\ Lk\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00177}00177\ \ \ \ \ \ \ \ \ p\ =\ Cp\ [k]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00178}00178\ \ \ \ \ \ \ \ \ pk1\ =\ (elenk\ ==\ 0)\ ?\ p\ :\ cnz\ ;\ \ \ \ \ \ \textcolor{comment}{/*\ do\ in\ place\ if\ elen[k]\ ==\ 0\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00179}00179\ \ \ \ \ \ \ \ \ pk2\ =\ pk1\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00180}00180\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (k1\ =\ 1\ ;\ k1\ <=\ elenk\ +\ 1\ ;\ k1++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00181}00181\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00182}00182\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (k1\ >\ elenk)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00183}00183\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00184}00184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ e\ =\ k\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ search\ the\ nodes\ in\ k\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00185}00185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pj\ =\ p\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ list\ of\ nodes\ starts\ at\ Ci[pj]*/}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00186}00186\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ln\ =\ len\ [k]\ -\/\ elenk\ ;\ \ \ \ \ \ \textcolor{comment}{/*\ length\ of\ list\ of\ nodes\ in\ k\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00187}00187\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00188}00188\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00189}00189\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00190}00190\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ e\ =\ Ci\ [p++]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ search\ the\ nodes\ in\ e\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00191}00191\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pj\ =\ Cp\ [e]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00192}00192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ln\ =\ len\ [e]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ length\ of\ list\ of\ nodes\ in\ e\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00193}00193\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00194}00194\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (k2\ =\ 1\ ;\ k2\ <=\ ln\ ;\ k2++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00195}00195\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00196}00196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ i\ =\ Ci\ [pj++]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00197}00197\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((nvi\ =\ nv\ [i])\ <=\ 0)\ continue\ ;\ \textcolor{comment}{/*\ node\ i\ dead,\ or\ seen\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00198}00198\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dk\ +=\ nvi\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ degree[Lk]\ +=\ size\ of\ node\ i\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00199}00199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nv\ [i]\ =\ -\/nvi\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ negate\ nv[i]\ to\ denote\ i\ in\ Lk*/}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00200}00200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Ci\ [pk2++]\ =\ i\ ;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ place\ i\ in\ Lk\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00201}00201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (next\ [i]\ !=\ -\/1)\ last\ [next\ [i]]\ =\ last\ [i]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00202}00202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (last\ [i]\ !=\ -\/1)\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ remove\ i\ from\ degree\ list\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00203}00203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00204}00204\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ next\ [last\ [i]]\ =\ next\ [i]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00205}00205\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00206}00206\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00207}00207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00208}00208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ head\ [degree\ [i]]\ =\ next\ [i]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00209}00209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00210}00210\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00211}00211\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (e\ !=\ k)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00212}00212\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00213}00213\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Cp\ [e]\ =\ \mbox{\hyperlink{cs_8h_aa64f99348d6e0bd00fd5f974199b685a}{CS\_FLIP}}\ (k)\ ;\ \ \ \ \ \ \textcolor{comment}{/*\ absorb\ e\ into\ k\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00214}00214\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ w\ [e]\ =\ 0\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ e\ is\ now\ a\ dead\ element\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00215}00215\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00216}00216\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00217}00217\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (elenk\ !=\ 0)\ cnz\ =\ pk2\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Ci\ [cnz...nzmax]\ is\ free\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00218}00218\ \ \ \ \ \ \ \ \ degree\ [k]\ =\ dk\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ external\ degree\ of\ k\ -\/\ |Lk\(\backslash\)i|\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00219}00219\ \ \ \ \ \ \ \ \ Cp\ [k]\ =\ pk1\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ element\ k\ is\ in\ Ci[pk1..pk2-\/1]\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00220}00220\ \ \ \ \ \ \ \ \ len\ [k]\ =\ pk2\ -\/\ pk1\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00221}00221\ \ \ \ \ \ \ \ \ elen\ [k]\ =\ -\/2\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ k\ is\ now\ an\ element\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00222}00222\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/\ Find\ set\ differences\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00223}00223\ \ \ \ \ \ \ \ \ mark\ =\ \mbox{\hyperlink{cs_8c_ab184799bb60f5e29155f267e3f96fb91}{cs\_wclear}}\ (mark,\ lemax,\ w,\ n)\ ;\ \ \textcolor{comment}{/*\ clear\ w\ if\ necessary\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00224}00224\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (pk\ =\ pk1\ ;\ pk\ <\ pk2\ ;\ pk++)\ \ \ \ \textcolor{comment}{/*\ scan\ 1:\ find\ |Le\(\backslash\)Lk|\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00225}00225\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00226}00226\ \ \ \ \ \ \ \ \ \ \ \ \ i\ =\ Ci\ [pk]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00227}00227\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((eln\ =\ elen\ [i])\ <=\ 0)\ continue\ ;\textcolor{comment}{/*\ skip\ if\ elen[i]\ empty\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00228}00228\ \ \ \ \ \ \ \ \ \ \ \ \ nvi\ =\ -\/nv\ [i]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ nv\ [i]\ was\ negated\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00229}00229\ \ \ \ \ \ \ \ \ \ \ \ \ wnvi\ =\ mark\ -\/\ nvi\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00230}00230\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Cp\ [i]\ ;\ p\ <=\ Cp\ [i]\ +\ eln\ -\/\ 1\ ;\ p++)\ \ \textcolor{comment}{/*\ scan\ Ei\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00231}00231\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00232}00232\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ e\ =\ Ci\ [p]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00233}00233\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (w\ [e]\ >=\ mark)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00234}00234\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00235}00235\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ w\ [e]\ -\/=\ nvi\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ decrement\ |Le\(\backslash\)Lk|\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00236}00236\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00237}00237\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (w\ [e]\ !=\ 0)\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ ensure\ e\ is\ a\ live\ element\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00238}00238\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00239}00239\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ w\ [e]\ =\ degree\ [e]\ +\ wnvi\ ;\ \textcolor{comment}{/*\ 1st\ time\ e\ seen\ in\ scan\ 1\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00240}00240\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00241}00241\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00242}00242\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00243}00243\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/\ Degree\ update\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00244}00244\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (pk\ =\ pk1\ ;\ pk\ <\ pk2\ ;\ pk++)\ \ \ \ \textcolor{comment}{/*\ scan2:\ degree\ update\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00245}00245\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00246}00246\ \ \ \ \ \ \ \ \ \ \ \ \ i\ =\ Ci\ [pk]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ consider\ node\ i\ in\ Lk\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00247}00247\ \ \ \ \ \ \ \ \ \ \ \ \ p1\ =\ Cp\ [i]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00248}00248\ \ \ \ \ \ \ \ \ \ \ \ \ p2\ =\ p1\ +\ elen\ [i]\ -\/\ 1\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00249}00249\ \ \ \ \ \ \ \ \ \ \ \ \ pn\ =\ p1\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00250}00250\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (h\ =\ 0,\ d\ =\ 0,\ p\ =\ p1\ ;\ p\ <=\ p2\ ;\ p++)\ \ \ \ \textcolor{comment}{/*\ scan\ Ei\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00251}00251\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00252}00252\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ e\ =\ Ci\ [p]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00253}00253\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (w\ [e]\ !=\ 0)\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ e\ is\ an\ unabsorbed\ element\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00254}00254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00255}00255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dext\ =\ w\ [e]\ -\/\ mark\ ;\ \ \ \textcolor{comment}{/*\ dext\ =\ |Le\(\backslash\)Lk|\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00256}00256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (dext\ >\ 0)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00257}00257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00258}00258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d\ +=\ dext\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ sum\ up\ the\ set\ differences\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00259}00259\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Ci\ [pn++]\ =\ e\ ;\ \ \ \ \ \textcolor{comment}{/*\ keep\ e\ in\ Ei\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00260}00260\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ h\ +=\ e\ ;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ the\ hash\ of\ node\ i\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00261}00261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00262}00262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00263}00263\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00264}00264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Cp\ [e]\ =\ \mbox{\hyperlink{cs_8h_aa64f99348d6e0bd00fd5f974199b685a}{CS\_FLIP}}\ (k)\ ;\ \ \textcolor{comment}{/*\ aggressive\ absorb.\ e-\/>k\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00265}00265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ w\ [e]\ =\ 0\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ e\ is\ a\ dead\ element\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00266}00266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00267}00267\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00268}00268\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00269}00269\ \ \ \ \ \ \ \ \ \ \ \ \ elen\ [i]\ =\ pn\ -\/\ p1\ +\ 1\ ;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ elen[i]\ =\ |Ei|\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00270}00270\ \ \ \ \ \ \ \ \ \ \ \ \ p3\ =\ pn\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00271}00271\ \ \ \ \ \ \ \ \ \ \ \ \ p4\ =\ p1\ +\ len\ [i]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00272}00272\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ p2\ +\ 1\ ;\ p\ <\ p4\ ;\ p++)\ \textcolor{comment}{/*\ prune\ edges\ in\ Ai\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00273}00273\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00274}00274\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ j\ =\ Ci\ [p]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00275}00275\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((nvj\ =\ nv\ [j])\ <=\ 0)\ continue\ ;\ \textcolor{comment}{/*\ node\ j\ dead\ or\ in\ Lk\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00276}00276\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d\ +=\ nvj\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ degree(i)\ +=\ |j|\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00277}00277\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Ci\ [pn++]\ =\ j\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ place\ j\ in\ node\ list\ of\ i\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00278}00278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ h\ +=\ j\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ hash\ for\ node\ i\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00279}00279\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00280}00280\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (d\ ==\ 0)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ check\ for\ mass\ elimination\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00281}00281\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00282}00282\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Cp\ [i]\ =\ \mbox{\hyperlink{cs_8h_aa64f99348d6e0bd00fd5f974199b685a}{CS\_FLIP}}\ (k)\ ;\ \ \ \ \ \ \textcolor{comment}{/*\ absorb\ i\ into\ k\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00283}00283\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nvi\ =\ -\/nv\ [i]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00284}00284\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dk\ -\/=\ nvi\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ |Lk|\ -\/=\ |i|\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00285}00285\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nvk\ +=\ nvi\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ |k|\ +=\ nv[i]\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00286}00286\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nel\ +=\ nvi\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00287}00287\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nv\ [i]\ =\ 0\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00288}00288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ elen\ [i]\ =\ -\/1\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ node\ i\ is\ dead\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00289}00289\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00290}00290\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00291}00291\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00292}00292\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ degree\ [i]\ =\ \mbox{\hyperlink{cs_8h_a2635aa5c35f05bb0e4c88be5aabae949}{CS\_MIN}}\ (degree\ [i],\ d)\ ;\ \ \ \textcolor{comment}{/*\ update\ degree(i)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00293}00293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Ci\ [pn]\ =\ Ci\ [p3]\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ move\ first\ node\ to\ end\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00294}00294\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Ci\ [p3]\ =\ Ci\ [p1]\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ move\ 1st\ el.\ to\ end\ of\ Ei\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00295}00295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Ci\ [p1]\ =\ k\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ add\ k\ as\ 1st\ element\ in\ of\ Ei\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00296}00296\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ len\ [i]\ =\ pn\ -\/\ p1\ +\ 1\ ;\ \ \ \ \ \textcolor{comment}{/*\ new\ len\ of\ adj.\ list\ of\ node\ i\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00297}00297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ h\ =\ ((h<0)\ ?\ (-\/h):h)\ \%\ n\ ;\ \ \textcolor{comment}{/*\ finalize\ hash\ of\ i\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00298}00298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ next\ [i]\ =\ hhead\ [h]\ ;\ \ \ \ \ \ \textcolor{comment}{/*\ place\ i\ in\ hash\ bucket\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00299}00299\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ hhead\ [h]\ =\ i\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00300}00300\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ last\ [i]\ =\ h\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ save\ hash\ of\ i\ in\ last[i]\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00301}00301\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00302}00302\ \ \ \ \ \ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ scan2\ is\ done\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00303}00303\ \ \ \ \ \ \ \ \ degree\ [k]\ =\ dk\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ finalize\ |Lk|\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00304}00304\ \ \ \ \ \ \ \ \ lemax\ =\ \mbox{\hyperlink{cs_8h_a7447e0bed6bf453743551d158e019e8b}{CS\_MAX}}\ (lemax,\ dk)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00305}00305\ \ \ \ \ \ \ \ \ mark\ =\ \mbox{\hyperlink{cs_8c_ab184799bb60f5e29155f267e3f96fb91}{cs\_wclear}}\ (mark+lemax,\ lemax,\ w,\ n)\ ;\ \ \ \ \textcolor{comment}{/*\ clear\ w\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00306}00306\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/\ Supernode\ detection\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00307}00307\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (pk\ =\ pk1\ ;\ pk\ <\ pk2\ ;\ pk++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00308}00308\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00309}00309\ \ \ \ \ \ \ \ \ \ \ \ \ i\ =\ Ci\ [pk]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00310}00310\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (nv\ [i]\ >=\ 0)\ continue\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ skip\ if\ i\ is\ dead\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00311}00311\ \ \ \ \ \ \ \ \ \ \ \ \ h\ =\ last\ [i]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ scan\ hash\ bucket\ of\ node\ i\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00312}00312\ \ \ \ \ \ \ \ \ \ \ \ \ i\ =\ hhead\ [h]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00313}00313\ \ \ \ \ \ \ \ \ \ \ \ \ hhead\ [h]\ =\ -\/1\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ hash\ bucket\ will\ be\ empty\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00314}00314\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\ ;\ i\ !=\ -\/1\ \&\&\ next\ [i]\ !=\ -\/1\ ;\ i\ =\ next\ [i],\ mark++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00315}00315\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00316}00316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ln\ =\ len\ [i]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00317}00317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ eln\ =\ elen\ [i]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00318}00318\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Cp\ [i]+1\ ;\ p\ <=\ Cp\ [i]\ +\ ln-\/1\ ;\ p++)\ w\ [Ci\ [p]]\ =\ mark;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00319}00319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ jlast\ =\ i\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00320}00320\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ next\ [i]\ ;\ j\ !=\ -\/1\ ;\ )\ \textcolor{comment}{/*\ compare\ i\ with\ all\ j\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00321}00321\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00322}00322\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ok\ =\ (len\ [j]\ ==\ ln)\ \&\&\ (elen\ [j]\ ==\ eln)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00323}00323\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Cp\ [j]\ +\ 1\ ;\ ok\ \&\&\ p\ <=\ Cp\ [j]\ +\ ln\ -\/\ 1\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00324}00324\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00325}00325\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (w\ [Ci\ [p]]\ !=\ mark)\ ok\ =\ 0\ ;\ \ \ \ \textcolor{comment}{/*\ compare\ i\ and\ j*/}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00326}00326\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00327}00327\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ok)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ i\ and\ j\ are\ identical\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00328}00328\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00329}00329\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Cp\ [j]\ =\ \mbox{\hyperlink{cs_8h_aa64f99348d6e0bd00fd5f974199b685a}{CS\_FLIP}}\ (i)\ ;\ \ \textcolor{comment}{/*\ absorb\ j\ into\ i\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00330}00330\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nv\ [i]\ +=\ nv\ [j]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00331}00331\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nv\ [j]\ =\ 0\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00332}00332\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ elen\ [j]\ =\ -\/1\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ node\ j\ is\ dead\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00333}00333\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ j\ =\ next\ [j]\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ delete\ j\ from\ hash\ bucket\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00334}00334\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ next\ [jlast]\ =\ j\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00335}00335\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00336}00336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00337}00337\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00338}00338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ jlast\ =\ j\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ j\ and\ i\ are\ different\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00339}00339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ j\ =\ next\ [j]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00340}00340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00341}00341\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00342}00342\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00343}00343\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00344}00344\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/\ Finalize\ new\ element-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00345}00345\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ pk1,\ pk\ =\ pk1\ ;\ pk\ <\ pk2\ ;\ pk++)\ \ \ \textcolor{comment}{/*\ finalize\ Lk\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00346}00346\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00347}00347\ \ \ \ \ \ \ \ \ \ \ \ \ i\ =\ Ci\ [pk]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00348}00348\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((nvi\ =\ -\/nv\ [i])\ <=\ 0)\ continue\ ;\textcolor{comment}{/*\ skip\ if\ i\ is\ dead\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00349}00349\ \ \ \ \ \ \ \ \ \ \ \ \ nv\ [i]\ =\ nvi\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ restore\ nv[i]\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00350}00350\ \ \ \ \ \ \ \ \ \ \ \ \ d\ =\ degree\ [i]\ +\ dk\ -\/\ nvi\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ external\ degree(i)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00351}00351\ \ \ \ \ \ \ \ \ \ \ \ \ d\ =\ \mbox{\hyperlink{cs_8h_a2635aa5c35f05bb0e4c88be5aabae949}{CS\_MIN}}\ (d,\ n\ -\/\ nel\ -\/\ nvi)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00352}00352\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (head\ [d]\ !=\ -\/1)\ last\ [head\ [d]]\ =\ i\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00353}00353\ \ \ \ \ \ \ \ \ \ \ \ \ next\ [i]\ =\ head\ [d]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ put\ i\ back\ in\ degree\ list\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00354}00354\ \ \ \ \ \ \ \ \ \ \ \ \ last\ [i]\ =\ -\/1\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00355}00355\ \ \ \ \ \ \ \ \ \ \ \ \ head\ [d]\ =\ i\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00356}00356\ \ \ \ \ \ \ \ \ \ \ \ \ mindeg\ =\ \mbox{\hyperlink{cs_8h_a2635aa5c35f05bb0e4c88be5aabae949}{CS\_MIN}}\ (mindeg,\ d)\ ;\ \ \ \ \ \ \ \textcolor{comment}{/*\ find\ new\ minimum\ degree\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00357}00357\ \ \ \ \ \ \ \ \ \ \ \ \ degree\ [i]\ =\ d\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00358}00358\ \ \ \ \ \ \ \ \ \ \ \ \ Ci\ [p++]\ =\ i\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ place\ i\ in\ Lk\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00359}00359\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00360}00360\ \ \ \ \ \ \ \ \ nv\ [k]\ =\ nvk\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ \#\ nodes\ absorbed\ into\ k\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00361}00361\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((len\ [k]\ =\ p-\/pk1)\ ==\ 0)\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ length\ of\ adj\ list\ of\ element\ k*/}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00362}00362\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00363}00363\ \ \ \ \ \ \ \ \ \ \ \ \ Cp\ [k]\ =\ -\/1\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ k\ is\ a\ root\ of\ the\ tree\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00364}00364\ \ \ \ \ \ \ \ \ \ \ \ \ w\ [k]\ =\ 0\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ k\ is\ now\ a\ dead\ element\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00365}00365\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00366}00366\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (elenk\ !=\ 0)\ cnz\ =\ p\ ;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ free\ unused\ space\ in\ Lk\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00367}00367\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00368}00368\ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/\ Postordering\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00369}00369\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0\ ;\ i\ <\ n\ ;\ i++)\ Cp\ [i]\ =\ \mbox{\hyperlink{cs_8h_aa64f99348d6e0bd00fd5f974199b685a}{CS\_FLIP}}\ (Cp\ [i])\ ;\textcolor{comment}{/*\ fix\ assembly\ tree\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00370}00370\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0\ ;\ j\ <=\ n\ ;\ j++)\ head\ [j]\ =\ -\/1\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00371}00371\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ n\ ;\ j\ >=\ 0\ ;\ j-\/-\/)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ place\ unordered\ nodes\ in\ lists\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00372}00372\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00373}00373\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (nv\ [j]\ >\ 0)\ continue\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ skip\ if\ j\ is\ an\ element\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00374}00374\ \ \ \ \ \ \ \ \ next\ [j]\ =\ head\ [Cp\ [j]]\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ place\ j\ in\ list\ of\ its\ parent\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00375}00375\ \ \ \ \ \ \ \ \ head\ [Cp\ [j]]\ =\ j\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00376}00376\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00377}00377\ \ \ \ \ \textcolor{keywordflow}{for}\ (e\ =\ n\ ;\ e\ >=\ 0\ ;\ e-\/-\/)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ place\ elements\ in\ lists\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00378}00378\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00379}00379\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (nv\ [e]\ <=\ 0)\ continue\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ skip\ unless\ e\ is\ an\ element\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00380}00380\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (Cp\ [e]\ !=\ -\/1)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00381}00381\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00382}00382\ \ \ \ \ \ \ \ \ \ \ \ \ next\ [e]\ =\ head\ [Cp\ [e]]\ ;\ \ \ \ \ \ \textcolor{comment}{/*\ place\ e\ in\ list\ of\ its\ parent\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00383}00383\ \ \ \ \ \ \ \ \ \ \ \ \ head\ [Cp\ [e]]\ =\ e\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00384}00384\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00385}00385\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00386}00386\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0,\ i\ =\ 0\ ;\ i\ <=\ n\ ;\ i++)\ \ \ \ \ \ \ \textcolor{comment}{/*\ postorder\ the\ assembly\ tree\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00387}00387\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00388}00388\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (Cp\ [i]\ ==\ -\/1)\ k\ =\ \mbox{\hyperlink{cs_8c_a763cce1cc37a21b58c8493c6c28e4afe}{cs\_tdfs}}\ (i,\ k,\ head,\ next,\ P,\ w)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00389}00389\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00390}00390\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a5f172de9436558173ef0b873d9e1a5db}{cs\_idone}}\ (P,\ C,\ W,\ 1))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00391}00391\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00392}00392\ \textcolor{comment}{/*\ L\ =\ chol\ (A,\ [pinv\ parent\ cp]),\ pinv\ is\ optional\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00393}\mbox{\hyperlink{cs_8c_ad68a5d313333e08e69d6d781b65af55c}{00393}}\ \mbox{\hyperlink{structcs__numeric}{csn}}\ *\mbox{\hyperlink{cs_8c_ad68a5d313333e08e69d6d781b65af55c}{cs\_chol}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__symbolic}{css}}\ *S)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00394}00394\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00395}00395\ \ \ \ \ \textcolor{keywordtype}{double}\ d,\ lki,\ *Lx,\ *x,\ *Cx\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00396}00396\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ top,\ i,\ p,\ k,\ n,\ *Li,\ *Lp,\ *cp,\ *pinv,\ *s,\ *\mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}},\ *parent,\ *Cp,\ *Ci\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00397}00397\ \ \ \ \ \mbox{\hyperlink{structcs__sparse}{cs}}\ *L,\ *C,\ *E\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00398}00398\ \ \ \ \ \mbox{\hyperlink{structcs__numeric}{csn}}\ *N\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00399}00399\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A)\ ||\ !S\ ||\ !S-\/>\mbox{\hyperlink{structcs__symbolic_af019d6662511b698efe705ad93b4e27b}{cp}}\ ||\ !S-\/>\mbox{\hyperlink{structcs__symbolic_aec9034130e3a364799c96d3bae5f3809}{parent}})\ \textcolor{keywordflow}{return}\ (NULL)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00400}00400\ \ \ \ \ n\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00401}00401\ \ \ \ \ N\ =\ \mbox{\hyperlink{cs_8c_a071e69dcb222391d3add6c5220a79f51}{cs\_calloc}}\ (1,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{structcs__numeric}{csn}}))\ ;\ \ \ \ \ \ \ \textcolor{comment}{/*\ allocate\ result\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00402}00402\ \ \ \ \ \mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}}\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (2*n,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \ \ \ \ \textcolor{comment}{/*\ get\ csi\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00403}00403\ \ \ \ \ x\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (n,\ \textcolor{keyword}{sizeof}\ (\textcolor{keywordtype}{double}))\ ;\ \ \ \ \textcolor{comment}{/*\ get\ double\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00404}00404\ \ \ \ \ cp\ =\ S-\/>\mbox{\hyperlink{structcs__symbolic_af019d6662511b698efe705ad93b4e27b}{cp}}\ ;\ pinv\ =\ S-\/>\mbox{\hyperlink{structcs__symbolic_aaec943329f58d681893838030e3e273c}{pinv}}\ ;\ parent\ =\ S-\/>\mbox{\hyperlink{structcs__symbolic_aec9034130e3a364799c96d3bae5f3809}{parent}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00405}00405\ \ \ \ \ C\ =\ pinv\ ?\ \mbox{\hyperlink{cs_8c_ad19ab7e30ae8e32fe9b000a1e7e30a1f}{cs\_symperm}}\ (A,\ pinv,\ 1)\ :\ ((\mbox{\hyperlink{structcs__sparse}{cs}}\ *)\ A)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00406}00406\ \ \ \ \ E\ =\ pinv\ ?\ C\ :\ NULL\ ;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ E\ is\ alias\ for\ A,\ or\ a\ copy\ E=A(p,p)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00407}00407\ \ \ \ \ \textcolor{keywordflow}{if}\ (!N\ ||\ !\mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}}\ ||\ !x\ ||\ !C)\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a694a09c9515e8fd862bd5270ee35cbc8}{cs\_ndone}}\ (N,\ E,\ \mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}},\ x,\ 0))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00408}00408\ \ \ \ \ s\ =\ \mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}}\ +\ n\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00409}00409\ \ \ \ \ Cp\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Ci\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Cx\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00410}00410\ \ \ \ \ N-\/>\mbox{\hyperlink{structcs__numeric_a93a8cf26f01d3df51b41acc690f120d7}{L}}\ =\ L\ =\ \mbox{\hyperlink{cs_8c_af3ed6e2936760b1b53b79fe3ed5cc8b6}{cs\_spalloc}}\ (n,\ n,\ cp\ [n],\ 1,\ 0)\ ;\ \ \ \ \textcolor{comment}{/*\ allocate\ result\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00411}00411\ \ \ \ \ \textcolor{keywordflow}{if}\ (!L)\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a694a09c9515e8fd862bd5270ee35cbc8}{cs\_ndone}}\ (N,\ E,\ \mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}},\ x,\ 0))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00412}00412\ \ \ \ \ Lp\ =\ L-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Li\ =\ L-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Lx\ =\ L-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00413}00413\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ n\ ;\ k++)\ Lp\ [k]\ =\ \mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}}\ [k]\ =\ cp\ [k]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00414}00414\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ n\ ;\ k++)\ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ L(k,:)\ for\ L*L'\ =\ C\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00415}00415\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00416}00416\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/\ Nonzero\ pattern\ of\ L(k,:)\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00417}00417\ \ \ \ \ \ \ \ \ top\ =\ \mbox{\hyperlink{cs_8c_ab6bc6149bec190fcbdc19058e7d54034}{cs\_ereach}}\ (C,\ k,\ parent,\ s,\ \mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}})\ ;\ \ \ \ \ \ \textcolor{comment}{/*\ find\ pattern\ of\ L(k,:)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00418}00418\ \ \ \ \ \ \ \ \ x\ [k]\ =\ 0\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ x\ (0:k)\ is\ now\ zero\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00419}00419\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Cp\ [k]\ ;\ p\ <\ Cp\ [k+1]\ ;\ p++)\ \ \ \ \ \ \ \textcolor{comment}{/*\ x\ =\ full(triu(C(:,k)))\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00420}00420\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00421}00421\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (Ci\ [p]\ <=\ k)\ x\ [Ci\ [p]]\ =\ Cx\ [p]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00422}00422\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00423}00423\ \ \ \ \ \ \ \ \ d\ =\ x\ [k]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ d\ =\ C(k,k)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00424}00424\ \ \ \ \ \ \ \ \ x\ [k]\ =\ 0\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ clear\ x\ for\ k+1st\ iteration\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00425}00425\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/\ Triangular\ solve\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00426}00426\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\ ;\ top\ <\ n\ ;\ top++)\ \ \ \ \textcolor{comment}{/*\ solve\ L(0:k-\/1,0:k-\/1)\ *\ x\ =\ C(:,k)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00427}00427\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00428}00428\ \ \ \ \ \ \ \ \ \ \ \ \ i\ =\ s\ [top]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ s\ [top..n-\/1]\ is\ pattern\ of\ L(k,:)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00429}00429\ \ \ \ \ \ \ \ \ \ \ \ \ lki\ =\ x\ [i]\ /\ Lx\ [Lp\ [i]]\ ;\ \textcolor{comment}{/*\ L(k,i)\ =\ x\ (i)\ /\ L(i,i)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00430}00430\ \ \ \ \ \ \ \ \ \ \ \ \ x\ [i]\ =\ 0\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ clear\ x\ for\ k+1st\ iteration\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00431}00431\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Lp\ [i]\ +\ 1\ ;\ p\ <\ \mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}}\ [i]\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00432}00432\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00433}00433\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\ [Li\ [p]]\ -\/=\ Lx\ [p]\ *\ lki\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00434}00434\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00435}00435\ \ \ \ \ \ \ \ \ \ \ \ \ d\ -\/=\ lki\ *\ lki\ ;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ d\ =\ d\ -\/\ L(k,i)*L(k,i)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00436}00436\ \ \ \ \ \ \ \ \ \ \ \ \ p\ =\ \mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}}\ [i]++\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00437}00437\ \ \ \ \ \ \ \ \ \ \ \ \ Li\ [p]\ =\ k\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ store\ L(k,i)\ in\ column\ i\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00438}00438\ \ \ \ \ \ \ \ \ \ \ \ \ Lx\ [p]\ =\ lki\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00439}00439\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00440}00440\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/\ Compute\ L(k,k)\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00441}00441\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (d\ <=\ 0)\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a694a09c9515e8fd862bd5270ee35cbc8}{cs\_ndone}}\ (N,\ E,\ \mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}},\ x,\ 0))\ ;\ \textcolor{comment}{/*\ not\ pos\ def\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00442}00442\ \ \ \ \ \ \ \ \ p\ =\ \mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}}\ [k]++\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00443}00443\ \ \ \ \ \ \ \ \ Li\ [p]\ =\ k\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ store\ L(k,k)\ =\ sqrt\ (d)\ in\ column\ k\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00444}00444\ \ \ \ \ \ \ \ \ Lx\ [p]\ =\ sqrt\ (d)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00445}00445\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00446}00446\ \ \ \ \ Lp\ [n]\ =\ cp\ [n]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ finalize\ L\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00447}00447\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a694a09c9515e8fd862bd5270ee35cbc8}{cs\_ndone}}\ (N,\ E,\ \mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}},\ x,\ 1))\ ;\ \textcolor{comment}{/*\ success:\ free\ E,s,x;\ return\ N\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00448}00448\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00449}00449\ \textcolor{comment}{/*\ x=A\(\backslash\)b\ where\ A\ is\ symmetric\ positive\ definite;\ b\ overwritten\ with\ solution\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00450}\mbox{\hyperlink{cs_8c_ae821a46d8293bb2e3d34880433ceb705}{00450}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_ae821a46d8293bb2e3d34880433ceb705}{cs\_cholsol}}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ order,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \textcolor{keywordtype}{double}\ *b)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00451}00451\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00452}00452\ \ \ \ \ \textcolor{keywordtype}{double}\ *x\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00453}00453\ \ \ \ \ \mbox{\hyperlink{structcs__symbolic}{css}}\ *S\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00454}00454\ \ \ \ \ \mbox{\hyperlink{structcs__numeric}{csn}}\ *N\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00455}00455\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ n,\ ok\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00456}00456\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A)\ ||\ !b)\ \textcolor{keywordflow}{return}\ (0)\ ;\ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00457}00457\ \ \ \ \ n\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00458}00458\ \ \ \ \ S\ =\ \mbox{\hyperlink{cs_8c_a33a1dc7aff658c5699d6c6d4a0fa70d3}{cs\_schol}}\ (order,\ A)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ ordering\ and\ symbolic\ analysis\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00459}00459\ \ \ \ \ N\ =\ \mbox{\hyperlink{cs_8c_ad68a5d313333e08e69d6d781b65af55c}{cs\_chol}}\ (A,\ S)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ numeric\ Cholesky\ factorization\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00460}00460\ \ \ \ \ x\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (n,\ \textcolor{keyword}{sizeof}\ (\textcolor{keywordtype}{double}))\ ;\ \ \ \ \textcolor{comment}{/*\ get\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00461}00461\ \ \ \ \ ok\ =\ (S\ \&\&\ N\ \&\&\ x)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00462}00462\ \ \ \ \ \textcolor{keywordflow}{if}\ (ok)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00463}00463\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00464}00464\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8c_a0938ec08825dc07a2dab8f9477ab053b}{cs\_ipvec}}\ (S-\/>\mbox{\hyperlink{structcs__symbolic_aaec943329f58d681893838030e3e273c}{pinv}},\ b,\ x,\ n)\ ;\ \ \ \textcolor{comment}{/*\ x\ =\ P*b\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00465}00465\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8c_adefe244fe8757d1d7b4de55e0c81561f}{cs\_lsolve}}\ (N-\/>\mbox{\hyperlink{structcs__numeric_a93a8cf26f01d3df51b41acc690f120d7}{L}},\ x)\ ;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ x\ =\ L\(\backslash\)x\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00466}00466\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8c_a470ceabef51cc5f2d522587aa9470eb6}{cs\_ltsolve}}\ (N-\/>\mbox{\hyperlink{structcs__numeric_a93a8cf26f01d3df51b41acc690f120d7}{L}},\ x)\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ x\ =\ L'\(\backslash\)x\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00467}00467\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8c_a79d20fcd31c30d118075e08087127c4e}{cs\_pvec}}\ (S-\/>\mbox{\hyperlink{structcs__symbolic_aaec943329f58d681893838030e3e273c}{pinv}},\ x,\ b,\ n)\ ;\ \ \ \ \textcolor{comment}{/*\ b\ =\ P'*x\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00468}00468\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00469}00469\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (x)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00470}00470\ \ \ \ \ \mbox{\hyperlink{cs_8c_a2eebf0dae1d9ee505a016630e4fa5748}{cs\_sfree}}\ (S)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00471}00471\ \ \ \ \ \mbox{\hyperlink{cs_8c_adabc8e810cec49307537b5e3368d53aa}{cs\_nfree}}\ (N)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00472}00472\ \ \ \ \ \textcolor{keywordflow}{return}\ (ok)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00473}00473\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00474}00474\ \textcolor{comment}{/*\ C\ =\ compressed-\/column\ form\ of\ a\ triplet\ matrix\ T\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00475}\mbox{\hyperlink{cs_8c_a09ba40a53eba3d923f2f2deaa464fba2}{00475}}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *\mbox{\hyperlink{cs_8c_a09ba40a53eba3d923f2f2deaa464fba2}{cs\_compress}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *T)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00476}00476\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00477}00477\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ m,\ n,\ nz,\ p,\ k,\ *Cp,\ *Ci,\ *w,\ *Ti,\ *Tj\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00478}00478\ \ \ \ \ \textcolor{keywordtype}{double}\ *Cx,\ *Tx\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00479}00479\ \ \ \ \ \mbox{\hyperlink{structcs__sparse}{cs}}\ *C\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00480}00480\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a62bab576c9482f6e11c4cee5a1b5a39a}{CS\_TRIPLET}}\ (T))\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00481}00481\ \ \ \ \ m\ =\ T-\/>\mbox{\hyperlink{structcs__sparse_a8dab81f7d781bd65c7cb4f103db87ade}{m}}\ ;\ n\ =\ T-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;\ Ti\ =\ T-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Tj\ =\ T-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Tx\ =\ T-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;\ nz\ =\ T-\/>\mbox{\hyperlink{structcs__sparse_a8eb7205d5e8fbb0c08a80e9fd52d2963}{nz}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00482}00482\ \ \ \ \ C\ =\ \mbox{\hyperlink{cs_8c_af3ed6e2936760b1b53b79fe3ed5cc8b6}{cs\_spalloc}}\ (m,\ n,\ nz,\ Tx\ !=\ NULL,\ 0)\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ allocate\ result\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00483}00483\ \ \ \ \ w\ =\ \mbox{\hyperlink{cs_8c_a071e69dcb222391d3add6c5220a79f51}{cs\_calloc}}\ (n,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ get\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00484}00484\ \ \ \ \ \textcolor{keywordflow}{if}\ (!C\ ||\ !w)\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_afa27f1bfd7e5be4f160c24b0828d9178}{cs\_done}}\ (C,\ w,\ NULL,\ 0))\ ;\ \ \ \ \textcolor{comment}{/*\ out\ of\ memory\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00485}00485\ \ \ \ \ Cp\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Ci\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Cx\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00486}00486\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ nz\ ;\ k++)\ w\ [Tj\ [k]]++\ ;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ column\ counts\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00487}00487\ \ \ \ \ \mbox{\hyperlink{cs_8c_a4c92d1dd47385e119da4d37ca82c2baa}{cs\_cumsum}}\ (Cp,\ w,\ n)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ column\ pointers\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00488}00488\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ nz\ ;\ k++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00489}00489\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00490}00490\ \ \ \ \ \ \ \ \ Ci\ [p\ =\ w\ [Tj\ [k]]++]\ =\ Ti\ [k]\ ;\ \ \ \ \textcolor{comment}{/*\ A(i,j)\ is\ the\ pth\ entry\ in\ C\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00491}00491\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (Cx)\ Cx\ [p]\ =\ Tx\ [k]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00492}00492\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00493}00493\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_afa27f1bfd7e5be4f160c24b0828d9178}{cs\_done}}\ (C,\ w,\ NULL,\ 1))\ ;\ \ \ \ \ \ \textcolor{comment}{/*\ success;\ free\ w\ and\ return\ C\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00494}00494\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00495}00495\ \textcolor{comment}{/*\ column\ counts\ of\ LL'=A\ or\ LL'=A'A,\ given\ parent\ \&\ post\ ordering\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00496}\mbox{\hyperlink{cs_8c_a12ca900356d8c2b441db5f1077dee0e8}{00496}}\ \textcolor{preprocessor}{\#define\ HEAD(k,j)\ (ata\ ?\ head\ [k]\ :\ j)}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00497}\mbox{\hyperlink{cs_8c_a5638f1bcf2b9b270aa560e0ec861b133}{00497}}\ \textcolor{preprocessor}{\#define\ NEXT(J)\ \ \ (ata\ ?\ next\ [J]\ :\ -\/1)}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00498}\mbox{\hyperlink{cs_8c_ada76e715fb6342f4b9a731b22f0452e3}{00498}}\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{cs_8c_ada76e715fb6342f4b9a731b22f0452e3}{init\_ata}}\ (\mbox{\hyperlink{structcs__sparse}{cs}}\ *AT,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *post,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *w,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ **head,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ **next)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00499}00499\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00500}00500\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ i,\ k,\ p,\ m\ =\ AT-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}},\ n\ =\ AT-\/>\mbox{\hyperlink{structcs__sparse_a8dab81f7d781bd65c7cb4f103db87ade}{m}},\ *ATp\ =\ AT-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}},\ *ATi\ =\ AT-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00501}00501\ \ \ \ \ *head\ =\ w+4*n,\ *next\ =\ w+5*n+1\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00502}00502\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ n\ ;\ k++)\ w\ [post\ [k]]\ =\ k\ ;\ \ \ \ \textcolor{comment}{/*\ invert\ post\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00503}00503\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0\ ;\ i\ <\ m\ ;\ i++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00504}00504\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00505}00505\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ n,\ p\ =\ ATp[i]\ ;\ p\ <\ ATp[i+1]\ ;\ p++)\ k\ =\ \mbox{\hyperlink{cs_8h_a2635aa5c35f05bb0e4c88be5aabae949}{CS\_MIN}}\ (k,\ w\ [ATi[p]]);}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00506}00506\ \ \ \ \ \ \ \ \ (*next)\ [i]\ =\ (*head)\ [k]\ ;\ \ \ \ \ \textcolor{comment}{/*\ place\ row\ i\ in\ linked\ list\ k\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00507}00507\ \ \ \ \ \ \ \ \ (*head)\ [k]\ =\ i\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00508}00508\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00509}00509\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00510}\mbox{\hyperlink{cs_8c_ad97e14775c7d6b9f8f1e8c5ee0d63aa7}{00510}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *\mbox{\hyperlink{cs_8c_ad97e14775c7d6b9f8f1e8c5ee0d63aa7}{cs\_counts}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *parent,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *post,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ ata)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00511}00511\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00512}00512\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ i,\ j,\ k,\ n,\ m,\ J,\ s,\ p,\ q,\ jleaf,\ *ATp,\ *ATi,\ *maxfirst,\ *prevleaf,}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00513}00513\ \ \ \ \ \ \ \ \ *ancestor,\ *head\ =\ NULL,\ *next\ =\ NULL,\ *colcount,\ *w,\ *first,\ *delta\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00514}00514\ \ \ \ \ \mbox{\hyperlink{structcs__sparse}{cs}}\ *AT\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00515}00515\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A)\ ||\ !parent\ ||\ !post)\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00516}00516\ \ \ \ \ m\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a8dab81f7d781bd65c7cb4f103db87ade}{m}}\ ;\ n\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00517}00517\ \ \ \ \ s\ =\ 4*n\ +\ (ata\ ?\ (n+m+1)\ :\ 0)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00518}00518\ \ \ \ \ delta\ =\ colcount\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (n,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \ \ \ \textcolor{comment}{/*\ allocate\ result\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00519}00519\ \ \ \ \ w\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (s,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ get\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00520}00520\ \ \ \ \ AT\ =\ \mbox{\hyperlink{cs_8c_a838dfaabdae54c408a4a696dfffa3dea}{cs\_transpose}}\ (A,\ 0)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ AT\ =\ A'\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00521}00521\ \ \ \ \ \textcolor{keywordflow}{if}\ (!AT\ ||\ !colcount\ ||\ !w)\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a5f172de9436558173ef0b873d9e1a5db}{cs\_idone}}\ (colcount,\ AT,\ w,\ 0))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00522}00522\ \ \ \ \ ancestor\ =\ w\ ;\ maxfirst\ =\ w+n\ ;\ prevleaf\ =\ w+2*n\ ;\ first\ =\ w+3*n\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00523}00523\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ s\ ;\ k++)\ w\ [k]\ =\ -\/1\ ;\ \ \ \ \ \ \textcolor{comment}{/*\ clear\ workspace\ w\ [0..s-\/1]\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00524}00524\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ n\ ;\ k++)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ find\ first\ [j]\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00525}00525\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00526}00526\ \ \ \ \ \ \ \ \ j\ =\ post\ [k]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00527}00527\ \ \ \ \ \ \ \ \ delta\ [j]\ =\ (first\ [j]\ ==\ -\/1)\ ?\ 1\ :\ 0\ ;\ \ \textcolor{comment}{/*\ delta[j]=1\ if\ j\ is\ a\ leaf\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00528}00528\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\ ;\ j\ !=\ -\/1\ \&\&\ first\ [j]\ ==\ -\/1\ ;\ j\ =\ parent\ [j])\ first\ [j]\ =\ k\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00529}00529\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00530}00530\ \ \ \ \ ATp\ =\ AT-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ ATi\ =\ AT-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00531}00531\ \ \ \ \ \textcolor{keywordflow}{if}\ (ata)\ \mbox{\hyperlink{cs_8c_ada76e715fb6342f4b9a731b22f0452e3}{init\_ata}}\ (AT,\ post,\ w,\ \&head,\ \&next)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00532}00532\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0\ ;\ i\ <\ n\ ;\ i++)\ ancestor\ [i]\ =\ i\ ;\ \textcolor{comment}{/*\ each\ node\ in\ its\ own\ set\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00533}00533\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ n\ ;\ k++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00534}00534\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00535}00535\ \ \ \ \ \ \ \ \ j\ =\ post\ [k]\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ j\ is\ the\ kth\ node\ in\ postordered\ etree\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00536}00536\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (parent\ [j]\ !=\ -\/1)\ delta\ [parent\ [j]]-\/-\/\ ;\ \ \ \ \textcolor{comment}{/*\ j\ is\ not\ a\ root\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00537}00537\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (J\ =\ \mbox{\hyperlink{cs_8c_a12ca900356d8c2b441db5f1077dee0e8}{HEAD}}\ (k,j)\ ;\ J\ !=\ -\/1\ ;\ J\ =\ \mbox{\hyperlink{cs_8c_a5638f1bcf2b9b270aa560e0ec861b133}{NEXT}}\ (J))\ \ \ \textcolor{comment}{/*\ J=j\ for\ LL'=A\ case\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00538}00538\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00539}00539\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ ATp\ [J]\ ;\ p\ <\ ATp\ [J+1]\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00540}00540\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00541}00541\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ i\ =\ ATi\ [p]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00542}00542\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ q\ =\ \mbox{\hyperlink{cs_8c_aaeedf973ec2de811ead0e47f8501a81d}{cs\_leaf}}\ (i,\ j,\ first,\ maxfirst,\ prevleaf,\ ancestor,\ \&jleaf);}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00543}00543\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (jleaf\ >=\ 1)\ delta\ [j]++\ ;\ \ \ \textcolor{comment}{/*\ A(i,j)\ is\ in\ skeleton\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00544}00544\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (jleaf\ ==\ 2)\ delta\ [q]-\/-\/\ ;\ \ \ \textcolor{comment}{/*\ account\ for\ overlap\ in\ q\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00545}00545\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00546}00546\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00547}00547\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (parent\ [j]\ !=\ -\/1)\ ancestor\ [j]\ =\ parent\ [j]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00548}00548\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00549}00549\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0\ ;\ j\ <\ n\ ;\ j++)\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ sum\ up\ delta's\ of\ each\ child\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00550}00550\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00551}00551\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (parent\ [j]\ !=\ -\/1)\ colcount\ [parent\ [j]]\ +=\ colcount\ [j]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00552}00552\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00553}00553\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a5f172de9436558173ef0b873d9e1a5db}{cs\_idone}}\ (colcount,\ AT,\ w,\ 1))\ ;\ \ \ \ \textcolor{comment}{/*\ success:\ free\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00554}00554\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00555}00555\ \textcolor{comment}{/*\ p\ [0..n]\ =\ cumulative\ sum\ of\ c\ [0..n-\/1],\ and\ then\ copy\ p\ [0..n-\/1]\ into\ c\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00556}\mbox{\hyperlink{cs_8c_a4c92d1dd47385e119da4d37ca82c2baa}{00556}}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{cs_8c_a4c92d1dd47385e119da4d37ca82c2baa}{cs\_cumsum}}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *p,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *\mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}},\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ n)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00557}00557\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00558}00558\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ i,\ nz\ =\ 0\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00559}00559\ \ \ \ \ \textcolor{keywordtype}{double}\ nz2\ =\ 0\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00560}00560\ \ \ \ \ \textcolor{keywordflow}{if}\ (!p\ ||\ !\mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}})\ \textcolor{keywordflow}{return}\ (-\/1)\ ;\ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00561}00561\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0\ ;\ i\ <\ n\ ;\ i++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00562}00562\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00563}00563\ \ \ \ \ \ \ \ \ p\ [i]\ =\ nz\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00564}00564\ \ \ \ \ \ \ \ \ nz\ +=\ \mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}}\ [i]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00565}00565\ \ \ \ \ \ \ \ \ nz2\ +=\ \mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}}\ [i]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ also\ in\ double\ to\ avoid\ csi\ overflow\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00566}00566\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}}\ [i]\ =\ p\ [i]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ also\ copy\ p[0..n-\/1]\ back\ into\ c[0..n-\/1]*/}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00567}00567\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00568}00568\ \ \ \ \ p\ [n]\ =\ nz\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00569}00569\ \ \ \ \ \textcolor{keywordflow}{return}\ (nz2)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ return\ sum\ (c\ [0..n-\/1])\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00570}00570\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00571}00571\ \textcolor{comment}{/*\ depth-\/first-\/search\ of\ the\ graph\ of\ a\ matrix,\ starting\ at\ node\ j\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00572}\mbox{\hyperlink{cs_8c_a43a06094fee0e062b78fd70d1c70b9c4}{00572}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_a43a06094fee0e062b78fd70d1c70b9c4}{cs\_dfs}}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ j,\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *G,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ top,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *xi,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *pstack,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *pinv)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00573}00573\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00574}00574\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ i,\ p,\ p2,\ done,\ jnew,\ head\ =\ 0,\ *Gp,\ *Gi\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00575}00575\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (G)\ ||\ !xi\ ||\ !pstack)\ \textcolor{keywordflow}{return}\ (-\/1)\ ;\ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00576}00576\ \ \ \ \ Gp\ =\ G-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Gi\ =\ G-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00577}00577\ \ \ \ \ xi\ [0]\ =\ j\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ initialize\ the\ recursion\ stack\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00578}00578\ \ \ \ \ \textcolor{keywordflow}{while}\ (head\ >=\ 0)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00579}00579\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00580}00580\ \ \ \ \ \ \ \ \ j\ =\ xi\ [head]\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ get\ j\ from\ the\ top\ of\ the\ recursion\ stack\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00581}00581\ \ \ \ \ \ \ \ \ jnew\ =\ pinv\ ?\ (pinv\ [j])\ :\ j\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00582}00582\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_ad5ef446ddee80d5771be956a23520bf5}{CS\_MARKED}}\ (Gp,\ j))}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00583}00583\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00584}00584\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8h_ad5096d9a8169cff461816575072022f0}{CS\_MARK}}\ (Gp,\ j)\ ;\ \ \ \ \ \ \ \textcolor{comment}{/*\ mark\ node\ j\ as\ visited\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00585}00585\ \ \ \ \ \ \ \ \ \ \ \ \ pstack\ [head]\ =\ (jnew\ <\ 0)\ ?\ 0\ :\ \mbox{\hyperlink{cs_8h_ac9ba6b1092f27aeed7f94a418610aff9}{CS\_UNFLIP}}\ (Gp\ [jnew])\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00586}00586\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00587}00587\ \ \ \ \ \ \ \ \ done\ =\ 1\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ node\ j\ done\ if\ no\ unvisited\ neighbors\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00588}00588\ \ \ \ \ \ \ \ \ p2\ =\ (jnew\ <\ 0)\ ?\ 0\ :\ \mbox{\hyperlink{cs_8h_ac9ba6b1092f27aeed7f94a418610aff9}{CS\_UNFLIP}}\ (Gp\ [jnew+1])\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00589}00589\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ pstack\ [head]\ ;\ p\ <\ p2\ ;\ p++)\ \ \textcolor{comment}{/*\ examine\ all\ neighbors\ of\ j\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00590}00590\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00591}00591\ \ \ \ \ \ \ \ \ \ \ \ \ i\ =\ Gi\ [p]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ consider\ neighbor\ node\ i\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00592}00592\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{cs_8h_ad5ef446ddee80d5771be956a23520bf5}{CS\_MARKED}}\ (Gp,\ i))\ continue\ ;\ \ \ \textcolor{comment}{/*\ skip\ visited\ node\ i\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00593}00593\ \ \ \ \ \ \ \ \ \ \ \ \ pstack\ [head]\ =\ p\ ;\ \ \ \ \ \textcolor{comment}{/*\ pause\ depth-\/first\ search\ of\ node\ j\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00594}00594\ \ \ \ \ \ \ \ \ \ \ \ \ xi\ [++head]\ =\ i\ ;\ \ \ \ \ \ \ \textcolor{comment}{/*\ start\ dfs\ at\ node\ i\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00595}00595\ \ \ \ \ \ \ \ \ \ \ \ \ done\ =\ 0\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ node\ j\ is\ not\ done\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00596}00596\ \ \ \ \ \ \ \ \ \ \ \ \ break\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ break,\ to\ start\ dfs\ (i)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00597}00597\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00598}00598\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (done)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ depth-\/first\ search\ at\ node\ j\ is\ done\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00599}00599\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00600}00600\ \ \ \ \ \ \ \ \ \ \ \ \ head-\/-\/\ ;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ remove\ j\ from\ the\ recursion\ stack\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00601}00601\ \ \ \ \ \ \ \ \ \ \ \ \ xi\ [-\/-\/top]\ =\ j\ ;\ \ \ \ \textcolor{comment}{/*\ and\ place\ in\ the\ output\ stack\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00602}00602\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00603}00603\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00604}00604\ \ \ \ \ \textcolor{keywordflow}{return}\ (top)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00605}00605\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00606}00606\ \textcolor{comment}{/*\ breadth-\/first\ search\ for\ coarse\ decomposition\ (C0,C1,R1\ or\ R0,R3,C3)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00607}\mbox{\hyperlink{cs_8c_aea9087115692dafed3933e585395cc53}{00607}}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_aea9087115692dafed3933e585395cc53}{cs\_bfs}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ n,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *wi,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *wj,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *queue,}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00608}00608\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *imatch,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *jmatch,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ mark)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00609}00609\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00610}00610\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *Ap,\ *Ai,\ head\ =\ 0,\ tail\ =\ 0,\ j,\ i,\ p,\ j2\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00611}00611\ \ \ \ \ \mbox{\hyperlink{structcs__sparse}{cs}}\ *C\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00612}00612\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0\ ;\ j\ <\ n\ ;\ j++)\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ place\ all\ unmatched\ nodes\ in\ queue\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00613}00613\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00614}00614\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (imatch\ [j]\ >=\ 0)\ continue\ ;\ \textcolor{comment}{/*\ skip\ j\ if\ matched\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00615}00615\ \ \ \ \ \ \ \ \ wj\ [j]\ =\ 0\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ j\ in\ set\ C0\ (R0\ if\ transpose)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00616}00616\ \ \ \ \ \ \ \ \ queue\ [tail++]\ =\ j\ ;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ place\ unmatched\ col\ j\ in\ queue\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00617}00617\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00618}00618\ \ \ \ \ \textcolor{keywordflow}{if}\ (tail\ ==\ 0)\ \textcolor{keywordflow}{return}\ (1)\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ quick\ return\ if\ no\ unmatched\ nodes\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00619}00619\ \ \ \ \ C\ =\ (mark\ ==\ 1)\ ?\ ((\mbox{\hyperlink{structcs__sparse}{cs}}\ *)\ A)\ :\ \mbox{\hyperlink{cs_8c_a838dfaabdae54c408a4a696dfffa3dea}{cs\_transpose}}\ (A,\ 0)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00620}00620\ \ \ \ \ \textcolor{keywordflow}{if}\ (!C)\ \textcolor{keywordflow}{return}\ (0)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ bfs\ of\ C=A'\ to\ find\ R3,C3\ from\ R0\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00621}00621\ \ \ \ \ Ap\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Ai\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00622}00622\ \ \ \ \ \textcolor{keywordflow}{while}\ (head\ <\ tail)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ while\ queue\ is\ not\ empty\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00623}00623\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00624}00624\ \ \ \ \ \ \ \ \ j\ =\ queue\ [head++]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ get\ the\ head\ of\ the\ queue\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00625}00625\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Ap\ [j]\ ;\ p\ <\ Ap\ [j+1]\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00626}00626\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00627}00627\ \ \ \ \ \ \ \ \ \ \ \ \ i\ =\ Ai\ [p]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00628}00628\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (wi\ [i]\ >=\ 0)\ continue\ ;\ \textcolor{comment}{/*\ skip\ if\ i\ is\ marked\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00629}00629\ \ \ \ \ \ \ \ \ \ \ \ \ wi\ [i]\ =\ mark\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ i\ in\ set\ R1\ (C3\ if\ transpose)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00630}00630\ \ \ \ \ \ \ \ \ \ \ \ \ j2\ =\ jmatch\ [i]\ ;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ traverse\ alternating\ path\ to\ j2\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00631}00631\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (wj\ [j2]\ >=\ 0)\ continue\ ;\textcolor{comment}{/*\ skip\ j2\ if\ it\ is\ marked\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00632}00632\ \ \ \ \ \ \ \ \ \ \ \ \ wj\ [j2]\ =\ mark\ ;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ j2\ in\ set\ C1\ (R3\ if\ transpose)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00633}00633\ \ \ \ \ \ \ \ \ \ \ \ \ queue\ [tail++]\ =\ j2\ ;\ \ \ \ \ \ \ \textcolor{comment}{/*\ add\ j2\ to\ queue\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00634}00634\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00635}00635\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00636}00636\ \ \ \ \ \textcolor{keywordflow}{if}\ (mark\ !=\ 1)\ \mbox{\hyperlink{cs_8c_a01a74117bb6004b0b844de5940ddee0a}{cs\_spfree}}\ (C)\ ;\ \ \ \ \ \ \textcolor{comment}{/*\ free\ A'\ if\ it\ was\ created\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00637}00637\ \ \ \ \ \textcolor{keywordflow}{return}\ (1)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00638}00638\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00639}00639\ }
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00640}00640\ \textcolor{comment}{/*\ collect\ matched\ rows\ and\ columns\ into\ p\ and\ q\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00641}\mbox{\hyperlink{cs_8c_af772851c796484c0ac096f3af8272ca4}{00641}}\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{cs_8c_af772851c796484c0ac096f3af8272ca4}{cs\_matched}}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ n,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *wj,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *imatch,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *p,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *q,}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00642}00642\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *cc,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *rr,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ set,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ mark)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00643}00643\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00644}00644\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ kc\ =\ cc\ [set],\ j\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00645}00645\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ kr\ =\ rr\ [set-\/1]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00646}00646\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0\ ;\ j\ <\ n\ ;\ j++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00647}00647\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00648}00648\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (wj\ [j]\ !=\ mark)\ continue\ ;\ \ \ \ \ \ \textcolor{comment}{/*\ skip\ if\ j\ is\ not\ in\ C\ set\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00649}00649\ \ \ \ \ \ \ \ \ p\ [kr++]\ =\ imatch\ [j]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00650}00650\ \ \ \ \ \ \ \ \ q\ [kc++]\ =\ j\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00651}00651\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00652}00652\ \ \ \ \ cc\ [set+1]\ =\ kc\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00653}00653\ \ \ \ \ rr\ [set]\ =\ kr\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00654}00654\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00655}00655\ }
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00656}00656\ \textcolor{comment}{/*\ collect\ unmatched\ rows\ into\ the\ permutation\ vector\ p\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00657}\mbox{\hyperlink{cs_8c_a4134ee7a686e64f8db102147f91e9ee3}{00657}}\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{cs_8c_a4134ee7a686e64f8db102147f91e9ee3}{cs\_unmatched}}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ m,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *wi,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *p,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *rr,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ set)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00658}00658\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00659}00659\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ i,\ kr\ =\ rr\ [set]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00660}00660\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0\ ;\ i\ <\ m\ ;\ i++)\ \textcolor{keywordflow}{if}\ (wi\ [i]\ ==\ 0)\ p\ [kr++]\ =\ i\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00661}00661\ \ \ \ \ rr\ [set+1]\ =\ kr\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00662}00662\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00663}00663\ }
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00664}00664\ \textcolor{comment}{/*\ return\ 1\ if\ row\ i\ is\ in\ R2\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00665}\mbox{\hyperlink{cs_8c_af2aa1c0d55d9f217f4a8c72210e7fc26}{00665}}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_af2aa1c0d55d9f217f4a8c72210e7fc26}{cs\_rprune}}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ i,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ j,\ \textcolor{keywordtype}{double}\ aij,\ \textcolor{keywordtype}{void}\ *other)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00666}00666\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00667}00667\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *rr\ =\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *)\ other\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00668}00668\ \ \ \ \ \textcolor{keywordflow}{return}\ (i\ >=\ rr\ [1]\ \&\&\ i\ <\ rr\ [2])\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00669}00669\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00670}00670\ }
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00671}00671\ \textcolor{comment}{/*\ Given\ A,\ compute\ coarse\ and\ then\ fine\ dmperm\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00672}\mbox{\hyperlink{cs_8c_a0a3ca56d66f3f3c350e90f560f593f68}{00672}}\ \mbox{\hyperlink{structcs__dmperm__results}{csd}}\ *\mbox{\hyperlink{cs_8c_a0a3ca56d66f3f3c350e90f560f593f68}{cs\_dmperm}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ seed)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00673}00673\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00674}00674\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ m,\ n,\ i,\ j,\ k,\ cnz,\ nc,\ *jmatch,\ *imatch,\ *wi,\ *wj,\ *pinv,\ *Cp,\ *Ci,}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00675}00675\ \ \ \ \ \ \ \ \ *ps,\ *rs,\ nb1,\ nb2,\ *p,\ *q,\ *cc,\ *rr,\ *r,\ *s,\ ok\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00676}00676\ \ \ \ \ \mbox{\hyperlink{structcs__sparse}{cs}}\ *C\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00677}00677\ \ \ \ \ \mbox{\hyperlink{structcs__dmperm__results}{csd}}\ *D,\ *scc\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00678}00678\ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/\ Maximum\ matching\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00679}00679\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A))\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00680}00680\ \ \ \ \ m\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a8dab81f7d781bd65c7cb4f103db87ade}{m}}\ ;\ n\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00681}00681\ \ \ \ \ D\ =\ \mbox{\hyperlink{cs_8c_a5b17812b02b3c113ce0088870aaeffd9}{cs\_dalloc}}\ (m,\ n)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ allocate\ result\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00682}00682\ \ \ \ \ \textcolor{keywordflow}{if}\ (!D)\ \textcolor{keywordflow}{return}\ (NULL)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00683}00683\ \ \ \ \ p\ =\ D-\/>\mbox{\hyperlink{structcs__dmperm__results_aa1cdef46dad146c0d64d64dbda23f44e}{p}}\ ;\ q\ =\ D-\/>\mbox{\hyperlink{structcs__dmperm__results_a76216ad1101a5b930eaf062ae3d48c99}{q}}\ ;\ r\ =\ D-\/>\mbox{\hyperlink{structcs__dmperm__results_a193ebe355ad15e9408fdf705e197833f}{r}}\ ;\ s\ =\ D-\/>\mbox{\hyperlink{structcs__dmperm__results_a6dd273f5ba6466e85e5ac158703911d0}{s}}\ ;\ cc\ =\ D-\/>\mbox{\hyperlink{structcs__dmperm__results_a7078a0543f4ad701596e75c1f2055813}{cc}}\ ;\ rr\ =\ D-\/>\mbox{\hyperlink{structcs__dmperm__results_a553659515b7ea8657cec9e434f4f0c3a}{rr}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00684}00684\ \ \ \ \ jmatch\ =\ \mbox{\hyperlink{cs_8c_ae11aacb8a4488eb14972d4ac490036ca}{cs\_maxtrans}}\ (A,\ seed)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ max\ transversal\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00685}00685\ \ \ \ \ imatch\ =\ jmatch\ +\ m\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ imatch\ =\ inverse\ of\ jmatch\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00686}00686\ \ \ \ \ \textcolor{keywordflow}{if}\ (!jmatch)\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_aa848643a3fad58acb3b400c36de5dd3e}{cs\_ddone}}\ (D,\ NULL,\ jmatch,\ 0))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00687}00687\ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/\ Coarse\ decomposition\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00688}00688\ \ \ \ \ wi\ =\ r\ ;\ wj\ =\ s\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ use\ r\ and\ s\ as\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00689}00689\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0\ ;\ j\ <\ n\ ;\ j++)\ wj\ [j]\ =\ -\/1\ ;\ \ \ \ \ \textcolor{comment}{/*\ unmark\ all\ cols\ for\ bfs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00690}00690\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0\ ;\ i\ <\ m\ ;\ i++)\ wi\ [i]\ =\ -\/1\ ;\ \ \ \ \ \textcolor{comment}{/*\ unmark\ all\ rows\ for\ bfs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00691}00691\ \ \ \ \ \mbox{\hyperlink{cs_8c_aea9087115692dafed3933e585395cc53}{cs\_bfs}}\ (A,\ n,\ wi,\ wj,\ q,\ imatch,\ jmatch,\ 1)\ ;\ \ \ \ \ \ \ \textcolor{comment}{/*\ find\ C1,\ R1\ from\ C0*/}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00692}00692\ \ \ \ \ ok\ =\ \mbox{\hyperlink{cs_8c_aea9087115692dafed3933e585395cc53}{cs\_bfs}}\ (A,\ m,\ wj,\ wi,\ p,\ jmatch,\ imatch,\ 3)\ ;\ \ \textcolor{comment}{/*\ find\ R3,\ C3\ from\ R0*/}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00693}00693\ \ \ \ \ \textcolor{keywordflow}{if}\ (!ok)\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_aa848643a3fad58acb3b400c36de5dd3e}{cs\_ddone}}\ (D,\ NULL,\ jmatch,\ 0))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00694}00694\ \ \ \ \ \mbox{\hyperlink{cs_8c_a4134ee7a686e64f8db102147f91e9ee3}{cs\_unmatched}}\ (n,\ wj,\ q,\ cc,\ 0)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ unmatched\ set\ C0\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00695}00695\ \ \ \ \ \mbox{\hyperlink{cs_8c_af772851c796484c0ac096f3af8272ca4}{cs\_matched}}\ (n,\ wj,\ imatch,\ p,\ q,\ cc,\ rr,\ 1,\ 1)\ ;\ \ \ \ \textcolor{comment}{/*\ set\ R1\ and\ C1\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00696}00696\ \ \ \ \ \mbox{\hyperlink{cs_8c_af772851c796484c0ac096f3af8272ca4}{cs\_matched}}\ (n,\ wj,\ imatch,\ p,\ q,\ cc,\ rr,\ 2,\ -\/1)\ ;\ \ \ \textcolor{comment}{/*\ set\ R2\ and\ C2\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00697}00697\ \ \ \ \ \mbox{\hyperlink{cs_8c_af772851c796484c0ac096f3af8272ca4}{cs\_matched}}\ (n,\ wj,\ imatch,\ p,\ q,\ cc,\ rr,\ 3,\ 3)\ ;\ \ \ \ \textcolor{comment}{/*\ set\ R3\ and\ C3\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00698}00698\ \ \ \ \ \mbox{\hyperlink{cs_8c_a4134ee7a686e64f8db102147f91e9ee3}{cs\_unmatched}}\ (m,\ wi,\ p,\ rr,\ 3)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ unmatched\ set\ R0\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00699}00699\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (jmatch)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00700}00700\ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/\ Fine\ decomposition\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00701}00701\ \ \ \ \ pinv\ =\ \mbox{\hyperlink{cs_8c_ae8aefba6d94d832505cc7ed4b0d78548}{cs\_pinv}}\ (p,\ m)\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ pinv=p'\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00702}00702\ \ \ \ \ \textcolor{keywordflow}{if}\ (!pinv)\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_aa848643a3fad58acb3b400c36de5dd3e}{cs\_ddone}}\ (D,\ NULL,\ NULL,\ 0))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00703}00703\ \ \ \ \ C\ =\ \mbox{\hyperlink{cs_8c_aa09de703c0e946fe0d8a61dacbd78aa4}{cs\_permute}}\ (A,\ pinv,\ q,\ 0)\ ;\textcolor{comment}{/*\ C=A(p,q)\ (it\ will\ hold\ A(R2,C2))\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00704}00704\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (pinv)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00705}00705\ \ \ \ \ \textcolor{keywordflow}{if}\ (!C)\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_aa848643a3fad58acb3b400c36de5dd3e}{cs\_ddone}}\ (D,\ NULL,\ NULL,\ 0))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00706}00706\ \ \ \ \ Cp\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00707}00707\ \ \ \ \ nc\ =\ cc\ [3]\ -\/\ cc\ [2]\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ delete\ cols\ C0,\ C1,\ and\ C3\ from\ C\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00708}00708\ \ \ \ \ \textcolor{keywordflow}{if}\ (cc\ [2]\ >\ 0)\ \textcolor{keywordflow}{for}\ (j\ =\ cc\ [2]\ ;\ j\ <=\ cc\ [3]\ ;\ j++)\ Cp\ [j-\/cc[2]]\ =\ Cp\ [j]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00709}00709\ \ \ \ \ C-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ =\ nc\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00710}00710\ \ \ \ \ \textcolor{keywordflow}{if}\ (rr\ [2]\ -\/\ rr\ [1]\ <\ m)\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ delete\ rows\ R0,\ R1,\ and\ R3\ from\ C\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00711}00711\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00712}00712\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8c_a0467456f70ba2840b1876b42ae1f990b}{cs\_fkeep}}\ (C,\ \mbox{\hyperlink{cs_8c_af2aa1c0d55d9f217f4a8c72210e7fc26}{cs\_rprune}},\ rr)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00713}00713\ \ \ \ \ \ \ \ \ cnz\ =\ Cp\ [nc]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00714}00714\ \ \ \ \ \ \ \ \ Ci\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00715}00715\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rr\ [1]\ >\ 0)\ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ cnz\ ;\ k++)\ Ci\ [k]\ -\/=\ rr\ [1]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00716}00716\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00717}00717\ \ \ \ \ C-\/>\mbox{\hyperlink{structcs__sparse_a8dab81f7d781bd65c7cb4f103db87ade}{m}}\ =\ nc\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00718}00718\ \ \ \ \ scc\ =\ \mbox{\hyperlink{cs_8c_a195331bbf7d2aa87b1a94158c5d56d17}{cs\_scc}}\ (C)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ find\ strongly\ connected\ components\ of\ C*/}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00719}00719\ \ \ \ \ \textcolor{keywordflow}{if}\ (!scc)\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_aa848643a3fad58acb3b400c36de5dd3e}{cs\_ddone}}\ (D,\ C,\ NULL,\ 0))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00720}00720\ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/\ Combine\ coarse\ and\ fine\ decompositions\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00721}00721\ \ \ \ \ ps\ =\ scc-\/>\mbox{\hyperlink{structcs__dmperm__results_aa1cdef46dad146c0d64d64dbda23f44e}{p}}\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ C(ps,ps)\ is\ the\ permuted\ matrix\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00722}00722\ \ \ \ \ rs\ =\ scc-\/>\mbox{\hyperlink{structcs__dmperm__results_a193ebe355ad15e9408fdf705e197833f}{r}}\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ kth\ block\ is\ rs[k]..rs[k+1]-\/1\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00723}00723\ \ \ \ \ nb1\ =\ scc-\/>\mbox{\hyperlink{structcs__dmperm__results_aecf39880909b599bcbf205e214e99354}{nb}}\ \ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ \#\ of\ blocks\ of\ A(R2,C2)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00724}00724\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ nc\ ;\ k++)\ wj\ [k]\ =\ q\ [ps\ [k]\ +\ cc\ [2]]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00725}00725\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ nc\ ;\ k++)\ q\ [k\ +\ cc\ [2]]\ =\ wj\ [k]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00726}00726\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ nc\ ;\ k++)\ wi\ [k]\ =\ p\ [ps\ [k]\ +\ rr\ [1]]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00727}00727\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ nc\ ;\ k++)\ p\ [k\ +\ rr\ [1]]\ =\ wi\ [k]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00728}00728\ \ \ \ \ nb2\ =\ 0\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ create\ the\ fine\ block\ partitions\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00729}00729\ \ \ \ \ r\ [0]\ =\ s\ [0]\ =\ 0\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00730}00730\ \ \ \ \ \textcolor{keywordflow}{if}\ (cc\ [2]\ >\ 0)\ nb2++\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ leading\ coarse\ block\ A\ (R1,\ [C0\ C1])\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00731}00731\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ nb1\ ;\ k++)\ \ \ \ \ \textcolor{comment}{/*\ coarse\ block\ A\ (R2,C2)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00732}00732\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00733}00733\ \ \ \ \ \ \ \ \ r\ [nb2]\ =\ rs\ [k]\ +\ rr\ [1]\ ;\ \textcolor{comment}{/*\ A\ (R2,C2)\ splits\ into\ nb1\ fine\ blocks\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00734}00734\ \ \ \ \ \ \ \ \ s\ [nb2]\ =\ rs\ [k]\ +\ cc\ [2]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00735}00735\ \ \ \ \ \ \ \ \ nb2++\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00736}00736\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00737}00737\ \ \ \ \ \textcolor{keywordflow}{if}\ (rr\ [2]\ <\ m)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00738}00738\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00739}00739\ \ \ \ \ \ \ \ \ r\ [nb2]\ =\ rr\ [2]\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ trailing\ coarse\ block\ A\ ([R3\ R0],\ C3)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00740}00740\ \ \ \ \ \ \ \ \ s\ [nb2]\ =\ cc\ [3]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00741}00741\ \ \ \ \ \ \ \ \ nb2++\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00742}00742\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00743}00743\ \ \ \ \ r\ [nb2]\ =\ m\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00744}00744\ \ \ \ \ s\ [nb2]\ =\ n\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00745}00745\ \ \ \ \ D-\/>\mbox{\hyperlink{structcs__dmperm__results_aecf39880909b599bcbf205e214e99354}{nb}}\ =\ nb2\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00746}00746\ \ \ \ \ \mbox{\hyperlink{cs_8c_a30f07e6f09ffa0de8a961de63e624c8e}{cs\_dfree}}\ (scc)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00747}00747\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_aa848643a3fad58acb3b400c36de5dd3e}{cs\_ddone}}\ (D,\ C,\ NULL,\ 1))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00748}00748\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00749}\mbox{\hyperlink{cs_8c_ab0bd21db7c0118b0cd2277f76b9f46cf}{00749}}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_ab0bd21db7c0118b0cd2277f76b9f46cf}{cs\_tol}}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ i,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ j,\ \textcolor{keywordtype}{double}\ aij,\ \textcolor{keywordtype}{void}\ *tol)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00750}00750\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00751}00751\ \ \ \ \ \textcolor{keywordflow}{return}\ (fabs\ (aij)\ >\ *((\textcolor{keywordtype}{double}\ *)\ tol))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00752}00752\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00753}\mbox{\hyperlink{cs_8c_a40bd42bbf6db19e2c068da3a7f429dac}{00753}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_a40bd42bbf6db19e2c068da3a7f429dac}{cs\_droptol}}\ (\mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \textcolor{keywordtype}{double}\ tol)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00754}00754\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00755}00755\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a0467456f70ba2840b1876b42ae1f990b}{cs\_fkeep}}\ (A,\ \&\mbox{\hyperlink{cs_8c_ab0bd21db7c0118b0cd2277f76b9f46cf}{cs\_tol}},\ \&tol))\ ;\ \ \ \ \textcolor{comment}{/*\ keep\ all\ large\ entries\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00756}00756\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00757}\mbox{\hyperlink{cs_8c_a2faf963624753cb7c36083c47321ef08}{00757}}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_a2faf963624753cb7c36083c47321ef08}{cs\_nonzero}}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ i,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ j,\ \textcolor{keywordtype}{double}\ aij,\ \textcolor{keywordtype}{void}\ *other)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00758}00758\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00759}00759\ \ \ \ \ \textcolor{keywordflow}{return}\ (aij\ !=\ 0)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00760}00760\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00761}\mbox{\hyperlink{cs_8c_a038d56f7a15bb02c3b8309f3eff78d59}{00761}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_a038d56f7a15bb02c3b8309f3eff78d59}{cs\_dropzeros}}\ (\mbox{\hyperlink{structcs__sparse}{cs}}\ *A)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00762}00762\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00763}00763\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a0467456f70ba2840b1876b42ae1f990b}{cs\_fkeep}}\ (A,\ \&\mbox{\hyperlink{cs_8c_a2faf963624753cb7c36083c47321ef08}{cs\_nonzero}},\ NULL))\ ;\ \ \textcolor{comment}{/*\ keep\ all\ nonzero\ entries\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00764}00764\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00765}00765\ \textcolor{comment}{/*\ remove\ duplicate\ entries\ from\ A\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00766}\mbox{\hyperlink{cs_8c_ab3c714102b93af81d9f6225699fc020d}{00766}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_ab3c714102b93af81d9f6225699fc020d}{cs\_dupl}}\ (\mbox{\hyperlink{structcs__sparse}{cs}}\ *A)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00767}00767\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00768}00768\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ i,\ j,\ p,\ q,\ nz\ =\ 0,\ n,\ m,\ *Ap,\ *Ai,\ *w\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00769}00769\ \ \ \ \ \textcolor{keywordtype}{double}\ *Ax\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00770}00770\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A))\ \textcolor{keywordflow}{return}\ (0)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00771}00771\ \ \ \ \ m\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a8dab81f7d781bd65c7cb4f103db87ade}{m}}\ ;\ n\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;\ Ap\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Ai\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Ax\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00772}00772\ \ \ \ \ w\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (m,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ get\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00773}00773\ \ \ \ \ \textcolor{keywordflow}{if}\ (!w)\ \textcolor{keywordflow}{return}\ (0)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ out\ of\ memory\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00774}00774\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0\ ;\ i\ <\ m\ ;\ i++)\ w\ [i]\ =\ -\/1\ ;\ \ \ \ \ \ \textcolor{comment}{/*\ row\ i\ not\ yet\ seen\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00775}00775\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0\ ;\ j\ <\ n\ ;\ j++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00776}00776\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00777}00777\ \ \ \ \ \ \ \ \ q\ =\ nz\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ column\ j\ will\ start\ at\ q\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00778}00778\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Ap\ [j]\ ;\ p\ <\ Ap\ [j+1]\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00779}00779\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00780}00780\ \ \ \ \ \ \ \ \ \ \ \ \ i\ =\ Ai\ [p]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ A(i,j)\ is\ nonzero\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00781}00781\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (w\ [i]\ >=\ q)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00782}00782\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00783}00783\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Ax\ [w\ [i]]\ +=\ Ax\ [p]\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ A(i,j)\ is\ a\ duplicate\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00784}00784\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00785}00785\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00786}00786\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00787}00787\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ w\ [i]\ =\ nz\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ record\ where\ row\ i\ occurs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00788}00788\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Ai\ [nz]\ =\ i\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ keep\ A(i,j)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00789}00789\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Ax\ [nz++]\ =\ Ax\ [p]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00790}00790\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00791}00791\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00792}00792\ \ \ \ \ \ \ \ \ Ap\ [j]\ =\ q\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ record\ start\ of\ column\ j\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00793}00793\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00794}00794\ \ \ \ \ Ap\ [n]\ =\ nz\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ finalize\ A\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00795}00795\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (w)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ free\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00796}00796\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a4f6f6d0b8acba23772fd254ec794e966}{cs\_sprealloc}}\ (A,\ 0))\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ remove\ extra\ space\ from\ A\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00797}00797\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00798}00798\ \textcolor{comment}{/*\ add\ an\ entry\ to\ a\ triplet\ matrix;\ return\ 1\ if\ ok,\ 0\ otherwise\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00799}\mbox{\hyperlink{cs_8c_aa0248f7b6f20bf38c85e9a94a0818204}{00799}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_aa0248f7b6f20bf38c85e9a94a0818204}{cs\_entry}}\ (\mbox{\hyperlink{structcs__sparse}{cs}}\ *T,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ i,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ j,\ \textcolor{keywordtype}{double}\ x)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00800}00800\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00801}00801\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a62bab576c9482f6e11c4cee5a1b5a39a}{CS\_TRIPLET}}\ (T)\ ||\ i\ <\ 0\ ||\ j\ <\ 0)\ \textcolor{keywordflow}{return}\ (0)\ ;\ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00802}00802\ \ \ \ \ \textcolor{keywordflow}{if}\ (T-\/>\mbox{\hyperlink{structcs__sparse_a8eb7205d5e8fbb0c08a80e9fd52d2963}{nz}}\ >=\ T-\/>\mbox{\hyperlink{structcs__sparse_a4d98fb7ac430adab928f42e45d7c5504}{nzmax}}\ \&\&\ !\mbox{\hyperlink{cs_8c_a4f6f6d0b8acba23772fd254ec794e966}{cs\_sprealloc}}\ (T,2*(T-\/>\mbox{\hyperlink{structcs__sparse_a4d98fb7ac430adab928f42e45d7c5504}{nzmax}})))\ \textcolor{keywordflow}{return}\ (0)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00803}00803\ \ \ \ \ \textcolor{keywordflow}{if}\ (T-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}})\ T-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ [T-\/>\mbox{\hyperlink{structcs__sparse_a8eb7205d5e8fbb0c08a80e9fd52d2963}{nz}}]\ =\ x\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00804}00804\ \ \ \ \ T-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ [T-\/>\mbox{\hyperlink{structcs__sparse_a8eb7205d5e8fbb0c08a80e9fd52d2963}{nz}}]\ =\ i\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00805}00805\ \ \ \ \ T-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ [T-\/>\mbox{\hyperlink{structcs__sparse_a8eb7205d5e8fbb0c08a80e9fd52d2963}{nz}}++]\ =\ j\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00806}00806\ \ \ \ \ T-\/>\mbox{\hyperlink{structcs__sparse_a8dab81f7d781bd65c7cb4f103db87ade}{m}}\ =\ \mbox{\hyperlink{cs_8h_a7447e0bed6bf453743551d158e019e8b}{CS\_MAX}}\ (T-\/>\mbox{\hyperlink{structcs__sparse_a8dab81f7d781bd65c7cb4f103db87ade}{m}},\ i+1)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00807}00807\ \ \ \ \ T-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ =\ \mbox{\hyperlink{cs_8h_a7447e0bed6bf453743551d158e019e8b}{CS\_MAX}}\ (T-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}},\ j+1)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00808}00808\ \ \ \ \ \textcolor{keywordflow}{return}\ (1)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00809}00809\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00810}00810\ \textcolor{comment}{/*\ find\ nonzero\ pattern\ of\ Cholesky\ L(k,1:k-\/1)\ using\ etree\ and\ triu(A(:,k))\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00811}\mbox{\hyperlink{cs_8c_ab6bc6149bec190fcbdc19058e7d54034}{00811}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_ab6bc6149bec190fcbdc19058e7d54034}{cs\_ereach}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ k,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *parent,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *s,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *w)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00812}00812\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00813}00813\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ i,\ p,\ n,\ len,\ top,\ *Ap,\ *Ai\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00814}00814\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A)\ ||\ !parent\ ||\ !s\ ||\ !w)\ \textcolor{keywordflow}{return}\ (-\/1)\ ;\ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00815}00815\ \ \ \ \ top\ =\ n\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;\ Ap\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Ai\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00816}00816\ \ \ \ \ \mbox{\hyperlink{cs_8h_ad5096d9a8169cff461816575072022f0}{CS\_MARK}}\ (w,\ k)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ mark\ node\ k\ as\ visited\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00817}00817\ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Ap\ [k]\ ;\ p\ <\ Ap\ [k+1]\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00818}00818\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00819}00819\ \ \ \ \ \ \ \ \ i\ =\ Ai\ [p]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ A(i,k)\ is\ nonzero\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00820}00820\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ >\ k)\ continue\ ;\ \ \ \ \ \ \ \textcolor{comment}{/*\ only\ use\ upper\ triangular\ part\ of\ A\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00821}00821\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (len\ =\ 0\ ;\ !\mbox{\hyperlink{cs_8h_ad5ef446ddee80d5771be956a23520bf5}{CS\_MARKED}}\ (w,i)\ ;\ i\ =\ parent\ [i])\ \textcolor{comment}{/*\ traverse\ up\ etree*/}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00822}00822\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00823}00823\ \ \ \ \ \ \ \ \ \ \ \ \ s\ [len++]\ =\ i\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ L(k,i)\ is\ nonzero\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00824}00824\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8h_ad5096d9a8169cff461816575072022f0}{CS\_MARK}}\ (w,\ i)\ ;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ mark\ i\ as\ visited\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00825}00825\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00826}00826\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (len\ >\ 0)\ s\ [-\/-\/top]\ =\ s\ [-\/-\/len]\ ;\ \textcolor{comment}{/*\ push\ path\ onto\ stack\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00827}00827\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00828}00828\ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ top\ ;\ p\ <\ n\ ;\ p++)\ \mbox{\hyperlink{cs_8h_ad5096d9a8169cff461816575072022f0}{CS\_MARK}}\ (w,\ s\ [p])\ ;\ \ \ \ \textcolor{comment}{/*\ unmark\ all\ nodes\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00829}00829\ \ \ \ \ \mbox{\hyperlink{cs_8h_ad5096d9a8169cff461816575072022f0}{CS\_MARK}}\ (w,\ k)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ unmark\ node\ k\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00830}00830\ \ \ \ \ \textcolor{keywordflow}{return}\ (top)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ s\ [top..n-\/1]\ contains\ pattern\ of\ L(k,:)*/}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00831}00831\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00832}00832\ \textcolor{comment}{/*\ compute\ the\ etree\ of\ A\ (using\ triu(A),\ or\ A'A\ without\ forming\ A'A\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00833}\mbox{\hyperlink{cs_8c_a86d7b84d5a4cdf928556bcd30a413a84}{00833}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *\mbox{\hyperlink{cs_8c_a86d7b84d5a4cdf928556bcd30a413a84}{cs\_etree}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ ata)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00834}00834\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00835}00835\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ i,\ k,\ p,\ m,\ n,\ inext,\ *Ap,\ *Ai,\ *w,\ *parent,\ *ancestor,\ *prev\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00836}00836\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A))\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00837}00837\ \ \ \ \ m\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a8dab81f7d781bd65c7cb4f103db87ade}{m}}\ ;\ n\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;\ Ap\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Ai\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00838}00838\ \ \ \ \ parent\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (n,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ allocate\ result\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00839}00839\ \ \ \ \ w\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (n\ +\ (ata\ ?\ m\ :\ 0),\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \ \ \textcolor{comment}{/*\ get\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00840}00840\ \ \ \ \ \textcolor{keywordflow}{if}\ (!w\ ||\ !parent)\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a5f172de9436558173ef0b873d9e1a5db}{cs\_idone}}\ (parent,\ NULL,\ w,\ 0))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00841}00841\ \ \ \ \ ancestor\ =\ w\ ;\ prev\ =\ w\ +\ n\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00842}00842\ \ \ \ \ \textcolor{keywordflow}{if}\ (ata)\ \textcolor{keywordflow}{for}\ (i\ =\ 0\ ;\ i\ <\ m\ ;\ i++)\ prev\ [i]\ =\ -\/1\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00843}00843\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ n\ ;\ k++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00844}00844\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00845}00845\ \ \ \ \ \ \ \ \ parent\ [k]\ =\ -\/1\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ node\ k\ has\ no\ parent\ yet\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00846}00846\ \ \ \ \ \ \ \ \ ancestor\ [k]\ =\ -\/1\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ nor\ does\ k\ have\ an\ ancestor\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00847}00847\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Ap\ [k]\ ;\ p\ <\ Ap\ [k+1]\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00848}00848\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00849}00849\ \ \ \ \ \ \ \ \ \ \ \ \ i\ =\ ata\ ?\ (prev\ [Ai\ [p]])\ :\ (Ai\ [p])\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00850}00850\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\ ;\ i\ !=\ -\/1\ \&\&\ i\ <\ k\ ;\ i\ =\ inext)\ \ \ \textcolor{comment}{/*\ traverse\ from\ i\ to\ k\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00851}00851\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00852}00852\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ inext\ =\ ancestor\ [i]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ inext\ =\ ancestor\ of\ i\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00853}00853\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ancestor\ [i]\ =\ k\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ path\ compression\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00854}00854\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (inext\ ==\ -\/1)\ parent\ [i]\ =\ k\ ;\ \ \ \textcolor{comment}{/*\ no\ anc.,\ parent\ is\ k\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00855}00855\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00856}00856\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ata)\ prev\ [Ai\ [p]]\ =\ k\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00857}00857\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00858}00858\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00859}00859\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a5f172de9436558173ef0b873d9e1a5db}{cs\_idone}}\ (parent,\ NULL,\ w,\ 1))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00860}00860\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00861}00861\ \textcolor{comment}{/*\ drop\ entries\ for\ which\ fkeep(A(i,j))\ is\ false;\ return\ nz\ if\ OK,\ else\ -\/1\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00862}\mbox{\hyperlink{cs_8c_a0467456f70ba2840b1876b42ae1f990b}{00862}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_a0467456f70ba2840b1876b42ae1f990b}{cs\_fkeep}}\ (\mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ (*fkeep)\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}},\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}},\ \textcolor{keywordtype}{double},\ \textcolor{keywordtype}{void}\ *),\ \textcolor{keywordtype}{void}\ *other)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00863}00863\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00864}00864\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ j,\ p,\ nz\ =\ 0,\ n,\ *Ap,\ *Ai\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00865}00865\ \ \ \ \ \textcolor{keywordtype}{double}\ *Ax\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00866}00866\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A)\ ||\ !fkeep)\ \textcolor{keywordflow}{return}\ (-\/1)\ ;\ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00867}00867\ \ \ \ \ n\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;\ Ap\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Ai\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Ax\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00868}00868\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0\ ;\ j\ <\ n\ ;\ j++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00869}00869\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00870}00870\ \ \ \ \ \ \ \ \ p\ =\ Ap\ [j]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ get\ current\ location\ of\ col\ j\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00871}00871\ \ \ \ \ \ \ \ \ Ap\ [j]\ =\ nz\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ record\ new\ location\ of\ col\ j\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00872}00872\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\ ;\ p\ <\ Ap\ [j+1]\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00873}00873\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00874}00874\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (fkeep\ (Ai\ [p],\ j,\ Ax\ ?\ Ax\ [p]\ :\ 1,\ other))}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00875}00875\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00876}00876\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (Ax)\ Ax\ [nz]\ =\ Ax\ [p]\ ;\ \ \textcolor{comment}{/*\ keep\ A(i,j)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00877}00877\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Ai\ [nz++]\ =\ Ai\ [p]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00878}00878\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00879}00879\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00880}00880\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00881}00881\ \ \ \ \ Ap\ [n]\ =\ nz\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ finalize\ A\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00882}00882\ \ \ \ \ \mbox{\hyperlink{cs_8c_a4f6f6d0b8acba23772fd254ec794e966}{cs\_sprealloc}}\ (A,\ 0)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ remove\ extra\ space\ from\ A\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00883}00883\ \ \ \ \ \textcolor{keywordflow}{return}\ (nz)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00884}00884\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00885}00885\ \textcolor{comment}{/*\ y\ =\ A*x+y\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00886}\mbox{\hyperlink{cs_8c_a86eb5ff5033618cf4f76d8c75db49e65}{00886}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_a86eb5ff5033618cf4f76d8c75db49e65}{cs\_gaxpy}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ *x,\ \textcolor{keywordtype}{double}\ *y)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00887}00887\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00888}00888\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ p,\ j,\ n,\ *Ap,\ *Ai\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00889}00889\ \ \ \ \ \textcolor{keywordtype}{double}\ *Ax\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00890}00890\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A)\ ||\ !x\ ||\ !y)\ \textcolor{keywordflow}{return}\ (0)\ ;\ \ \ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00891}00891\ \ \ \ \ n\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;\ Ap\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Ai\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Ax\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00892}00892\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0\ ;\ j\ <\ n\ ;\ j++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00893}00893\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00894}00894\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Ap\ [j]\ ;\ p\ <\ Ap\ [j+1]\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00895}00895\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00896}00896\ \ \ \ \ \ \ \ \ \ \ \ \ y\ [Ai\ [p]]\ +=\ Ax\ [p]\ *\ x\ [j]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00897}00897\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00898}00898\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00899}00899\ \ \ \ \ \textcolor{keywordflow}{return}\ (1)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00900}00900\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00901}00901\ \textcolor{comment}{/*\ apply\ the\ ith\ Householder\ vector\ to\ x\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00902}\mbox{\hyperlink{cs_8c_a88a82fabd191059a8db610fbfe6b008a}{00902}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_a88a82fabd191059a8db610fbfe6b008a}{cs\_happly}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *V,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ i,\ \textcolor{keywordtype}{double}\ beta,\ \textcolor{keywordtype}{double}\ *x)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00903}00903\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00904}00904\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ p,\ *Vp,\ *Vi\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00905}00905\ \ \ \ \ \textcolor{keywordtype}{double}\ *Vx,\ tau\ =\ 0\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00906}00906\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (V)\ ||\ !x)\ \textcolor{keywordflow}{return}\ (0)\ ;\ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00907}00907\ \ \ \ \ Vp\ =\ V-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Vi\ =\ V-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Vx\ =\ V-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00908}00908\ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Vp\ [i]\ ;\ p\ <\ Vp\ [i+1]\ ;\ p++)\ \ \ \textcolor{comment}{/*\ tau\ =\ v'*x\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00909}00909\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00910}00910\ \ \ \ \ \ \ \ \ tau\ +=\ Vx\ [p]\ *\ x\ [Vi\ [p]]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00911}00911\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00912}00912\ \ \ \ \ tau\ *=\ beta\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ tau\ =\ beta*(v'*x)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00913}00913\ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Vp\ [i]\ ;\ p\ <\ Vp\ [i+1]\ ;\ p++)\ \ \ \textcolor{comment}{/*\ x\ =\ x\ -\/\ v*tau\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00914}00914\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00915}00915\ \ \ \ \ \ \ \ \ x\ [Vi\ [p]]\ -\/=\ Vx\ [p]\ *\ tau\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00916}00916\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00917}00917\ \ \ \ \ \textcolor{keywordflow}{return}\ (1)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00918}00918\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00919}00919\ \textcolor{comment}{/*\ create\ a\ Householder\ reflection\ [v,beta,s]=house(x),\ overwrite\ x\ with\ v,}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00920}00920\ \textcolor{comment}{\ *\ where\ (I-\/beta*v*v')*x\ =\ s*e1.\ \ See\ Algo\ 5.1.1,\ Golub\ \&\ Van\ Loan,\ 3rd\ ed.\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00921}\mbox{\hyperlink{cs_8c_af4e2e546282433ebb90343c8535dd1fe}{00921}}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{cs_8c_af4e2e546282433ebb90343c8535dd1fe}{cs\_house}}\ (\textcolor{keywordtype}{double}\ *x,\ \textcolor{keywordtype}{double}\ *beta,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ n)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00922}00922\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00923}00923\ \ \ \ \ \textcolor{keywordtype}{double}\ s,\ sigma\ =\ 0\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00924}00924\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ i\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00925}00925\ \ \ \ \ \textcolor{keywordflow}{if}\ (!x\ ||\ !beta)\ \textcolor{keywordflow}{return}\ (-\/1)\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00926}00926\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 1\ ;\ i\ <\ n\ ;\ i++)\ sigma\ +=\ x\ [i]\ *\ x\ [i]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00927}00927\ \ \ \ \ \textcolor{keywordflow}{if}\ (sigma\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00928}00928\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00929}00929\ \ \ \ \ \ \ \ \ s\ =\ fabs\ (x\ [0])\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ s\ =\ |x(0)|\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00930}00930\ \ \ \ \ \ \ \ \ (*beta)\ =\ (x\ [0]\ <=\ 0)\ ?\ 2\ :\ 0\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00931}00931\ \ \ \ \ \ \ \ \ x\ [0]\ =\ 1\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00932}00932\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00933}00933\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00934}00934\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00935}00935\ \ \ \ \ \ \ \ \ s\ =\ sqrt\ (x\ [0]\ *\ x\ [0]\ +\ sigma)\ ;\ \ \textcolor{comment}{/*\ s\ =\ norm\ (x)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00936}00936\ \ \ \ \ \ \ \ \ x\ [0]\ =\ (x\ [0]\ <=\ 0)\ ?\ (x\ [0]\ -\/\ s)\ :\ (-\/sigma\ /\ (x\ [0]\ +\ s))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00937}00937\ \ \ \ \ \ \ \ \ (*beta)\ =\ -\/1.\ /\ (s\ *\ x\ [0])\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00938}00938\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00939}00939\ \ \ \ \ \textcolor{keywordflow}{return}\ (s)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00940}00940\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00941}00941\ \textcolor{comment}{/*\ x(p)\ =\ b,\ for\ dense\ vectors\ x\ and\ b;\ p=NULL\ denotes\ identity\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00942}\mbox{\hyperlink{cs_8c_a0938ec08825dc07a2dab8f9477ab053b}{00942}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_a0938ec08825dc07a2dab8f9477ab053b}{cs\_ipvec}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *p,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ *b,\ \textcolor{keywordtype}{double}\ *x,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ n)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00943}00943\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00944}00944\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ k\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00945}00945\ \ \ \ \ \textcolor{keywordflow}{if}\ (!x\ ||\ !b)\ \textcolor{keywordflow}{return}\ (0)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00946}00946\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ n\ ;\ k++)\ x\ [p\ ?\ p\ [k]\ :\ k]\ =\ b\ [k]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00947}00947\ \ \ \ \ \textcolor{keywordflow}{return}\ (1)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00948}00948\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00949}00949\ \textcolor{comment}{/*\ consider\ A(i,j),\ node\ j\ in\ ith\ row\ subtree\ and\ return\ lca(jprev,j)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00950}\mbox{\hyperlink{cs_8c_aaeedf973ec2de811ead0e47f8501a81d}{00950}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_aaeedf973ec2de811ead0e47f8501a81d}{cs\_leaf}}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ i,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ j,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *first,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *maxfirst,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *prevleaf,}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00951}00951\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *ancestor,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *jleaf)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00952}00952\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00953}00953\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ q,\ s,\ sparent,\ jprev\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00954}00954\ \ \ \ \ \textcolor{keywordflow}{if}\ (!first\ ||\ !maxfirst\ ||\ !prevleaf\ ||\ !ancestor\ ||\ !jleaf)\ \textcolor{keywordflow}{return}\ (-\/1)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00955}00955\ \ \ \ \ *jleaf\ =\ 0\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00956}00956\ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ <=\ j\ ||\ first\ [j]\ <=\ maxfirst\ [i])\ \textcolor{keywordflow}{return}\ (-\/1)\ ;\ \ \textcolor{comment}{/*\ j\ not\ a\ leaf\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00957}00957\ \ \ \ \ maxfirst\ [i]\ =\ first\ [j]\ ;\ \ \ \ \ \ \textcolor{comment}{/*\ update\ max\ first[j]\ seen\ so\ far\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00958}00958\ \ \ \ \ jprev\ =\ prevleaf\ [i]\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ jprev\ =\ previous\ leaf\ of\ ith\ subtree\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00959}00959\ \ \ \ \ prevleaf\ [i]\ =\ j\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00960}00960\ \ \ \ \ *jleaf\ =\ (jprev\ ==\ -\/1)\ ?\ 1:\ 2\ ;\ \textcolor{comment}{/*\ j\ is\ first\ or\ subsequent\ leaf\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00961}00961\ \ \ \ \ \textcolor{keywordflow}{if}\ (*jleaf\ ==\ 1)\ \textcolor{keywordflow}{return}\ (i)\ ;\ \ \ \textcolor{comment}{/*\ if\ 1st\ leaf,\ q\ =\ root\ of\ ith\ subtree\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00962}00962\ \ \ \ \ \textcolor{keywordflow}{for}\ (q\ =\ jprev\ ;\ q\ !=\ ancestor\ [q]\ ;\ q\ =\ ancestor\ [q])\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00963}00963\ \ \ \ \ \textcolor{keywordflow}{for}\ (s\ =\ jprev\ ;\ s\ !=\ q\ ;\ s\ =\ sparent)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00964}00964\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00965}00965\ \ \ \ \ \ \ \ \ sparent\ =\ ancestor\ [s]\ ;\ \ \ \ \textcolor{comment}{/*\ path\ compression\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00966}00966\ \ \ \ \ \ \ \ \ ancestor\ [s]\ =\ q\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00967}00967\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00968}00968\ \ \ \ \ \textcolor{keywordflow}{return}\ (q)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ q\ =\ least\ common\ ancester\ (jprev,j)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00969}00969\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00970}00970\ \textcolor{comment}{/*\ load\ a\ triplet\ matrix\ from\ a\ file\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00971}\mbox{\hyperlink{cs_8c_aba9a1be85613f6af3371033f4637080b}{00971}}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *\mbox{\hyperlink{cs_8c_aba9a1be85613f6af3371033f4637080b}{cs\_load}}\ (FILE\ *f)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00972}00972\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00973}00973\ \ \ \ \ \textcolor{keywordtype}{double}\ i,\ j\ ;\ \ \ \textcolor{comment}{/*\ use\ double\ for\ integers\ to\ avoid\ csi\ conflicts\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00974}00974\ \ \ \ \ \textcolor{keywordtype}{double}\ x\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00975}00975\ \ \ \ \ \mbox{\hyperlink{structcs__sparse}{cs}}\ *T\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00976}00976\ \ \ \ \ \textcolor{keywordflow}{if}\ (!f)\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00977}00977\ \ \ \ \ T\ =\ \mbox{\hyperlink{cs_8c_af3ed6e2936760b1b53b79fe3ed5cc8b6}{cs\_spalloc}}\ (0,\ 0,\ 1,\ 1,\ 1)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ allocate\ result\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00978}00978\ \ \ \ \ \textcolor{keywordflow}{while}\ (fscanf\ (f,\ \textcolor{stringliteral}{"{}\%lg\ \%lg\ \%lg\(\backslash\)n"{}},\ \&i,\ \&j,\ \&x)\ ==\ 3)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00979}00979\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00980}00980\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8c_aa0248f7b6f20bf38c85e9a94a0818204}{cs\_entry}}\ (T,\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}})\ i,\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}})\ j,\ x))\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a01a74117bb6004b0b844de5940ddee0a}{cs\_spfree}}\ (T))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00981}00981\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00982}00982\ \ \ \ \ \textcolor{keywordflow}{return}\ (T)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00983}00983\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00984}00984\ \textcolor{comment}{/*\ solve\ Lx=b\ where\ x\ and\ b\ are\ dense.\ \ x=b\ on\ input,\ solution\ on\ output.\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00985}\mbox{\hyperlink{cs_8c_adefe244fe8757d1d7b4de55e0c81561f}{00985}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_adefe244fe8757d1d7b4de55e0c81561f}{cs\_lsolve}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *L,\ \textcolor{keywordtype}{double}\ *x)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00986}00986\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00987}00987\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ p,\ j,\ n,\ *Lp,\ *Li\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00988}00988\ \ \ \ \ \textcolor{keywordtype}{double}\ *Lx\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00989}00989\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (L)\ ||\ !x)\ \textcolor{keywordflow}{return}\ (0)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00990}00990\ \ \ \ \ n\ =\ L-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;\ Lp\ =\ L-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Li\ =\ L-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Lx\ =\ L-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00991}00991\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0\ ;\ j\ <\ n\ ;\ j++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00992}00992\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00993}00993\ \ \ \ \ \ \ \ \ x\ [j]\ /=\ Lx\ [Lp\ [j]]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00994}00994\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Lp\ [j]+1\ ;\ p\ <\ Lp\ [j+1]\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00995}00995\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00996}00996\ \ \ \ \ \ \ \ \ \ \ \ \ x\ [Li\ [p]]\ -\/=\ Lx\ [p]\ *\ x\ [j]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00997}00997\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00998}00998\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l00999}00999\ \ \ \ \ \textcolor{keywordflow}{return}\ (1)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01000}01000\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01001}01001\ \textcolor{comment}{/*\ solve\ L'x=b\ where\ x\ and\ b\ are\ dense.\ \ x=b\ on\ input,\ solution\ on\ output.\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01002}\mbox{\hyperlink{cs_8c_a470ceabef51cc5f2d522587aa9470eb6}{01002}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_a470ceabef51cc5f2d522587aa9470eb6}{cs\_ltsolve}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *L,\ \textcolor{keywordtype}{double}\ *x)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01003}01003\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01004}01004\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ p,\ j,\ n,\ *Lp,\ *Li\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01005}01005\ \ \ \ \ \textcolor{keywordtype}{double}\ *Lx\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01006}01006\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (L)\ ||\ !x)\ \textcolor{keywordflow}{return}\ (0)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01007}01007\ \ \ \ \ n\ =\ L-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;\ Lp\ =\ L-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Li\ =\ L-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Lx\ =\ L-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01008}01008\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ n-\/1\ ;\ j\ >=\ 0\ ;\ j-\/-\/)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01009}01009\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01010}01010\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Lp\ [j]+1\ ;\ p\ <\ Lp\ [j+1]\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01011}01011\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01012}01012\ \ \ \ \ \ \ \ \ \ \ \ \ x\ [j]\ -\/=\ Lx\ [p]\ *\ x\ [Li\ [p]]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01013}01013\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01014}01014\ \ \ \ \ \ \ \ \ x\ [j]\ /=\ Lx\ [Lp\ [j]]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01015}01015\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01016}01016\ \ \ \ \ \textcolor{keywordflow}{return}\ (1)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01017}01017\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01018}01018\ \textcolor{comment}{/*\ [L,U,pinv]=lu(A,\ [q\ lnz\ unz]).\ lnz\ and\ unz\ can\ be\ guess\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01019}\mbox{\hyperlink{cs_8c_ad63cba2834ab7aa01a015a7b0e28eb19}{01019}}\ \mbox{\hyperlink{structcs__numeric}{csn}}\ *\mbox{\hyperlink{cs_8c_ad63cba2834ab7aa01a015a7b0e28eb19}{cs\_lu}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__symbolic}{css}}\ *S,\ \textcolor{keywordtype}{double}\ tol)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01020}01020\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01021}01021\ \ \ \ \ \mbox{\hyperlink{structcs__sparse}{cs}}\ *L,\ *U\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01022}01022\ \ \ \ \ \mbox{\hyperlink{structcs__numeric}{csn}}\ *N\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01023}01023\ \ \ \ \ \textcolor{keywordtype}{double}\ pivot,\ *Lx,\ *Ux,\ *x,\ \ a,\ t\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01024}01024\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *Lp,\ *Li,\ *Up,\ *Ui,\ *pinv,\ *xi,\ *q,\ n,\ ipiv,\ k,\ top,\ p,\ i,\ col,\ lnz,unz;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01025}01025\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A)\ ||\ !S)\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01026}01026\ \ \ \ \ n\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01027}01027\ \ \ \ \ q\ =\ S-\/>\mbox{\hyperlink{structcs__symbolic_a28f8bda67a6e43eac6bac66980f57163}{q}}\ ;\ lnz\ =\ S-\/>\mbox{\hyperlink{structcs__symbolic_a4f723af5f9ae0047f678a82a146d17b0}{lnz}}\ ;\ unz\ =\ S-\/>\mbox{\hyperlink{structcs__symbolic_a75ba99f8c206d85c4936e11053e7f5e3}{unz}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01028}01028\ \ \ \ \ x\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (n,\ \textcolor{keyword}{sizeof}\ (\textcolor{keywordtype}{double}))\ ;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ get\ double\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01029}01029\ \ \ \ \ xi\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (2*n,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ get\ csi\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01030}01030\ \ \ \ \ N\ =\ \mbox{\hyperlink{cs_8c_a071e69dcb222391d3add6c5220a79f51}{cs\_calloc}}\ (1,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{structcs__numeric}{csn}}))\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ allocate\ result\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01031}01031\ \ \ \ \ \textcolor{keywordflow}{if}\ (!x\ ||\ !xi\ ||\ !N)\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a694a09c9515e8fd862bd5270ee35cbc8}{cs\_ndone}}\ (N,\ NULL,\ xi,\ x,\ 0))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01032}01032\ \ \ \ \ N-\/>\mbox{\hyperlink{structcs__numeric_a93a8cf26f01d3df51b41acc690f120d7}{L}}\ =\ L\ =\ \mbox{\hyperlink{cs_8c_af3ed6e2936760b1b53b79fe3ed5cc8b6}{cs\_spalloc}}\ (n,\ n,\ lnz,\ 1,\ 0)\ ;\ \ \ \ \ \ \ \textcolor{comment}{/*\ allocate\ result\ L\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01033}01033\ \ \ \ \ N-\/>\mbox{\hyperlink{structcs__numeric_a1e07204edb10064ca1e471289fced1cb}{U}}\ =\ U\ =\ \mbox{\hyperlink{cs_8c_af3ed6e2936760b1b53b79fe3ed5cc8b6}{cs\_spalloc}}\ (n,\ n,\ unz,\ 1,\ 0)\ ;\ \ \ \ \ \ \ \textcolor{comment}{/*\ allocate\ result\ U\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01034}01034\ \ \ \ \ N-\/>\mbox{\hyperlink{structcs__numeric_a30fd2e151d4170f569260261bb18d955}{pinv}}\ =\ pinv\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (n,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \ \textcolor{comment}{/*\ allocate\ result\ pinv\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01035}01035\ \ \ \ \ \textcolor{keywordflow}{if}\ (!L\ ||\ !U\ ||\ !pinv)\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a694a09c9515e8fd862bd5270ee35cbc8}{cs\_ndone}}\ (N,\ NULL,\ xi,\ x,\ 0))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01036}01036\ \ \ \ \ Lp\ =\ L-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Up\ =\ U-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01037}01037\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0\ ;\ i\ <\ n\ ;\ i++)\ x\ [i]\ =\ 0\ ;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ clear\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01038}01038\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0\ ;\ i\ <\ n\ ;\ i++)\ pinv\ [i]\ =\ -\/1\ ;\ \ \ \ \ \ \ \textcolor{comment}{/*\ no\ rows\ pivotal\ yet\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01039}01039\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <=\ n\ ;\ k++)\ Lp\ [k]\ =\ 0\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ no\ cols\ of\ L\ yet\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01040}01040\ \ \ \ \ lnz\ =\ unz\ =\ 0\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01041}01041\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ n\ ;\ k++)\ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ L(:,k)\ and\ U(:,k)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01042}01042\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01043}01043\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/\ Triangular\ solve\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01044}01044\ \ \ \ \ \ \ \ \ Lp\ [k]\ =\ lnz\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ L(:,k)\ starts\ here\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01045}01045\ \ \ \ \ \ \ \ \ Up\ [k]\ =\ unz\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ U(:,k)\ starts\ here\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01046}01046\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((lnz\ +\ n\ >\ L-\/>\mbox{\hyperlink{structcs__sparse_a4d98fb7ac430adab928f42e45d7c5504}{nzmax}}\ \&\&\ !\mbox{\hyperlink{cs_8c_a4f6f6d0b8acba23772fd254ec794e966}{cs\_sprealloc}}\ (L,\ 2*L-\/>\mbox{\hyperlink{structcs__sparse_a4d98fb7ac430adab928f42e45d7c5504}{nzmax}}\ +\ n))\ ||}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01047}01047\ \ \ \ \ \ \ \ \ \ \ \ \ (unz\ +\ n\ >\ U-\/>\mbox{\hyperlink{structcs__sparse_a4d98fb7ac430adab928f42e45d7c5504}{nzmax}}\ \&\&\ !\mbox{\hyperlink{cs_8c_a4f6f6d0b8acba23772fd254ec794e966}{cs\_sprealloc}}\ (U,\ 2*U-\/>\mbox{\hyperlink{structcs__sparse_a4d98fb7ac430adab928f42e45d7c5504}{nzmax}}\ +\ n)))}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01048}01048\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01049}01049\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a694a09c9515e8fd862bd5270ee35cbc8}{cs\_ndone}}\ (N,\ NULL,\ xi,\ x,\ 0))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01050}01050\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01051}01051\ \ \ \ \ \ \ \ \ Li\ =\ L-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Lx\ =\ L-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;\ Ui\ =\ U-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Ux\ =\ U-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01052}01052\ \ \ \ \ \ \ \ \ col\ =\ q\ ?\ (q\ [k])\ :\ k\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01053}01053\ \ \ \ \ \ \ \ \ top\ =\ \mbox{\hyperlink{cs_8c_a772ba477fdc1f6499735635e037b0c6d}{cs\_spsolve}}\ (L,\ A,\ col,\ xi,\ x,\ pinv,\ 1)\ ;\ \ \textcolor{comment}{/*\ x\ =\ L\(\backslash\)A(:,col)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01054}01054\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/\ Find\ pivot\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01055}01055\ \ \ \ \ \ \ \ \ ipiv\ =\ -\/1\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01056}01056\ \ \ \ \ \ \ \ \ a\ =\ -\/1\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01057}01057\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ top\ ;\ p\ <\ n\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01058}01058\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01059}01059\ \ \ \ \ \ \ \ \ \ \ \ \ i\ =\ xi\ [p]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ x(i)\ is\ nonzero\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01060}01060\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pinv\ [i]\ <\ 0)\ \ \ \ \ \ \ \textcolor{comment}{/*\ row\ i\ is\ not\ yet\ pivotal\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01061}01061\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01062}01062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((t\ =\ fabs\ (x\ [i]))\ >\ a)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01063}01063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01064}01064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a\ =\ t\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ largest\ pivot\ candidate\ so\ far\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01065}01065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ipiv\ =\ i\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01066}01066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01067}01067\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01068}01068\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ x(i)\ is\ the\ entry\ U(pinv[i],k)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01069}01069\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01070}01070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Ui\ [unz]\ =\ pinv\ [i]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01071}01071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Ux\ [unz++]\ =\ x\ [i]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01072}01072\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01073}01073\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01074}01074\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ipiv\ ==\ -\/1\ ||\ a\ <=\ 0)\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a694a09c9515e8fd862bd5270ee35cbc8}{cs\_ndone}}\ (N,\ NULL,\ xi,\ x,\ 0))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01075}01075\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ tol=1\ for\ \ partial\ pivoting;\ tol<1\ gives\ preference\ to\ diagonal\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01076}01076\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pinv\ [col]\ <\ 0\ \&\&\ fabs\ (x\ [col])\ >=\ a*tol)\ ipiv\ =\ col\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01077}01077\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/\ Divide\ by\ pivot\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01078}01078\ \ \ \ \ \ \ \ \ pivot\ =\ x\ [ipiv]\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ the\ chosen\ pivot\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01079}01079\ \ \ \ \ \ \ \ \ Ui\ [unz]\ =\ k\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ last\ entry\ in\ U(:,k)\ is\ U(k,k)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01080}01080\ \ \ \ \ \ \ \ \ Ux\ [unz++]\ =\ pivot\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01081}01081\ \ \ \ \ \ \ \ \ pinv\ [ipiv]\ =\ k\ ;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ ipiv\ is\ the\ kth\ pivot\ row\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01082}01082\ \ \ \ \ \ \ \ \ Li\ [lnz]\ =\ ipiv\ ;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ first\ entry\ in\ L(:,k)\ is\ L(k,k)\ =\ 1\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01083}01083\ \ \ \ \ \ \ \ \ Lx\ [lnz++]\ =\ 1\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01084}01084\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ top\ ;\ p\ <\ n\ ;\ p++)\ \textcolor{comment}{/*\ L(k+1:n,k)\ =\ x\ /\ pivot\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01085}01085\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01086}01086\ \ \ \ \ \ \ \ \ \ \ \ \ i\ =\ xi\ [p]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01087}01087\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pinv\ [i]\ <\ 0)\ \ \ \ \ \ \ \textcolor{comment}{/*\ x(i)\ is\ an\ entry\ in\ L(:,k)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01088}01088\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01089}01089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Li\ [lnz]\ =\ i\ ;\ \ \ \ \ \ \textcolor{comment}{/*\ save\ unpermuted\ row\ in\ L\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01090}01090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Lx\ [lnz++]\ =\ x\ [i]\ /\ pivot\ ;\ \ \ \ \textcolor{comment}{/*\ scale\ pivot\ column\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01091}01091\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01092}01092\ \ \ \ \ \ \ \ \ \ \ \ \ x\ [i]\ =\ 0\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ x\ [0..n-\/1]\ =\ 0\ for\ next\ k\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01093}01093\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01094}01094\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01095}01095\ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/\ Finalize\ L\ and\ U\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01096}01096\ \ \ \ \ Lp\ [n]\ =\ lnz\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01097}01097\ \ \ \ \ Up\ [n]\ =\ unz\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01098}01098\ \ \ \ \ Li\ =\ L-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ fix\ row\ indices\ of\ L\ for\ final\ pinv\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01099}01099\ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ 0\ ;\ p\ <\ lnz\ ;\ p++)\ Li\ [p]\ =\ pinv\ [Li\ [p]]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01100}01100\ \ \ \ \ \mbox{\hyperlink{cs_8c_a4f6f6d0b8acba23772fd254ec794e966}{cs\_sprealloc}}\ (L,\ 0)\ ;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ remove\ extra\ space\ from\ L\ and\ U\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01101}01101\ \ \ \ \ \mbox{\hyperlink{cs_8c_a4f6f6d0b8acba23772fd254ec794e966}{cs\_sprealloc}}\ (U,\ 0)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01102}01102\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a694a09c9515e8fd862bd5270ee35cbc8}{cs\_ndone}}\ (N,\ NULL,\ xi,\ x,\ 1))\ ;\ \ \ \ \ \textcolor{comment}{/*\ success\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01103}01103\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01104}01104\ \textcolor{comment}{/*\ x=A\(\backslash\)b\ where\ A\ is\ unsymmetric;\ b\ overwritten\ with\ solution\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01105}\mbox{\hyperlink{cs_8c_a99ff84a3be540f3237c33a873064e1e5}{01105}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_a99ff84a3be540f3237c33a873064e1e5}{cs\_lusol}}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ order,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \textcolor{keywordtype}{double}\ *b,\ \textcolor{keywordtype}{double}\ tol)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01106}01106\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01107}01107\ \ \ \ \ \textcolor{keywordtype}{double}\ *x\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01108}01108\ \ \ \ \ \mbox{\hyperlink{structcs__symbolic}{css}}\ *S\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01109}01109\ \ \ \ \ \mbox{\hyperlink{structcs__numeric}{csn}}\ *N\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01110}01110\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ n,\ ok\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01111}01111\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A)\ ||\ !b)\ \textcolor{keywordflow}{return}\ (0)\ ;\ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01112}01112\ \ \ \ \ n\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01113}01113\ \ \ \ \ S\ =\ \mbox{\hyperlink{cs_8c_a7cb77fc595740853b9d5f49df6d5f64c}{cs\_sqr}}\ (order,\ A,\ 0)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ ordering\ and\ symbolic\ analysis\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01114}01114\ \ \ \ \ N\ =\ \mbox{\hyperlink{cs_8c_ad63cba2834ab7aa01a015a7b0e28eb19}{cs\_lu}}\ (A,\ S,\ tol)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ numeric\ LU\ factorization\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01115}01115\ \ \ \ \ x\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (n,\ \textcolor{keyword}{sizeof}\ (\textcolor{keywordtype}{double}))\ ;\ \ \ \ \textcolor{comment}{/*\ get\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01116}01116\ \ \ \ \ ok\ =\ (S\ \&\&\ N\ \&\&\ x)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01117}01117\ \ \ \ \ \textcolor{keywordflow}{if}\ (ok)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01118}01118\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01119}01119\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8c_a0938ec08825dc07a2dab8f9477ab053b}{cs\_ipvec}}\ (N-\/>\mbox{\hyperlink{structcs__numeric_a30fd2e151d4170f569260261bb18d955}{pinv}},\ b,\ x,\ n)\ ;\ \ \ \ \ \ \ \textcolor{comment}{/*\ x\ =\ b(p)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01120}01120\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8c_adefe244fe8757d1d7b4de55e0c81561f}{cs\_lsolve}}\ (N-\/>\mbox{\hyperlink{structcs__numeric_a93a8cf26f01d3df51b41acc690f120d7}{L}},\ x)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ x\ =\ L\(\backslash\)x\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01121}01121\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8c_aace9cc447db7e3e293431a31f6965730}{cs\_usolve}}\ (N-\/>\mbox{\hyperlink{structcs__numeric_a1e07204edb10064ca1e471289fced1cb}{U}},\ x)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ x\ =\ U\(\backslash\)x\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01122}01122\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8c_a0938ec08825dc07a2dab8f9477ab053b}{cs\_ipvec}}\ (S-\/>\mbox{\hyperlink{structcs__symbolic_a28f8bda67a6e43eac6bac66980f57163}{q}},\ x,\ b,\ n)\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ b(q)\ =\ x\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01123}01123\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01124}01124\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (x)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01125}01125\ \ \ \ \ \mbox{\hyperlink{cs_8c_a2eebf0dae1d9ee505a016630e4fa5748}{cs\_sfree}}\ (S)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01126}01126\ \ \ \ \ \mbox{\hyperlink{cs_8c_adabc8e810cec49307537b5e3368d53aa}{cs\_nfree}}\ (N)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01127}01127\ \ \ \ \ \textcolor{keywordflow}{return}\ (ok)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01128}01128\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01129}01129\ \textcolor{preprocessor}{\#ifdef\ MATLAB\_MEX\_FILE}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01130}01130\ \textcolor{preprocessor}{\#define\ malloc\ mxMalloc}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01131}01131\ \textcolor{preprocessor}{\#define\ free\ mxFree}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01132}01132\ \textcolor{preprocessor}{\#define\ realloc\ mxRealloc}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01133}01133\ \textcolor{preprocessor}{\#define\ calloc\ mxCalloc}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01134}01134\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01135}01135\ }
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01136}01136\ \textcolor{comment}{/*\ wrapper\ for\ malloc\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01137}\mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{01137}}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ n,\ \textcolor{keywordtype}{size\_t}\ size)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01138}01138\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01139}01139\ \ \ \ \ \textcolor{keywordflow}{return}\ (malloc\ (\mbox{\hyperlink{cs_8h_a7447e0bed6bf453743551d158e019e8b}{CS\_MAX}}\ (n,1)\ *\ size))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01140}01140\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01141}01141\ }
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01142}01142\ \textcolor{comment}{/*\ wrapper\ for\ calloc\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01143}\mbox{\hyperlink{cs_8c_a071e69dcb222391d3add6c5220a79f51}{01143}}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{cs_8c_a071e69dcb222391d3add6c5220a79f51}{cs\_calloc}}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ n,\ \textcolor{keywordtype}{size\_t}\ size)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01144}01144\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01145}01145\ \ \ \ \ \textcolor{keywordflow}{return}\ (calloc\ (\mbox{\hyperlink{cs_8h_a7447e0bed6bf453743551d158e019e8b}{CS\_MAX}}\ (n,1),\ size))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01146}01146\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01147}01147\ }
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01148}01148\ \textcolor{comment}{/*\ wrapper\ for\ free\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01149}\mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{01149}}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (\textcolor{keywordtype}{void}\ *p)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01150}01150\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01151}01151\ \ \ \ \ \textcolor{keywordflow}{if}\ (p)\ free\ (p)\ ;\ \ \ \ \ \ \ \textcolor{comment}{/*\ free\ p\ if\ it\ is\ not\ already\ NULL\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01152}01152\ \ \ \ \ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ return\ NULL\ to\ simplify\ the\ use\ of\ cs\_free\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01153}01153\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01154}01154\ }
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01155}01155\ \textcolor{comment}{/*\ wrapper\ for\ realloc\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01156}\mbox{\hyperlink{cs_8c_a6e24151b1b4d6711299022113e3c26d6}{01156}}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{cs_8c_a6e24151b1b4d6711299022113e3c26d6}{cs\_realloc}}\ (\textcolor{keywordtype}{void}\ *p,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ n,\ \textcolor{keywordtype}{size\_t}\ size,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *ok)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01157}01157\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01158}01158\ \ \ \ \ \textcolor{keywordtype}{void}\ *pnew\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01159}01159\ \ \ \ \ pnew\ =\ realloc\ (p,\ \mbox{\hyperlink{cs_8h_a7447e0bed6bf453743551d158e019e8b}{CS\_MAX}}\ (n,1)\ *\ size)\ ;\ \textcolor{comment}{/*\ realloc\ the\ block\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01160}01160\ \ \ \ \ *ok\ =\ (pnew\ !=\ NULL)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ realloc\ fails\ if\ pnew\ is\ NULL\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01161}01161\ \ \ \ \ \textcolor{keywordflow}{return}\ ((*ok)\ ?\ pnew\ :\ p)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ return\ original\ p\ if\ failure\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01162}01162\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01163}01163\ \textcolor{comment}{/*\ find\ an\ augmenting\ path\ starting\ at\ column\ k\ and\ extend\ the\ match\ if\ found\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01164}\mbox{\hyperlink{cs_8c_a695e01b48f33a26673a4f6378c71d086}{01164}}\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{cs_8c_a695e01b48f33a26673a4f6378c71d086}{cs\_augment}}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ k,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *jmatch,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *cheap,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *w,}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01165}01165\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *js,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *is,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *ps)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01166}01166\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01167}01167\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ found\ =\ 0,\ p,\ i\ =\ -\/1,\ *Ap\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}},\ *Ai\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}},\ head\ =\ 0,\ j\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01168}01168\ \ \ \ \ js\ [0]\ =\ k\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ start\ with\ just\ node\ k\ in\ jstack\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01169}01169\ \ \ \ \ \textcolor{keywordflow}{while}\ (head\ >=\ 0)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01170}01170\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01171}01171\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/\ Start\ (or\ continue)\ depth-\/first-\/search\ at\ node\ j\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01172}01172\ \ \ \ \ \ \ \ \ j\ =\ js\ [head]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ get\ j\ from\ top\ of\ jstack\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01173}01173\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (w\ [j]\ !=\ k)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ 1st\ time\ j\ visited\ for\ kth\ path\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01174}01174\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01175}01175\ \ \ \ \ \ \ \ \ \ \ \ \ w\ [j]\ =\ k\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ mark\ j\ as\ visited\ for\ kth\ path\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01176}01176\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ cheap\ [j]\ ;\ p\ <\ Ap\ [j+1]\ \&\&\ !found\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01177}01177\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01178}01178\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ i\ =\ Ai\ [p]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ try\ a\ cheap\ assignment\ (i,j)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01179}01179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ found\ =\ (jmatch\ [i]\ ==\ -\/1)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01180}01180\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01181}01181\ \ \ \ \ \ \ \ \ \ \ \ \ cheap\ [j]\ =\ p\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ start\ here\ next\ time\ j\ is\ traversed*/}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01182}01182\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (found)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01183}01183\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01184}01184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ is\ [head]\ =\ i\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ column\ j\ matched\ with\ row\ i\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01185}01185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ break\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ end\ of\ augmenting\ path\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01186}01186\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01187}01187\ \ \ \ \ \ \ \ \ \ \ \ \ ps\ [head]\ =\ Ap\ [j]\ ;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ no\ cheap\ match:\ start\ dfs\ for\ j\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01188}01188\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01189}01189\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ -\/-\/-\/\ Depth-\/first-\/search\ of\ neighbors\ of\ j\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01190}01190\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ ps\ [head]\ ;\ p\ <\ Ap\ [j+1]\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01191}01191\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01192}01192\ \ \ \ \ \ \ \ \ \ \ \ \ i\ =\ Ai\ [p]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ consider\ row\ i\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01193}01193\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (w\ [jmatch\ [i]]\ ==\ k)\ continue\ ;\ \textcolor{comment}{/*\ skip\ jmatch\ [i]\ if\ marked\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01194}01194\ \ \ \ \ \ \ \ \ \ \ \ \ ps\ [head]\ =\ p\ +\ 1\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ pause\ dfs\ of\ node\ j\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01195}01195\ \ \ \ \ \ \ \ \ \ \ \ \ is\ [head]\ =\ i\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ i\ will\ be\ matched\ with\ j\ if\ found\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01196}01196\ \ \ \ \ \ \ \ \ \ \ \ \ js\ [++head]\ =\ jmatch\ [i]\ ;\ \ \textcolor{comment}{/*\ start\ dfs\ at\ column\ jmatch\ [i]\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01197}01197\ \ \ \ \ \ \ \ \ \ \ \ \ break\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01198}01198\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01199}01199\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p\ ==\ Ap\ [j+1])\ head-\/-\/\ ;\ \ \ \ \ \textcolor{comment}{/*\ node\ j\ is\ done;\ pop\ from\ stack\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01200}01200\ \ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ augment\ the\ match\ if\ path\ found:\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01201}01201\ \ \ \ \ \textcolor{keywordflow}{if}\ (found)\ \textcolor{keywordflow}{for}\ (p\ =\ head\ ;\ p\ >=\ 0\ ;\ p-\/-\/)\ jmatch\ [is\ [p]]\ =\ js\ [p]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01202}01202\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01203}01203\ }
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01204}01204\ \textcolor{comment}{/*\ find\ a\ maximum\ transveral\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01205}\mbox{\hyperlink{cs_8c_ae11aacb8a4488eb14972d4ac490036ca}{01205}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *\mbox{\hyperlink{cs_8c_ae11aacb8a4488eb14972d4ac490036ca}{cs\_maxtrans}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ seed)\ \ \textcolor{comment}{/*[jmatch\ [0..m-\/1];\ imatch\ [0..n-\/1]]*/}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01206}01206\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01207}01207\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ i,\ j,\ k,\ n,\ m,\ p,\ n2\ =\ 0,\ m2\ =\ 0,\ *Ap,\ *jimatch,\ *w,\ *cheap,\ *js,\ *is,}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01208}01208\ \ \ \ \ \ \ \ \ *ps,\ *Ai,\ *Cp,\ *jmatch,\ *imatch,\ *q\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01209}01209\ \ \ \ \ \mbox{\hyperlink{structcs__sparse}{cs}}\ *C\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01210}01210\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A))\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01211}01211\ \ \ \ \ n\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;\ m\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a8dab81f7d781bd65c7cb4f103db87ade}{m}}\ ;\ Ap\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Ai\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01212}01212\ \ \ \ \ w\ =\ jimatch\ =\ \mbox{\hyperlink{cs_8c_a071e69dcb222391d3add6c5220a79f51}{cs\_calloc}}\ (m+n,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \ \ \textcolor{comment}{/*\ allocate\ result\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01213}01213\ \ \ \ \ \textcolor{keywordflow}{if}\ (!jimatch)\ \textcolor{keywordflow}{return}\ (NULL)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01214}01214\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0,\ j\ =\ 0\ ;\ j\ <\ n\ ;\ j++)\ \ \ \ \textcolor{comment}{/*\ count\ nonempty\ rows\ and\ columns\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01215}01215\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01216}01216\ \ \ \ \ \ \ \ \ n2\ +=\ (Ap\ [j]\ <\ Ap\ [j+1])\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01217}01217\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Ap\ [j]\ ;\ p\ <\ Ap\ [j+1]\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01218}01218\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01219}01219\ \ \ \ \ \ \ \ \ \ \ \ \ w\ [Ai\ [p]]\ =\ 1\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01220}01220\ \ \ \ \ \ \ \ \ \ \ \ \ k\ +=\ (j\ ==\ Ai\ [p])\ ;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ count\ entries\ already\ on\ diagonal\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01221}01221\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01222}01222\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01223}01223\ \ \ \ \ \textcolor{keywordflow}{if}\ (k\ ==\ \mbox{\hyperlink{cs_8h_a2635aa5c35f05bb0e4c88be5aabae949}{CS\_MIN}}\ (m,n))\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ quick\ return\ if\ diagonal\ zero-\/free\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01224}01224\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01225}01225\ \ \ \ \ \ \ \ \ jmatch\ =\ jimatch\ ;\ imatch\ =\ jimatch\ +\ m\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01226}01226\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0\ ;\ i\ <\ k\ ;\ i++)\ jmatch\ [i]\ =\ i\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01227}01227\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\ \ \ \ \ \ ;\ i\ <\ m\ ;\ i++)\ jmatch\ [i]\ =\ -\/1\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01228}01228\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0\ ;\ j\ <\ k\ ;\ j++)\ imatch\ [j]\ =\ j\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01229}01229\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\ \ \ \ \ \ ;\ j\ <\ n\ ;\ j++)\ imatch\ [j]\ =\ -\/1\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01230}01230\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a5f172de9436558173ef0b873d9e1a5db}{cs\_idone}}\ (jimatch,\ NULL,\ NULL,\ 1))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01231}01231\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01232}01232\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0\ ;\ i\ <\ m\ ;\ i++)\ m2\ +=\ w\ [i]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01233}01233\ \ \ \ \ C\ =\ (m2\ <\ n2)\ ?\ \mbox{\hyperlink{cs_8c_a838dfaabdae54c408a4a696dfffa3dea}{cs\_transpose}}\ (A,0)\ :\ ((\mbox{\hyperlink{structcs__sparse}{cs}}\ *)\ A)\ ;\ \textcolor{comment}{/*\ transpose\ if\ needed\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01234}01234\ \ \ \ \ \textcolor{keywordflow}{if}\ (!C)\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a5f172de9436558173ef0b873d9e1a5db}{cs\_idone}}\ (jimatch,\ (m2\ <\ n2)\ ?\ C\ :\ NULL,\ NULL,\ 0))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01235}01235\ \ \ \ \ n\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;\ m\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a8dab81f7d781bd65c7cb4f103db87ade}{m}}\ ;\ Cp\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01236}01236\ \ \ \ \ jmatch\ =\ (m2\ <\ n2)\ ?\ jimatch\ +\ n\ :\ jimatch\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01237}01237\ \ \ \ \ imatch\ =\ (m2\ <\ n2)\ ?\ jimatch\ :\ jimatch\ +\ m\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01238}01238\ \ \ \ \ w\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (5*n,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ get\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01239}01239\ \ \ \ \ \textcolor{keywordflow}{if}\ (!w)\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a5f172de9436558173ef0b873d9e1a5db}{cs\_idone}}\ (jimatch,\ (m2\ <\ n2)\ ?\ C\ :\ NULL,\ w,\ 0))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01240}01240\ \ \ \ \ cheap\ =\ w\ +\ n\ ;\ js\ =\ w\ +\ 2*n\ ;\ is\ =\ w\ +\ 3*n\ ;\ ps\ =\ w\ +\ 4*n\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01241}01241\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0\ ;\ j\ <\ n\ ;\ j++)\ cheap\ [j]\ =\ Cp\ [j]\ ;\ \ \textcolor{comment}{/*\ for\ cheap\ assignment\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01242}01242\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0\ ;\ j\ <\ n\ ;\ j++)\ w\ [j]\ =\ -\/1\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ all\ columns\ unflagged\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01243}01243\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0\ ;\ i\ <\ m\ ;\ i++)\ jmatch\ [i]\ =\ -\/1\ ;\ \ \ \ \ \textcolor{comment}{/*\ nothing\ matched\ yet\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01244}01244\ \ \ \ \ q\ =\ \mbox{\hyperlink{cs_8c_aa4e3a12345c15d293c72cdb54c1bcdda}{cs\_randperm}}\ (n,\ seed)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ q\ =\ random\ permutation\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01245}01245\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ n\ ;\ k++)\ \ \ \textcolor{comment}{/*\ augment,\ starting\ at\ column\ q[k]\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01246}01246\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01247}01247\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8c_a695e01b48f33a26673a4f6378c71d086}{cs\_augment}}\ (q\ ?\ q\ [k]:\ k,\ C,\ jmatch,\ cheap,\ w,\ js,\ is,\ ps)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01248}01248\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01249}01249\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (q)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01250}01250\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0\ ;\ j\ <\ n\ ;\ j++)\ imatch\ [j]\ =\ -\/1\ ;\ \ \ \ \ \textcolor{comment}{/*\ find\ row\ match\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01251}01251\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0\ ;\ i\ <\ m\ ;\ i++)\ \textcolor{keywordflow}{if}\ (jmatch\ [i]\ >=\ 0)\ imatch\ [jmatch\ [i]]\ =\ i\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01252}01252\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a5f172de9436558173ef0b873d9e1a5db}{cs\_idone}}\ (jimatch,\ (m2\ <\ n2)\ ?\ C\ :\ NULL,\ w,\ 1))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01253}01253\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01254}01254\ }
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01255}01255\ \textcolor{preprocessor}{\#if\ csi\ ==\ int}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01256}\mbox{\hyperlink{cs_8c_a59e0ee11ebb5d5c831813a526c1cc0a5}{01256}}\ \textcolor{preprocessor}{\#\ define\ csi\_MAX\ INT\_MAX}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01257}01257\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01258}01258\ \textcolor{preprocessor}{\#\ error\ "{}Need\ INT\_MAX\ analogue\ of\ \ csi\ type"{}}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01259}01259\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01260}01260\ }
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01261}01261\ \textcolor{comment}{/*\ C\ =\ A*B\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01262}\mbox{\hyperlink{cs_8c_aa8d8dd148fab9e0a7811962c18d3ce61}{01262}}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *\mbox{\hyperlink{cs_8c_aa8d8dd148fab9e0a7811962c18d3ce61}{cs\_multiply}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *B)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01263}01263\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01264}01264\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ p,\ j,\ nz\ =\ 0,\ anz,\ *Cp,\ *Ci,\ *Bp,\ m,\ n,\ bnz,\ *w,\ values,\ *Bi\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01265}01265\ \ \ \ \ \textcolor{keywordtype}{double}\ *x,\ *Bx,\ *Cx\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01266}01266\ \ \ \ \ \mbox{\hyperlink{structcs__sparse}{cs}}\ *C\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01267}01267\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A)\ ||\ !\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (B))\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01268}01268\ \ \ \ \ \textcolor{keywordflow}{if}\ (A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ !=\ B-\/>\mbox{\hyperlink{structcs__sparse_a8dab81f7d781bd65c7cb4f103db87ade}{m}})\ \textcolor{keywordflow}{return}\ (NULL)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01269}01269\ \ \ \ \ m\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a8dab81f7d781bd65c7cb4f103db87ade}{m}}\ ;\ anz\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ [A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01270}01270\ \ \ \ \ n\ =\ B-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;\ Bp\ =\ B-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Bi\ =\ B-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Bx\ =\ B-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;\ bnz\ =\ Bp\ [n]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01271}01271\ \ \ \ \ w\ =\ \mbox{\hyperlink{cs_8c_a071e69dcb222391d3add6c5220a79f51}{cs\_calloc}}\ (m,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ get\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01272}01272\ \ \ \ \ values\ =\ (A-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ !=\ NULL)\ \&\&\ (Bx\ !=\ NULL)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01273}01273\ \ \ \ \ x\ =\ values\ ?\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (m,\ \textcolor{keyword}{sizeof}\ (\textcolor{keywordtype}{double}))\ :\ NULL\ ;\ \textcolor{comment}{/*\ get\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01274}01274\ \ \ \ \ C\ =\ \mbox{\hyperlink{cs_8c_af3ed6e2936760b1b53b79fe3ed5cc8b6}{cs\_spalloc}}\ (m,\ n,\ anz\ +\ bnz,\ values,\ 0)\ ;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ allocate\ result\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01275}01275\ \ \ \ \ \textcolor{keywordflow}{if}\ (!C\ ||\ !w\ ||\ (values\ \&\&\ !x))\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_afa27f1bfd7e5be4f160c24b0828d9178}{cs\_done}}\ (C,\ w,\ x,\ 0))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01276}01276\ \ \ \ \ Cp\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01277}01277\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0\ ;\ j\ <\ n\ ;\ j++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01278}01278\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01279}01279\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (C-\/>\mbox{\hyperlink{structcs__sparse_a4d98fb7ac430adab928f42e45d7c5504}{nzmax}}\ >\ (\mbox{\hyperlink{cs_8c_a59e0ee11ebb5d5c831813a526c1cc0a5}{csi\_MAX}}\ -\/\ m)/2\ ||\ \textcolor{comment}{//\ 2*C-\/>nzmax\ +\ m\ \ overflows}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01280}01280\ \ \ \ \ \ \ \ \ \ \ \ \ (nz\ +\ m\ >\ C-\/>\mbox{\hyperlink{structcs__sparse_a4d98fb7ac430adab928f42e45d7c5504}{nzmax}}\ \&\&\ !\mbox{\hyperlink{cs_8c_a4f6f6d0b8acba23772fd254ec794e966}{cs\_sprealloc}}\ (C,\ 2*(C-\/>\mbox{\hyperlink{structcs__sparse_a4d98fb7ac430adab928f42e45d7c5504}{nzmax}})+m)))}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01281}01281\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01282}01282\ \ \ \ \ \ \ \ \ \ \ \ \ warning(\textcolor{stringliteral}{"{}Too\ many\ non-\/zeros\ in\ sparse\ product:\ Out\ of\ memory"{}});}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01283}01283\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_afa27f1bfd7e5be4f160c24b0828d9178}{cs\_done}}\ (C,\ w,\ x,\ 0))\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ out\ of\ memory\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01284}01284\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01285}01285\ \ \ \ \ \ \ \ \ Ci\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Cx\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ C-\/>i\ and\ C-\/>x\ may\ be\ reallocated\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01286}01286\ \ \ \ \ \ \ \ \ Cp\ [j]\ =\ nz\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ column\ j\ of\ C\ starts\ here\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01287}01287\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Bp\ [j]\ ;\ p\ <\ Bp\ [j+1]\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01288}01288\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01289}01289\ \ \ \ \ \ \ \ \ \ \ \ \ nz\ =\ \mbox{\hyperlink{cs_8c_a324e7bf547ed0b969275da4410563e6e}{cs\_scatter}}\ (A,\ Bi\ [p],\ Bx\ ?\ Bx\ [p]\ :\ 1,\ w,\ x,\ j+1,\ C,\ nz)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01290}01290\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01291}01291\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (values)\ \textcolor{keywordflow}{for}\ (p\ =\ Cp\ [j]\ ;\ p\ <\ nz\ ;\ p++)\ Cx\ [p]\ =\ x\ [Ci\ [p]]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01292}01292\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01293}01293\ \ \ \ \ Cp\ [n]\ =\ nz\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ finalize\ the\ last\ column\ of\ C\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01294}01294\ \ \ \ \ \mbox{\hyperlink{cs_8c_a4f6f6d0b8acba23772fd254ec794e966}{cs\_sprealloc}}\ (C,\ 0)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ remove\ extra\ space\ from\ C\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01295}01295\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_afa27f1bfd7e5be4f160c24b0828d9178}{cs\_done}}\ (C,\ w,\ x,\ 1))\ ;\ \ \ \ \ \textcolor{comment}{/*\ success;\ free\ workspace,\ return\ C\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01296}01296\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01297}01297\ \textcolor{comment}{/*\ 1-\/norm\ of\ a\ sparse\ matrix\ =\ max\ (sum\ (abs\ (A))),\ largest\ column\ sum\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01298}\mbox{\hyperlink{cs_8c_ae2b324f8f0cdc3610d98ce6cebd50075}{01298}}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{cs_8c_ae2b324f8f0cdc3610d98ce6cebd50075}{cs\_norm}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01299}01299\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01300}01300\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ p,\ j,\ n,\ *Ap\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01301}01301\ \ \ \ \ \textcolor{keywordtype}{double}\ *Ax,\ \ norm\ =\ 0,\ s\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01302}01302\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A)\ ||\ !A-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}})\ \textcolor{keywordflow}{return}\ (-\/1)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01303}01303\ \ \ \ \ n\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;\ Ap\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Ax\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01304}01304\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0\ ;\ j\ <\ n\ ;\ j++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01305}01305\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01306}01306\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (s\ =\ 0,\ p\ =\ Ap\ [j]\ ;\ p\ <\ Ap\ [j+1]\ ;\ p++)\ s\ +=\ fabs\ (Ax\ [p])\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01307}01307\ \ \ \ \ \ \ \ \ norm\ =\ \mbox{\hyperlink{cs_8h_a7447e0bed6bf453743551d158e019e8b}{CS\_MAX}}\ (norm,\ s)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01308}01308\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01309}01309\ \ \ \ \ \textcolor{keywordflow}{return}\ (norm)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01310}01310\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01311}01311\ \textcolor{comment}{/*\ C\ =\ A(p,q)\ where\ p\ and\ q\ are\ permutations\ of\ 0..m-\/1\ and\ 0..n-\/1.\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01312}\mbox{\hyperlink{cs_8c_aa09de703c0e946fe0d8a61dacbd78aa4}{01312}}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *\mbox{\hyperlink{cs_8c_aa09de703c0e946fe0d8a61dacbd78aa4}{cs\_permute}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *pinv,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *q,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ values)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01313}01313\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01314}01314\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ t,\ j,\ k,\ nz\ =\ 0,\ m,\ n,\ *Ap,\ *Ai,\ *Cp,\ *Ci\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01315}01315\ \ \ \ \ \textcolor{keywordtype}{double}\ *Cx,\ *Ax\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01316}01316\ \ \ \ \ \mbox{\hyperlink{structcs__sparse}{cs}}\ *C\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01317}01317\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A))\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01318}01318\ \ \ \ \ m\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a8dab81f7d781bd65c7cb4f103db87ade}{m}}\ ;\ n\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;\ Ap\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Ai\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Ax\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01319}01319\ \ \ \ \ C\ =\ \mbox{\hyperlink{cs_8c_af3ed6e2936760b1b53b79fe3ed5cc8b6}{cs\_spalloc}}\ (m,\ n,\ Ap\ [n],\ values\ \&\&\ Ax\ !=\ NULL,\ 0)\ ;\ \ \textcolor{comment}{/*\ alloc\ result\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01320}01320\ \ \ \ \ \textcolor{keywordflow}{if}\ (!C)\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_afa27f1bfd7e5be4f160c24b0828d9178}{cs\_done}}\ (C,\ NULL,\ NULL,\ 0))\ ;\ \ \ \textcolor{comment}{/*\ out\ of\ memory\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01321}01321\ \ \ \ \ Cp\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Ci\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Cx\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01322}01322\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ n\ ;\ k++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01323}01323\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01324}01324\ \ \ \ \ \ \ \ \ Cp\ [k]\ =\ nz\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ column\ k\ of\ C\ is\ column\ q[k]\ of\ A\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01325}01325\ \ \ \ \ \ \ \ \ j\ =\ q\ ?\ (q\ [k])\ :\ k\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01326}01326\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (t\ =\ Ap\ [j]\ ;\ t\ <\ Ap\ [j+1]\ ;\ t++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01327}01327\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01328}01328\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (Cx)\ Cx\ [nz]\ =\ Ax\ [t]\ ;\ \ \textcolor{comment}{/*\ row\ i\ of\ A\ is\ row\ pinv[i]\ of\ C\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01329}01329\ \ \ \ \ \ \ \ \ \ \ \ \ Ci\ [nz++]\ =\ pinv\ ?\ (pinv\ [Ai\ [t]])\ :\ Ai\ [t]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01330}01330\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01331}01331\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01332}01332\ \ \ \ \ Cp\ [n]\ =\ nz\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ finalize\ the\ last\ column\ of\ C\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01333}01333\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_afa27f1bfd7e5be4f160c24b0828d9178}{cs\_done}}\ (C,\ NULL,\ NULL,\ 1))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01334}01334\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01335}01335\ \textcolor{comment}{/*\ pinv\ =\ p',\ or\ p\ =\ pinv'\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01336}\mbox{\hyperlink{cs_8c_ae8aefba6d94d832505cc7ed4b0d78548}{01336}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *\mbox{\hyperlink{cs_8c_ae8aefba6d94d832505cc7ed4b0d78548}{cs\_pinv}}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \textcolor{keyword}{const}\ *p,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ n)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01337}01337\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01338}01338\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ k,\ *pinv\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01339}01339\ \ \ \ \ \textcolor{keywordflow}{if}\ (!p)\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ p\ =\ NULL\ denotes\ identity\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01340}01340\ \ \ \ \ pinv\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (n,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ allocate\ result\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01341}01341\ \ \ \ \ \textcolor{keywordflow}{if}\ (!pinv)\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ out\ of\ memory\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01342}01342\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ n\ ;\ k++)\ pinv\ [p\ [k]]\ =\ k\ ;\textcolor{comment}{/*\ invert\ the\ permutation\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01343}01343\ \ \ \ \ \textcolor{keywordflow}{return}\ (pinv)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ return\ result\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01344}01344\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01345}01345\ \textcolor{comment}{/*\ post\ order\ a\ forest\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01346}\mbox{\hyperlink{cs_8c_ae8e3fc0a5f911aa66a95391b1be0c780}{01346}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *\mbox{\hyperlink{cs_8c_ae8e3fc0a5f911aa66a95391b1be0c780}{cs\_post}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *parent,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ n)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01347}01347\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01348}01348\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ j,\ k\ =\ 0,\ *post,\ *w,\ *head,\ *next,\ *stack\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01349}01349\ \ \ \ \ \textcolor{keywordflow}{if}\ (!parent)\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01350}01350\ \ \ \ \ post\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (n,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ allocate\ result\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01351}01351\ \ \ \ \ w\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (3*n,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ get\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01352}01352\ \ \ \ \ \textcolor{keywordflow}{if}\ (!w\ ||\ !post)\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a5f172de9436558173ef0b873d9e1a5db}{cs\_idone}}\ (post,\ NULL,\ w,\ 0))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01353}01353\ \ \ \ \ head\ =\ w\ ;\ next\ =\ w\ +\ n\ ;\ stack\ =\ w\ +\ 2*n\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01354}01354\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0\ ;\ j\ <\ n\ ;\ j++)\ head\ [j]\ =\ -\/1\ ;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ empty\ linked\ lists\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01355}01355\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ n-\/1\ ;\ j\ >=\ 0\ ;\ j-\/-\/)\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ traverse\ nodes\ in\ reverse\ order*/}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01356}01356\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01357}01357\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (parent\ [j]\ ==\ -\/1)\ continue\ ;\ \ \ \ \textcolor{comment}{/*\ j\ is\ a\ root\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01358}01358\ \ \ \ \ \ \ \ \ next\ [j]\ =\ head\ [parent\ [j]]\ ;\ \ \ \ \ \ \textcolor{comment}{/*\ add\ j\ to\ list\ of\ its\ parent\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01359}01359\ \ \ \ \ \ \ \ \ head\ [parent\ [j]]\ =\ j\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01360}01360\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01361}01361\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0\ ;\ j\ <\ n\ ;\ j++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01362}01362\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01363}01363\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (parent\ [j]\ !=\ -\/1)\ continue\ ;\ \ \ \ \textcolor{comment}{/*\ skip\ j\ if\ it\ is\ not\ a\ root\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01364}01364\ \ \ \ \ \ \ \ \ k\ =\ \mbox{\hyperlink{cs_8c_a763cce1cc37a21b58c8493c6c28e4afe}{cs\_tdfs}}\ (j,\ k,\ head,\ next,\ post,\ stack)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01365}01365\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01366}01366\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a5f172de9436558173ef0b873d9e1a5db}{cs\_idone}}\ (post,\ NULL,\ w,\ 1))\ ;\ \ \textcolor{comment}{/*\ success;\ free\ w,\ return\ post\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01367}01367\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01368}01368\ \textcolor{comment}{/*\ print\ a\ sparse\ matrix;\ use\ \%g\ for\ integers\ to\ avoid\ differences\ with\ csi\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01369}\mbox{\hyperlink{cs_8c_aa06a225248a91eccbcef3e81a382d405}{01369}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_aa06a225248a91eccbcef3e81a382d405}{cs\_print}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ brief)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01370}01370\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01371}01371\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ p,\ j,\ m,\ n,\ nzmax,\ nz,\ *Ap,\ *Ai\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01372}01372\ \ \ \ \ \textcolor{keywordtype}{double}\ *Ax\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01373}01373\ \ \ \ \ \textcolor{keywordflow}{if}\ (!A)\ \{\ \mbox{\hyperlink{cs_8h_a3cb9f0894fab1c8fbb0753c9c7c2a8d9}{printf}}\ (\textcolor{stringliteral}{"{}(null)\(\backslash\)n"{}})\ ;\ \textcolor{keywordflow}{return}\ (0)\ ;\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01374}01374\ \ \ \ \ m\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a8dab81f7d781bd65c7cb4f103db87ade}{m}}\ ;\ n\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;\ Ap\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Ai\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Ax\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01375}01375\ \ \ \ \ nzmax\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a4d98fb7ac430adab928f42e45d7c5504}{nzmax}}\ ;\ nz\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a8eb7205d5e8fbb0c08a80e9fd52d2963}{nz}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01376}01376\ \ \ \ \ \mbox{\hyperlink{cs_8h_a3cb9f0894fab1c8fbb0753c9c7c2a8d9}{printf}}\ (\textcolor{stringliteral}{"{}CSparse\ Version\ \%d.\%d.\%d,\ \%s.\ \ \%s\(\backslash\)n"{}},\ \mbox{\hyperlink{cs_8h_a4371903ff8b39a742cfaf6c6d7f60c4b}{CS\_VER}},\ \mbox{\hyperlink{cs_8h_ac86012ab063a9b8248eaac8bec3b648b}{CS\_SUBVER}},}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01377}01377\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8h_a7f63c57bd63a43fe7ca98e82f524f2ea}{CS\_SUBSUB}},\ \mbox{\hyperlink{cs_8h_a368a611d92ef4a9df9b95cfad8dccf80}{CS\_DATE}},\ \mbox{\hyperlink{cs_8h_ae6b1a40644b8ddacbbc3bd7c255dbbb4}{CS\_COPYRIGHT}})\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01378}01378\ \ \ \ \ \textcolor{keywordflow}{if}\ (nz\ <\ 0)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01379}01379\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01380}01380\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8h_a3cb9f0894fab1c8fbb0753c9c7c2a8d9}{printf}}\ (\textcolor{stringliteral}{"{}\%g-\/by-\/\%g,\ nzmax:\ \%g\ nnz:\ \%g,\ 1-\/norm:\ \%g\(\backslash\)n"{}},\ (\textcolor{keywordtype}{double})\ m,}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01381}01381\ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{double})\ n,\ (\textcolor{keywordtype}{double})\ nzmax,\ (\textcolor{keywordtype}{double})\ (Ap\ [n]),\ \mbox{\hyperlink{cs_8c_ae2b324f8f0cdc3610d98ce6cebd50075}{cs\_norm}}\ (A))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01382}01382\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0\ ;\ j\ <\ n\ ;\ j++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01383}01383\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01384}01384\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8h_a3cb9f0894fab1c8fbb0753c9c7c2a8d9}{printf}}\ (\textcolor{stringliteral}{"{}\ \ \ \ col\ \%g\ :\ locations\ \%g\ to\ \%g\(\backslash\)n"{}},\ (\textcolor{keywordtype}{double})\ j,}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01385}01385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{double})\ (Ap\ [j]),\ (\textcolor{keywordtype}{double})\ (Ap\ [j+1]-\/1))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01386}01386\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Ap\ [j]\ ;\ p\ <\ Ap\ [j+1]\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01387}01387\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01388}01388\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8h_a3cb9f0894fab1c8fbb0753c9c7c2a8d9}{printf}}\ (\textcolor{stringliteral}{"{}\ \ \ \ \ \ \%g\ :\ \%g\(\backslash\)n"{}},\ (\textcolor{keywordtype}{double})\ (Ai\ [p]),\ Ax\ ?\ Ax\ [p]\ :\ 1)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01389}01389\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (brief\ \&\&\ p\ >\ 20)\ \{\ \mbox{\hyperlink{cs_8h_a3cb9f0894fab1c8fbb0753c9c7c2a8d9}{printf}}\ (\textcolor{stringliteral}{"{}\ \ ...\(\backslash\)n"{}})\ ;\ \textcolor{keywordflow}{return}\ (1)\ ;\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01390}01390\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01391}01391\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01392}01392\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01393}01393\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01394}01394\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01395}01395\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8h_a3cb9f0894fab1c8fbb0753c9c7c2a8d9}{printf}}\ (\textcolor{stringliteral}{"{}triplet:\ \%g-\/by-\/\%g,\ nzmax:\ \%g\ nnz:\ \%g\(\backslash\)n"{}},\ (\textcolor{keywordtype}{double})\ m,}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01396}01396\ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{double})\ n,\ (\textcolor{keywordtype}{double})\ nzmax,\ (\textcolor{keywordtype}{double})\ nz)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01397}01397\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ 0\ ;\ p\ <\ nz\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01398}01398\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01399}01399\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8h_a3cb9f0894fab1c8fbb0753c9c7c2a8d9}{printf}}\ (\textcolor{stringliteral}{"{}\ \ \ \ \%g\ \%g\ :\ \%g\(\backslash\)n"{}},\ (\textcolor{keywordtype}{double})\ (Ai\ [p]),\ (\textcolor{keywordtype}{double})\ (Ap\ [p]),}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01400}01400\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Ax\ ?\ Ax\ [p]\ :\ 1)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01401}01401\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (brief\ \&\&\ p\ >\ 20)\ \{\ \mbox{\hyperlink{cs_8h_a3cb9f0894fab1c8fbb0753c9c7c2a8d9}{printf}}\ (\textcolor{stringliteral}{"{}\ \ ...\(\backslash\)n"{}})\ ;\ \textcolor{keywordflow}{return}\ (1)\ ;\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01402}01402\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01403}01403\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01404}01404\ \ \ \ \ \textcolor{keywordflow}{return}\ (1)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01405}01405\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01406}01406\ \textcolor{comment}{/*\ x\ =\ b(p),\ for\ dense\ vectors\ x\ and\ b;\ p=NULL\ denotes\ identity\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01407}\mbox{\hyperlink{cs_8c_a79d20fcd31c30d118075e08087127c4e}{01407}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_a79d20fcd31c30d118075e08087127c4e}{cs\_pvec}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *p,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ *b,\ \textcolor{keywordtype}{double}\ *x,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ n)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01408}01408\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01409}01409\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ k\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01410}01410\ \ \ \ \ \textcolor{keywordflow}{if}\ (!x\ ||\ !b)\ \textcolor{keywordflow}{return}\ (0)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01411}01411\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ n\ ;\ k++)\ x\ [k]\ =\ b\ [p\ ?\ p\ [k]\ :\ k]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01412}01412\ \ \ \ \ \textcolor{keywordflow}{return}\ (1)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01413}01413\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01414}01414\ \textcolor{comment}{/*\ sparse\ QR\ factorization\ [V,beta,pinv,R]\ =\ qr\ (A)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01415}\mbox{\hyperlink{cs_8c_ad50e945d7db927c8731fff2bcc962eea}{01415}}\ \mbox{\hyperlink{structcs__numeric}{csn}}\ *\mbox{\hyperlink{cs_8c_ad50e945d7db927c8731fff2bcc962eea}{cs\_qr}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__symbolic}{css}}\ *S)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01416}01416\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01417}01417\ \ \ \ \ \textcolor{keywordtype}{double}\ *Rx,\ *Vx,\ *Ax,\ *x,\ \ *Beta\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01418}01418\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ i,\ k,\ p,\ n,\ vnz,\ p1,\ top,\ m2,\ len,\ col,\ rnz,\ *s,\ *leftmost,\ *Ap,\ *Ai,}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01419}01419\ \ \ \ \ \ \ \ \ *parent,\ *Rp,\ *Ri,\ *Vp,\ *Vi,\ *w,\ *pinv,\ *q\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01420}01420\ \ \ \ \ \mbox{\hyperlink{structcs__sparse}{cs}}\ *R,\ *V\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01421}01421\ \ \ \ \ \mbox{\hyperlink{structcs__numeric}{csn}}\ *N\ ;\ \textcolor{comment}{//\ the\ result}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01422}01422\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A)\ ||\ !S)\ \textcolor{keywordflow}{return}\ (NULL)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01423}01423\ \ \ \ \ n\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;\ Ap\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Ai\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Ax\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01424}01424\ \ \ \ \ q\ =\ S-\/>\mbox{\hyperlink{structcs__symbolic_a28f8bda67a6e43eac6bac66980f57163}{q}}\ ;\ parent\ =\ S-\/>\mbox{\hyperlink{structcs__symbolic_aec9034130e3a364799c96d3bae5f3809}{parent}}\ ;\ pinv\ =\ S-\/>\mbox{\hyperlink{structcs__symbolic_aaec943329f58d681893838030e3e273c}{pinv}}\ ;\ m2\ =\ S-\/>\mbox{\hyperlink{structcs__symbolic_aa0227f03661c17f047757cad80d6f4d9}{m2}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01425}01425\ \ \ \ \ vnz\ =\ S-\/>\mbox{\hyperlink{structcs__symbolic_a4f723af5f9ae0047f678a82a146d17b0}{lnz}}\ ;\ rnz\ =\ S-\/>\mbox{\hyperlink{structcs__symbolic_a75ba99f8c206d85c4936e11053e7f5e3}{unz}}\ ;\ leftmost\ =\ S-\/>\mbox{\hyperlink{structcs__symbolic_a06a2d29d73a501796269bc02638dbf97}{leftmost}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01426}01426\ \ \ \ \ w\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (m2+n,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ get\ csi\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01427}01427\ \ \ \ \ x\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (m2,\ \textcolor{keyword}{sizeof}\ (\textcolor{keywordtype}{double}))\ ;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ get\ double\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01428}01428\ \ \ \ \ N\ =\ \mbox{\hyperlink{cs_8c_a071e69dcb222391d3add6c5220a79f51}{cs\_calloc}}\ (1,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{structcs__numeric}{csn}}))\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ allocate\ result\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01429}01429\ \ \ \ \ \textcolor{keywordflow}{if}\ (!w\ ||\ !x\ ||\ !N)\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a694a09c9515e8fd862bd5270ee35cbc8}{cs\_ndone}}\ (N,\ NULL,\ w,\ x,\ 0))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01430}01430\ \ \ \ \ s\ =\ w\ +\ m2\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ s\ is\ size\ n\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01431}01431\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ m2\ ;\ k++)\ x\ [k]\ =\ 0\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ clear\ workspace\ x\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01432}01432\ \ \ \ \ N-\/>\mbox{\hyperlink{structcs__numeric_a93a8cf26f01d3df51b41acc690f120d7}{L}}\ =\ V\ =\ \mbox{\hyperlink{cs_8c_af3ed6e2936760b1b53b79fe3ed5cc8b6}{cs\_spalloc}}\ (m2,\ n,\ vnz,\ 1,\ 0)\ ;\ \ \ \ \ \ \textcolor{comment}{/*\ allocate\ result\ V\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01433}01433\ \ \ \ \ N-\/>\mbox{\hyperlink{structcs__numeric_a1e07204edb10064ca1e471289fced1cb}{U}}\ =\ R\ =\ \mbox{\hyperlink{cs_8c_af3ed6e2936760b1b53b79fe3ed5cc8b6}{cs\_spalloc}}\ (m2,\ n,\ rnz,\ 1,\ 0)\ ;\ \ \ \ \ \ \textcolor{comment}{/*\ allocate\ result\ R\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01434}01434\ \ \ \ \ N-\/>\mbox{\hyperlink{structcs__numeric_ad81bc354670c58c7e715293e98316152}{B}}\ =\ Beta\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (n,\ \textcolor{keyword}{sizeof}\ (\textcolor{keywordtype}{double}))\ ;\ \ \textcolor{comment}{/*\ allocate\ result\ Beta\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01435}01435\ \ \ \ \ \textcolor{keywordflow}{if}\ (!R\ ||\ !V\ ||\ !Beta)\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a694a09c9515e8fd862bd5270ee35cbc8}{cs\_ndone}}\ (N,\ NULL,\ w,\ x,\ 0))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01436}01436\ \ \ \ \ Rp\ =\ R-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Ri\ =\ R-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Rx\ =\ R-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01437}01437\ \ \ \ \ Vp\ =\ V-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Vi\ =\ V-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Vx\ =\ V-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01438}01438\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0\ ;\ i\ <\ m2\ ;\ i++)\ w\ [i]\ =\ -\/1\ ;\ \textcolor{comment}{/*\ clear\ w,\ to\ mark\ nodes\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01439}01439\ \ \ \ \ rnz\ =\ 0\ ;\ vnz\ =\ 0\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01440}01440\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ n\ ;\ k++)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ V\ and\ R\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01441}01441\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01442}01442\ \ \ \ \ \ \ \ \ Rp\ [k]\ =\ rnz\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ R(:,k)\ starts\ here\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01443}01443\ \ \ \ \ \ \ \ \ Vp\ [k]\ =\ p1\ =\ vnz\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ V(:,k)\ starts\ here\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01444}01444\ \ \ \ \ \ \ \ \ w\ [k]\ =\ k\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ add\ V(k,k)\ to\ pattern\ of\ V\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01445}01445\ \ \ \ \ \ \ \ \ Vi\ [vnz++]\ =\ k\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01446}01446\ \ \ \ \ \ \ \ \ top\ =\ n\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01447}01447\ \ \ \ \ \ \ \ \ col\ =\ q\ ?\ q\ [k]\ :\ k\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01448}01448\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Ap\ [col]\ ;\ p\ <\ Ap\ [col+1]\ ;\ p++)\ \ \ \textcolor{comment}{/*\ find\ R(:,k)\ pattern\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01449}01449\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01450}01450\ \ \ \ \ \ \ \ \ \ \ \ \ i\ =\ leftmost\ [Ai\ [p]]\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ i\ =\ min(find(A(i,q)))\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01451}01451\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (len\ =\ 0\ ;\ w\ [i]\ !=\ k\ ;\ i\ =\ parent\ [i])\ \textcolor{comment}{/*\ traverse\ up\ to\ k\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01452}01452\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01453}01453\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ s\ [len++]\ =\ i\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01454}01454\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ w\ [i]\ =\ k\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01455}01455\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01456}01456\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (len\ >\ 0)\ s\ [-\/-\/top]\ =\ s\ [-\/-\/len]\ ;\ \textcolor{comment}{/*\ push\ path\ on\ stack\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01457}01457\ \ \ \ \ \ \ \ \ \ \ \ \ i\ =\ pinv\ [Ai\ [p]]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ i\ =\ permuted\ row\ of\ A(:,col)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01458}01458\ \ \ \ \ \ \ \ \ \ \ \ \ x\ [i]\ =\ Ax\ [p]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ x\ (i)\ =\ A(:,col)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01459}01459\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ >\ k\ \&\&\ w\ [i]\ <\ k)\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ pattern\ of\ V(:,k)\ =\ x\ (k+1:m)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01460}01460\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01461}01461\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Vi\ [vnz++]\ =\ i\ ;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ add\ i\ to\ pattern\ of\ V(:,k)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01462}01462\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ w\ [i]\ =\ k\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01463}01463\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01464}01464\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01465}01465\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ top\ ;\ p\ <\ n\ ;\ p++)\ \textcolor{comment}{/*\ for\ each\ i\ in\ pattern\ of\ R(:,k)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01466}01466\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01467}01467\ \ \ \ \ \ \ \ \ \ \ \ \ i\ =\ s\ [p]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ R(i,k)\ is\ nonzero\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01468}01468\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8c_a88a82fabd191059a8db610fbfe6b008a}{cs\_happly}}\ (V,\ i,\ Beta\ [i],\ x)\ ;\ \textcolor{comment}{/*\ apply\ (V(i),Beta(i))\ to\ x\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01469}01469\ \ \ \ \ \ \ \ \ \ \ \ \ Ri\ [rnz]\ =\ i\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ R(i,k)\ =\ x(i)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01470}01470\ \ \ \ \ \ \ \ \ \ \ \ \ Rx\ [rnz++]\ =\ x\ [i]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01471}01471\ \ \ \ \ \ \ \ \ \ \ \ \ x\ [i]\ =\ 0\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01472}01472\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (parent\ [i]\ ==\ k)\ vnz\ =\ \mbox{\hyperlink{cs_8c_a324e7bf547ed0b969275da4410563e6e}{cs\_scatter}}\ (V,\ i,\ 0,\ w,\ NULL,\ k,\ V,\ vnz);}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01473}01473\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01474}01474\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ p1\ ;\ p\ <\ vnz\ ;\ p++)\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ gather\ V(:,k)\ =\ x\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01475}01475\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01476}01476\ \ \ \ \ \ \ \ \ \ \ \ \ Vx\ [p]\ =\ x\ [Vi\ [p]]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01477}01477\ \ \ \ \ \ \ \ \ \ \ \ \ x\ [Vi\ [p]]\ =\ 0\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01478}01478\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01479}01479\ \ \ \ \ \ \ \ \ Ri\ [rnz]\ =\ k\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ R(k,k)\ =\ norm\ (x)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01480}01480\ \ \ \ \ \ \ \ \ Rx\ [rnz++]\ =\ \mbox{\hyperlink{cs_8c_af4e2e546282433ebb90343c8535dd1fe}{cs\_house}}\ (Vx+p1,\ Beta+k,\ vnz-\/p1)\ ;\ \textcolor{comment}{/*\ [v,beta]=house(x)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01481}01481\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01482}01482\ \ \ \ \ Rp\ [n]\ =\ rnz\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ finalize\ R\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01483}01483\ \ \ \ \ Vp\ [n]\ =\ vnz\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ finalize\ V\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01484}01484\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a694a09c9515e8fd862bd5270ee35cbc8}{cs\_ndone}}\ (N,\ NULL,\ w,\ x,\ 1))\ ;\ \ \textcolor{comment}{/*\ success\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01485}01485\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01486}01486\ \textcolor{comment}{/*\ x=A\(\backslash\)b\ where\ A\ can\ be\ rectangular;\ b\ overwritten\ with\ solution\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01487}\mbox{\hyperlink{cs_8c_a136e729a618c610422377201351db105}{01487}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_a136e729a618c610422377201351db105}{cs\_qrsol}}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ order,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \textcolor{keywordtype}{double}\ *b)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01488}01488\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01489}01489\ \ \ \ \ \textcolor{keywordtype}{double}\ *x\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01490}01490\ \ \ \ \ \mbox{\hyperlink{structcs__symbolic}{css}}\ *S\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01491}01491\ \ \ \ \ \mbox{\hyperlink{structcs__numeric}{csn}}\ *N\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01492}01492\ \ \ \ \ \mbox{\hyperlink{structcs__sparse}{cs}}\ *AT\ =\ NULL\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01493}01493\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ k,\ m,\ n,\ ok\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01494}01494\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A)\ ||\ !b)\ \textcolor{keywordflow}{return}\ (0)\ ;\ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01495}01495\ \ \ \ \ n\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01496}01496\ \ \ \ \ m\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a8dab81f7d781bd65c7cb4f103db87ade}{m}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01497}01497\ \ \ \ \ \textcolor{keywordflow}{if}\ (m\ >=\ n)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01498}01498\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01499}01499\ \ \ \ \ \ \ \ \ S\ =\ \mbox{\hyperlink{cs_8c_a7cb77fc595740853b9d5f49df6d5f64c}{cs\_sqr}}\ (order,\ A,\ 1)\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ ordering\ and\ symbolic\ analysis\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01500}01500\ \ \ \ \ \ \ \ \ N\ =\ \mbox{\hyperlink{cs_8c_ad50e945d7db927c8731fff2bcc962eea}{cs\_qr}}\ (A,\ S)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ numeric\ QR\ factorization\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01501}01501\ \ \ \ \ \ \ \ \ x\ =\ \mbox{\hyperlink{cs_8c_a071e69dcb222391d3add6c5220a79f51}{cs\_calloc}}\ (S\ ?\ S-\/>\mbox{\hyperlink{structcs__symbolic_aa0227f03661c17f047757cad80d6f4d9}{m2}}\ :\ 1,\ \textcolor{keyword}{sizeof}\ (double))\ ;\ \ \ \ \textcolor{comment}{/*\ get\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01502}01502\ \ \ \ \ \ \ \ \ ok\ =\ (S\ \&\&\ N\ \&\&\ x)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01503}01503\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ok)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01504}01504\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01505}01505\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8c_a0938ec08825dc07a2dab8f9477ab053b}{cs\_ipvec}}\ (S-\/>\mbox{\hyperlink{structcs__symbolic_aaec943329f58d681893838030e3e273c}{pinv}},\ b,\ x,\ m)\ ;\ \ \ \textcolor{comment}{/*\ x(0:m-\/1)\ =\ b(p(0:m-\/1)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01506}01506\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ n\ ;\ k++)\ \ \ \ \ \ \ \textcolor{comment}{/*\ apply\ Householder\ refl.\ to\ x\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01507}01507\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01508}01508\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8c_a88a82fabd191059a8db610fbfe6b008a}{cs\_happly}}\ (N-\/>\mbox{\hyperlink{structcs__numeric_a93a8cf26f01d3df51b41acc690f120d7}{L}},\ k,\ N-\/>\mbox{\hyperlink{structcs__numeric_ad81bc354670c58c7e715293e98316152}{B}}\ [k],\ x)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01509}01509\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01510}01510\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8c_aace9cc447db7e3e293431a31f6965730}{cs\_usolve}}\ (N-\/>\mbox{\hyperlink{structcs__numeric_a1e07204edb10064ca1e471289fced1cb}{U}},\ x)\ ;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ x\ =\ R\(\backslash\)x\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01511}01511\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8c_a0938ec08825dc07a2dab8f9477ab053b}{cs\_ipvec}}\ (S-\/>\mbox{\hyperlink{structcs__symbolic_a28f8bda67a6e43eac6bac66980f57163}{q}},\ x,\ b,\ n)\ ;\ \ \ \ \ \ \textcolor{comment}{/*\ b(q(0:n-\/1))\ =\ x(0:n-\/1)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01512}01512\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01513}01513\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01514}01514\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01515}01515\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01516}01516\ \ \ \ \ \ \ \ \ AT\ =\ \mbox{\hyperlink{cs_8c_a838dfaabdae54c408a4a696dfffa3dea}{cs\_transpose}}\ (A,\ 1)\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Ax=b\ is\ underdetermined\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01517}01517\ \ \ \ \ \ \ \ \ S\ =\ \mbox{\hyperlink{cs_8c_a7cb77fc595740853b9d5f49df6d5f64c}{cs\_sqr}}\ (order,\ AT,\ 1)\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ ordering\ and\ symbolic\ analysis\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01518}01518\ \ \ \ \ \ \ \ \ N\ =\ \mbox{\hyperlink{cs_8c_ad50e945d7db927c8731fff2bcc962eea}{cs\_qr}}\ (AT,\ S)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ numeric\ QR\ factorization\ of\ A'\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01519}01519\ \ \ \ \ \ \ \ \ x\ =\ \mbox{\hyperlink{cs_8c_a071e69dcb222391d3add6c5220a79f51}{cs\_calloc}}\ (S\ ?\ S-\/>\mbox{\hyperlink{structcs__symbolic_aa0227f03661c17f047757cad80d6f4d9}{m2}}\ :\ 1,\ \textcolor{keyword}{sizeof}\ (double))\ ;\ \ \ \ \textcolor{comment}{/*\ get\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01520}01520\ \ \ \ \ \ \ \ \ ok\ =\ (AT\ \&\&\ S\ \&\&\ N\ \&\&\ x)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01521}01521\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ok)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01522}01522\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01523}01523\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8c_a79d20fcd31c30d118075e08087127c4e}{cs\_pvec}}\ (S-\/>\mbox{\hyperlink{structcs__symbolic_a28f8bda67a6e43eac6bac66980f57163}{q}},\ b,\ x,\ m)\ ;\ \ \ \ \ \ \ \textcolor{comment}{/*\ x(q(0:m-\/1))\ =\ b(0:m-\/1)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01524}01524\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8c_a63f6ad02ef0d33f9166966af3756c4d6}{cs\_utsolve}}\ (N-\/>\mbox{\hyperlink{structcs__numeric_a1e07204edb10064ca1e471289fced1cb}{U}},\ x)\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ x\ =\ R'\(\backslash\)x\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01525}01525\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ m-\/1\ ;\ k\ >=\ 0\ ;\ k-\/-\/)\ \ \ \ \textcolor{comment}{/*\ apply\ Householder\ refl.\ to\ x\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01526}01526\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01527}01527\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8c_a88a82fabd191059a8db610fbfe6b008a}{cs\_happly}}\ (N-\/>\mbox{\hyperlink{structcs__numeric_a93a8cf26f01d3df51b41acc690f120d7}{L}},\ k,\ N-\/>\mbox{\hyperlink{structcs__numeric_ad81bc354670c58c7e715293e98316152}{B}}\ [k],\ x)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01528}01528\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01529}01529\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8c_a79d20fcd31c30d118075e08087127c4e}{cs\_pvec}}\ (S-\/>\mbox{\hyperlink{structcs__symbolic_aaec943329f58d681893838030e3e273c}{pinv}},\ x,\ b,\ n)\ ;\ \ \ \ \textcolor{comment}{/*\ b(0:n-\/1)\ =\ x(p(0:n-\/1))\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01530}01530\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01531}01531\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01532}01532\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (x)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01533}01533\ \ \ \ \ \mbox{\hyperlink{cs_8c_a2eebf0dae1d9ee505a016630e4fa5748}{cs\_sfree}}\ (S)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01534}01534\ \ \ \ \ \mbox{\hyperlink{cs_8c_adabc8e810cec49307537b5e3368d53aa}{cs\_nfree}}\ (N)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01535}01535\ \ \ \ \ \mbox{\hyperlink{cs_8c_a01a74117bb6004b0b844de5940ddee0a}{cs\_spfree}}\ (AT)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01536}01536\ \ \ \ \ \textcolor{keywordflow}{return}\ (ok)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01537}01537\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01538}01538\ \textcolor{comment}{/*\ return\ a\ random\ permutation\ vector,\ the\ identity\ perm,\ or\ p\ =\ n-\/1:-\/1:0.}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01539}01539\ \textcolor{comment}{\ *\ seed\ =\ -\/1\ means\ p\ =\ n-\/1:-\/1:0.\ \ seed\ =\ 0\ means\ p\ =\ identity.\ \ otherwise}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01540}01540\ \textcolor{comment}{\ *\ p\ =\ random\ permutation.\ \ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01541}01541\ \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01542}01542\ \textcolor{comment}{\ *\ NB:\ We\ use\ R's\ RNG\ *and*\ its\ state;\ i.e.,\ if\ seed\ is\ not\ -\/1\ or\ 0,}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01543}01543\ \textcolor{comment}{\ *\ ==\ \ 'seed'\ is\ *not*\ used\ at\ all\ in\ this\ version\ of\ cs\_randperm()\ !}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01544}01544\ \textcolor{comment}{*/}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01545}01545\ }
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01546}\mbox{\hyperlink{cs_8c_aa4e3a12345c15d293c72cdb54c1bcdda}{01546}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *\mbox{\hyperlink{cs_8c_aa4e3a12345c15d293c72cdb54c1bcdda}{cs\_randperm}}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ n,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ seed)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01547}01547\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01548}01548\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *p,\ k,\ j,\ t\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01549}01549\ \ \ \ \ \textcolor{keywordflow}{if}\ (seed\ ==\ 0)\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \ \ \textcolor{comment}{/*\ return\ p\ =\ NULL\ (identity)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01550}01550\ \ \ \ \ p\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (n,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \ \ \textcolor{comment}{/*\ allocate\ result\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01551}01551\ \ \ \ \ \textcolor{keywordflow}{if}\ (!p)\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ out\ of\ memory\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01552}01552\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ n\ ;\ k++)\ p\ [k]\ =\ n-\/k-\/1\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01553}01553\ \ \ \ \ \textcolor{keywordflow}{if}\ (seed\ ==\ -\/1)\ \textcolor{keywordflow}{return}\ (p)\ ;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ return\ reverse\ permutation\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01554}01554\ \ \ \ \ GetRNGstate();\textcolor{comment}{/*\ <-\/\ for\ R\ package\ Matrix}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01555}01555\ \textcolor{comment}{\ \ \ \ srand\ (seed)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ .*\ get\ new\ random\ number\ seed\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01556}01556\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ n\ ;\ k++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01557}01557\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01558}01558\ \ \ \ \ \ \ \ \ j\ =\ k\ +\ (int)(unif\_rand()\ *\ (n-\/k));\ \textcolor{comment}{//\ j\ =\ rand\ integer\ in\ range\ k\ to\ n-\/1}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01559}01559\ \ \ \ \ \ \ \ \ t\ =\ p\ [j]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ swap\ p[k]\ and\ p[j]\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01560}01560\ \ \ \ \ \ \ \ \ p\ [j]\ =\ p\ [k]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01561}01561\ \ \ \ \ \ \ \ \ p\ [k]\ =\ t\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01562}01562\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01563}01563\ \ \ \ \ PutRNGstate();\ \textcolor{comment}{//\ <-\/\ R\ package\ Matrix}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01564}01564\ \ \ \ \ \textcolor{keywordflow}{return}\ (p)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01565}01565\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01566}01566\ \textcolor{comment}{/*\ xi\ [top...n-\/1]\ =\ nodes\ reachable\ from\ graph\ of\ G*P'\ via\ nodes\ in\ B(:,k).}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01567}01567\ \textcolor{comment}{\ *\ xi\ [n...2n-\/1]\ used\ as\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01568}\mbox{\hyperlink{cs_8c_aa3ab9062fd3f90144bc78c76090c225c}{01568}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_aa3ab9062fd3f90144bc78c76090c225c}{cs\_reach}}\ (\mbox{\hyperlink{structcs__sparse}{cs}}\ *G,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *B,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ k,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *xi,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *pinv)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01569}01569\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01570}01570\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ p,\ n,\ top,\ *Bp,\ *Bi,\ *Gp\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01571}01571\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (G)\ ||\ !\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (B)\ ||\ !xi)\ \textcolor{keywordflow}{return}\ (-\/1)\ ;\ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01572}01572\ \ \ \ \ n\ =\ G-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;\ Bp\ =\ B-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Bi\ =\ B-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Gp\ =\ G-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01573}01573\ \ \ \ \ top\ =\ n\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01574}01574\ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Bp\ [k]\ ;\ p\ <\ Bp\ [k+1]\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01575}01575\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01576}01576\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_ad5ef446ddee80d5771be956a23520bf5}{CS\_MARKED}}\ (Gp,\ Bi\ [p]))\ \ \ \ \textcolor{comment}{/*\ start\ a\ dfs\ at\ unmarked\ node\ i\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01577}01577\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01578}01578\ \ \ \ \ \ \ \ \ \ \ \ \ top\ =\ \mbox{\hyperlink{cs_8c_a43a06094fee0e062b78fd70d1c70b9c4}{cs\_dfs}}\ (Bi\ [p],\ G,\ top,\ xi,\ xi+n,\ pinv)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01579}01579\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01580}01580\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01581}01581\ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ top\ ;\ p\ <\ n\ ;\ p++)\ \mbox{\hyperlink{cs_8h_ad5096d9a8169cff461816575072022f0}{CS\_MARK}}\ (Gp,\ xi\ [p])\ ;\ \ \textcolor{comment}{/*\ restore\ G\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01582}01582\ \ \ \ \ \textcolor{keywordflow}{return}\ (top)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01583}01583\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01584}01584\ \textcolor{comment}{/*\ x\ =\ x\ +\ beta\ *\ A(:,j),\ where\ x\ is\ a\ dense\ vector\ and\ A(:,j)\ is\ sparse\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01585}\mbox{\hyperlink{cs_8c_a324e7bf547ed0b969275da4410563e6e}{01585}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_a324e7bf547ed0b969275da4410563e6e}{cs\_scatter}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ j,\ \textcolor{keywordtype}{double}\ beta,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *w,\ \textcolor{keywordtype}{double}\ *x,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ mark,}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01586}01586\ \ \ \ \ \mbox{\hyperlink{structcs__sparse}{cs}}\ *C,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ nz)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01587}01587\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01588}01588\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ i,\ p,\ *Ap,\ *Ai,\ *Ci\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01589}01589\ \ \ \ \ \textcolor{keywordtype}{double}\ *Ax\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01590}01590\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A)\ ||\ !w\ ||\ !\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (C))\ \textcolor{keywordflow}{return}\ (-\/1)\ ;\ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01591}01591\ \ \ \ \ Ap\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Ai\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Ax\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;\ Ci\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01592}01592\ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Ap\ [j]\ ;\ p\ <\ Ap\ [j+1]\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01593}01593\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01594}01594\ \ \ \ \ \ \ \ \ i\ =\ Ai\ [p]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ A(i,j)\ is\ nonzero\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01595}01595\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (w\ [i]\ <\ mark)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01596}01596\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01597}01597\ \ \ \ \ \ \ \ \ \ \ \ \ w\ [i]\ =\ mark\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ i\ is\ new\ entry\ in\ column\ j\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01598}01598\ \ \ \ \ \ \ \ \ \ \ \ \ Ci\ [nz++]\ =\ i\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ add\ i\ to\ pattern\ of\ C(:,j)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01599}01599\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x)\ x\ [i]\ =\ beta\ *\ Ax\ [p]\ ;\ \ \ \ \ \ \textcolor{comment}{/*\ x(i)\ =\ beta*A(i,j)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01600}01600\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01601}01601\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (x)\ x\ [i]\ +=\ beta\ *\ Ax\ [p]\ ;\ \ \ \ \textcolor{comment}{/*\ i\ exists\ in\ C(:,j)\ already\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01602}01602\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01603}01603\ \ \ \ \ \textcolor{keywordflow}{return}\ (nz)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01604}01604\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01605}01605\ \textcolor{comment}{/*\ find\ the\ strongly\ connected\ components\ of\ a\ square\ matrix\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01606}\mbox{\hyperlink{cs_8c_a195331bbf7d2aa87b1a94158c5d56d17}{01606}}\ \mbox{\hyperlink{structcs__dmperm__results}{csd}}\ *\mbox{\hyperlink{cs_8c_a195331bbf7d2aa87b1a94158c5d56d17}{cs\_scc}}\ (\mbox{\hyperlink{structcs__sparse}{cs}}\ *A)\ \ \ \ \ \textcolor{comment}{/*\ matrix\ A\ temporarily\ modified,\ then\ restored\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01607}01607\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01608}01608\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ n,\ i,\ k,\ b,\ nb\ =\ 0,\ top,\ *xi,\ *pstack,\ *p,\ *r,\ *Ap,\ *ATp,\ *rcopy,\ *Blk\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01609}01609\ \ \ \ \ \mbox{\hyperlink{structcs__sparse}{cs}}\ *AT\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01610}01610\ \ \ \ \ \mbox{\hyperlink{structcs__dmperm__results}{csd}}\ *D\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01611}01611\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A))\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01612}01612\ \ \ \ \ n\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;\ Ap\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01613}01613\ \ \ \ \ D\ =\ \mbox{\hyperlink{cs_8c_a5b17812b02b3c113ce0088870aaeffd9}{cs\_dalloc}}\ (n,\ 0)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ allocate\ result\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01614}01614\ \ \ \ \ AT\ =\ \mbox{\hyperlink{cs_8c_a838dfaabdae54c408a4a696dfffa3dea}{cs\_transpose}}\ (A,\ 0)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ AT\ =\ A'\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01615}01615\ \ \ \ \ xi\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (2*n+1,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ get\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01616}01616\ \ \ \ \ \textcolor{keywordflow}{if}\ (!D\ ||\ !AT\ ||\ !xi)\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_aa848643a3fad58acb3b400c36de5dd3e}{cs\_ddone}}\ (D,\ AT,\ xi,\ 0))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01617}01617\ \ \ \ \ Blk\ =\ xi\ ;\ rcopy\ =\ pstack\ =\ xi\ +\ n\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01618}01618\ \ \ \ \ p\ =\ D-\/>\mbox{\hyperlink{structcs__dmperm__results_aa1cdef46dad146c0d64d64dbda23f44e}{p}}\ ;\ r\ =\ D-\/>\mbox{\hyperlink{structcs__dmperm__results_a193ebe355ad15e9408fdf705e197833f}{r}}\ ;\ ATp\ =\ AT-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01619}01619\ \ \ \ \ top\ =\ n\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01620}01620\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0\ ;\ i\ <\ n\ ;\ i++)\ \ \ \textcolor{comment}{/*\ first\ dfs(A)\ to\ find\ finish\ times\ (xi)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01621}01621\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01622}01622\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_ad5ef446ddee80d5771be956a23520bf5}{CS\_MARKED}}\ (Ap,\ i))\ top\ =\ \mbox{\hyperlink{cs_8c_a43a06094fee0e062b78fd70d1c70b9c4}{cs\_dfs}}\ (i,\ A,\ top,\ xi,\ pstack,\ NULL)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01623}01623\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01624}01624\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0\ ;\ i\ <\ n\ ;\ i++)\ \mbox{\hyperlink{cs_8h_ad5096d9a8169cff461816575072022f0}{CS\_MARK}}\ (Ap,\ i)\ ;\ \textcolor{comment}{/*\ restore\ A;\ unmark\ all\ nodes*/}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01625}01625\ \ \ \ \ top\ =\ n\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01626}01626\ \ \ \ \ nb\ =\ n\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01627}01627\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ n\ ;\ k++)\ \ \ \textcolor{comment}{/*\ dfs(A')\ to\ find\ strongly\ connnected\ comp\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01628}01628\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01629}01629\ \ \ \ \ \ \ \ \ i\ =\ xi\ [k]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ get\ i\ in\ reverse\ order\ of\ finish\ times\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01630}01630\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{cs_8h_ad5ef446ddee80d5771be956a23520bf5}{CS\_MARKED}}\ (ATp,\ i))\ continue\ ;\ \ \textcolor{comment}{/*\ skip\ node\ i\ if\ already\ ordered\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01631}01631\ \ \ \ \ \ \ \ \ r\ [nb-\/-\/]\ =\ top\ ;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ node\ i\ is\ the\ start\ of\ a\ component\ in\ p\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01632}01632\ \ \ \ \ \ \ \ \ top\ =\ \mbox{\hyperlink{cs_8c_a43a06094fee0e062b78fd70d1c70b9c4}{cs\_dfs}}\ (i,\ AT,\ top,\ p,\ pstack,\ NULL)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01633}01633\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01634}01634\ \ \ \ \ r\ [nb]\ =\ 0\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ first\ block\ starts\ at\ zero;\ shift\ r\ up\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01635}01635\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ nb\ ;\ k\ <=\ n\ ;\ k++)\ r\ [k-\/nb]\ =\ r\ [k]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01636}01636\ \ \ \ \ D-\/>\mbox{\hyperlink{structcs__dmperm__results_aecf39880909b599bcbf205e214e99354}{nb}}\ =\ nb\ =\ n-\/nb\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ nb\ =\ \#\ of\ strongly\ connected\ components\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01637}01637\ \ \ \ \ \textcolor{keywordflow}{for}\ (b\ =\ 0\ ;\ b\ <\ nb\ ;\ b++)\ \ \textcolor{comment}{/*\ sort\ each\ block\ in\ natural\ order\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01638}01638\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01639}01639\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ r\ [b]\ ;\ k\ <\ r\ [b+1]\ ;\ k++)\ Blk\ [p\ [k]]\ =\ b\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01640}01640\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01641}01641\ \ \ \ \ \textcolor{keywordflow}{for}\ (b\ =\ 0\ ;\ b\ <=\ nb\ ;\ b++)\ rcopy\ [b]\ =\ r\ [b]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01642}01642\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0\ ;\ i\ <\ n\ ;\ i++)\ p\ [rcopy\ [Blk\ [i]]++]\ =\ i\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01643}01643\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_aa848643a3fad58acb3b400c36de5dd3e}{cs\_ddone}}\ (D,\ AT,\ xi,\ 1))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01644}01644\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01645}01645\ \textcolor{comment}{/*\ ordering\ and\ symbolic\ analysis\ for\ a\ Cholesky\ factorization\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01646}\mbox{\hyperlink{cs_8c_a33a1dc7aff658c5699d6c6d4a0fa70d3}{01646}}\ \mbox{\hyperlink{structcs__symbolic}{css}}\ *\mbox{\hyperlink{cs_8c_a33a1dc7aff658c5699d6c6d4a0fa70d3}{cs\_schol}}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ order,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01647}01647\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01648}01648\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ n,\ *\mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}},\ *post,\ *P\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01649}01649\ \ \ \ \ \mbox{\hyperlink{structcs__sparse}{cs}}\ *C\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01650}01650\ \ \ \ \ \mbox{\hyperlink{structcs__symbolic}{css}}\ *S\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01651}01651\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A))\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01652}01652\ \ \ \ \ n\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01653}01653\ \ \ \ \ S\ =\ \mbox{\hyperlink{cs_8c_a071e69dcb222391d3add6c5220a79f51}{cs\_calloc}}\ (1,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{structcs__symbolic}{css}}))\ ;\ \ \ \ \ \ \ \textcolor{comment}{/*\ allocate\ result\ S\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01654}01654\ \ \ \ \ \textcolor{keywordflow}{if}\ (!S)\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ out\ of\ memory\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01655}01655\ \ \ \ \ P\ =\ \mbox{\hyperlink{cs_8c_a8c0812b53c0937ab04dc22eae0fb5259}{cs\_amd}}\ (order,\ A)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ P\ =\ amd(A+A'),\ or\ natural\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01656}01656\ \ \ \ \ S-\/>\mbox{\hyperlink{structcs__symbolic_aaec943329f58d681893838030e3e273c}{pinv}}\ =\ \mbox{\hyperlink{cs_8c_ae8aefba6d94d832505cc7ed4b0d78548}{cs\_pinv}}\ (P,\ n)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ find\ inverse\ permutation\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01657}01657\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (P)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01658}01658\ \ \ \ \ \textcolor{keywordflow}{if}\ (order\ \&\&\ !S-\/>\mbox{\hyperlink{structcs__symbolic_aaec943329f58d681893838030e3e273c}{pinv}})\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a2eebf0dae1d9ee505a016630e4fa5748}{cs\_sfree}}\ (S))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01659}01659\ \ \ \ \ C\ =\ \mbox{\hyperlink{cs_8c_ad19ab7e30ae8e32fe9b000a1e7e30a1f}{cs\_symperm}}\ (A,\ S-\/>\mbox{\hyperlink{structcs__symbolic_aaec943329f58d681893838030e3e273c}{pinv}},\ 0)\ ;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ C\ =\ spones(triu(A(P,P)))\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01660}01660\ \ \ \ \ S-\/>\mbox{\hyperlink{structcs__symbolic_aec9034130e3a364799c96d3bae5f3809}{parent}}\ =\ \mbox{\hyperlink{cs_8c_a86d7b84d5a4cdf928556bcd30a413a84}{cs\_etree}}\ (C,\ 0)\ ;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ find\ etree\ of\ C\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01661}01661\ \ \ \ \ post\ =\ \mbox{\hyperlink{cs_8c_ae8e3fc0a5f911aa66a95391b1be0c780}{cs\_post}}\ (S-\/>\mbox{\hyperlink{structcs__symbolic_aec9034130e3a364799c96d3bae5f3809}{parent}},\ n)\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ postorder\ the\ etree\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01662}01662\ \ \ \ \ \mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}}\ =\ \mbox{\hyperlink{cs_8c_ad97e14775c7d6b9f8f1e8c5ee0d63aa7}{cs\_counts}}\ (C,\ S-\/>\mbox{\hyperlink{structcs__symbolic_aec9034130e3a364799c96d3bae5f3809}{parent}},\ post,\ 0)\ ;\ \textcolor{comment}{/*\ find\ column\ counts\ of\ chol(C)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01663}01663\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (post)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01664}01664\ \ \ \ \ \mbox{\hyperlink{cs_8c_a01a74117bb6004b0b844de5940ddee0a}{cs\_spfree}}\ (C)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01665}01665\ \ \ \ \ S-\/>\mbox{\hyperlink{structcs__symbolic_af019d6662511b698efe705ad93b4e27b}{cp}}\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (n+1,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \textcolor{comment}{/*\ allocate\ result\ S-\/>cp\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01666}01666\ \ \ \ \ S-\/>\mbox{\hyperlink{structcs__symbolic_a75ba99f8c206d85c4936e11053e7f5e3}{unz}}\ =\ S-\/>\mbox{\hyperlink{structcs__symbolic_a4f723af5f9ae0047f678a82a146d17b0}{lnz}}\ =\ \mbox{\hyperlink{cs_8c_a4c92d1dd47385e119da4d37ca82c2baa}{cs\_cumsum}}\ (S-\/>\mbox{\hyperlink{structcs__symbolic_af019d6662511b698efe705ad93b4e27b}{cp}},\ \mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}},\ n)\ ;\ \textcolor{comment}{/*\ find\ column\ pointers\ for\ L\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01667}01667\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (\mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}})\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01668}01668\ \ \ \ \ \textcolor{keywordflow}{return}\ ((S-\/>\mbox{\hyperlink{structcs__symbolic_a4f723af5f9ae0047f678a82a146d17b0}{lnz}}\ >=\ 0)\ ?\ S\ :\ \mbox{\hyperlink{cs_8c_a2eebf0dae1d9ee505a016630e4fa5748}{cs\_sfree}}\ (S))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01669}01669\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01670}01670\ \textcolor{comment}{/*\ solve\ Gx=b(:,k),\ where\ G\ is\ either\ upper\ (lo=0)\ or\ lower\ (lo=1)\ triangular\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01671}\mbox{\hyperlink{cs_8c_a772ba477fdc1f6499735635e037b0c6d}{01671}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_a772ba477fdc1f6499735635e037b0c6d}{cs\_spsolve}}\ (\mbox{\hyperlink{structcs__sparse}{cs}}\ *G,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *B,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ k,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *xi,\ \textcolor{keywordtype}{double}\ *x,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *pinv,}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01672}01672\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ lo)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01673}01673\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01674}01674\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ j,\ J,\ p,\ q,\ px,\ top,\ n,\ *Gp,\ *Gi,\ *Bp,\ *Bi\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01675}01675\ \ \ \ \ \textcolor{keywordtype}{double}\ *Gx,\ *Bx\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01676}01676\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (G)\ ||\ !\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (B)\ ||\ !xi\ ||\ !x)\ \textcolor{keywordflow}{return}\ (-\/1)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01677}01677\ \ \ \ \ Gp\ =\ G-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Gi\ =\ G-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Gx\ =\ G-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;\ n\ =\ G-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01678}01678\ \ \ \ \ Bp\ =\ B-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Bi\ =\ B-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Bx\ =\ B-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01679}01679\ \ \ \ \ top\ =\ \mbox{\hyperlink{cs_8c_aa3ab9062fd3f90144bc78c76090c225c}{cs\_reach}}\ (G,\ B,\ k,\ xi,\ pinv)\ ;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ xi[top..n-\/1]=Reach(B(:,k))\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01680}01680\ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ top\ ;\ p\ <\ n\ ;\ p++)\ x\ [xi\ [p]]\ =\ 0\ ;\ \ \ \ \textcolor{comment}{/*\ clear\ x\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01681}01681\ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Bp\ [k]\ ;\ p\ <\ Bp\ [k+1]\ ;\ p++)\ x\ [Bi\ [p]]\ =\ Bx\ [p]\ ;\ \textcolor{comment}{/*\ scatter\ B\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01682}01682\ \ \ \ \ \textcolor{keywordflow}{for}\ (px\ =\ top\ ;\ px\ <\ n\ ;\ px++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01683}01683\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01684}01684\ \ \ \ \ \ \ \ \ j\ =\ xi\ [px]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ x(j)\ is\ nonzero\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01685}01685\ \ \ \ \ \ \ \ \ J\ =\ pinv\ ?\ (pinv\ [j])\ :\ j\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ j\ maps\ to\ col\ J\ of\ G\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01686}01686\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (J\ <\ 0)\ continue\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ column\ J\ is\ empty\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01687}01687\ \ \ \ \ \ \ \ \ x\ [j]\ /=\ Gx\ [lo\ ?\ (Gp\ [J])\ :\ (Gp\ [J+1]-\/1)]\ ;\textcolor{comment}{/*\ x(j)\ /=\ G(j,j)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01688}01688\ \ \ \ \ \ \ \ \ p\ =\ lo\ ?\ (Gp\ [J]+1)\ :\ (Gp\ [J])\ ;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ lo:\ L(j,j)\ 1st\ entry\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01689}01689\ \ \ \ \ \ \ \ \ q\ =\ lo\ ?\ (Gp\ [J+1])\ :\ (Gp\ [J+1]-\/1)\ ;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ up:\ U(j,j)\ last\ entry\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01690}01690\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\ ;\ p\ <\ q\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01691}01691\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01692}01692\ \ \ \ \ \ \ \ \ \ \ \ \ x\ [Gi\ [p]]\ -\/=\ Gx\ [p]\ *\ x\ [j]\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ x(i)\ -\/=\ G(i,j)\ *\ x(j)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01693}01693\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01694}01694\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01695}01695\ \ \ \ \ \textcolor{keywordflow}{return}\ (top)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ return\ top\ of\ stack\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01696}01696\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01697}01697\ \textcolor{comment}{/*\ compute\ nnz(V)\ =\ S-\/>lnz,\ S-\/>pinv,\ S-\/>leftmost,\ S-\/>m2\ from\ A\ and\ S-\/>parent\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01698}\mbox{\hyperlink{cs_8c_aa12cda78613dc6d703cc57606a6d944f}{01698}}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_aa12cda78613dc6d703cc57606a6d944f}{cs\_vcount}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \mbox{\hyperlink{structcs__symbolic}{css}}\ *S)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01699}01699\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01700}01700\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ i,\ k,\ p,\ pa,\ n\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}},\ m\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a8dab81f7d781bd65c7cb4f103db87ade}{m}},\ *Ap\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}},\ *Ai\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}},\ *next,\ *head,}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01701}01701\ \ \ \ \ \ \ \ \ *tail,\ *nque,\ *pinv,\ *leftmost,\ *w,\ *parent\ =\ S-\/>\mbox{\hyperlink{structcs__symbolic_aec9034130e3a364799c96d3bae5f3809}{parent}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01702}01702\ \ \ \ \ S-\/>\mbox{\hyperlink{structcs__symbolic_aaec943329f58d681893838030e3e273c}{pinv}}\ =\ pinv\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (m+n,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ allocate\ pinv,\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01703}01703\ \ \ \ \ S-\/>\mbox{\hyperlink{structcs__symbolic_a06a2d29d73a501796269bc02638dbf97}{leftmost}}\ =\ leftmost\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (m,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \ \textcolor{comment}{/*\ and\ leftmost\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01704}01704\ \ \ \ \ w\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (m+3*n,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \ \ \textcolor{comment}{/*\ get\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01705}01705\ \ \ \ \ \textcolor{keywordflow}{if}\ (!pinv\ ||\ !w\ ||\ !leftmost)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01706}01706\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01707}01707\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (w)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ pinv\ and\ leftmost\ freed\ later\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01708}01708\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (0)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ out\ of\ memory\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01709}01709\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01710}01710\ \ \ \ \ next\ =\ w\ ;\ head\ =\ w\ +\ m\ ;\ tail\ =\ w\ +\ m\ +\ n\ ;\ nque\ =\ w\ +\ m\ +\ 2*n\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01711}01711\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ n\ ;\ k++)\ head\ [k]\ =\ -\/1\ ;\ \ \ \textcolor{comment}{/*\ queue\ k\ is\ empty\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01712}01712\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ n\ ;\ k++)\ tail\ [k]\ =\ -\/1\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01713}01713\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ n\ ;\ k++)\ nque\ [k]\ =\ 0\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01714}01714\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0\ ;\ i\ <\ m\ ;\ i++)\ leftmost\ [i]\ =\ -\/1\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01715}01715\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ n-\/1\ ;\ k\ >=\ 0\ ;\ k-\/-\/)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01716}01716\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01717}01717\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Ap\ [k]\ ;\ p\ <\ Ap\ [k+1]\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01718}01718\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01719}01719\ \ \ \ \ \ \ \ \ \ \ \ \ leftmost\ [Ai\ [p]]\ =\ k\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ leftmost[i]\ =\ min(find(A(i,:)))*/}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01720}01720\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01721}01721\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01722}01722\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ m-\/1\ ;\ i\ >=\ 0\ ;\ i-\/-\/)\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ scan\ rows\ in\ reverse\ order\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01723}01723\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01724}01724\ \ \ \ \ \ \ \ \ pinv\ [i]\ =\ -\/1\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ row\ i\ is\ not\ yet\ ordered\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01725}01725\ \ \ \ \ \ \ \ \ k\ =\ leftmost\ [i]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01726}01726\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (k\ ==\ -\/1)\ continue\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ row\ i\ is\ empty\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01727}01727\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (nque\ [k]++\ ==\ 0)\ tail\ [k]\ =\ i\ ;\ \textcolor{comment}{/*\ first\ row\ in\ queue\ k\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01728}01728\ \ \ \ \ \ \ \ \ next\ [i]\ =\ head\ [k]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ put\ i\ at\ head\ of\ queue\ k\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01729}01729\ \ \ \ \ \ \ \ \ head\ [k]\ =\ i\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01730}01730\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01731}01731\ \ \ \ \ S-\/>\mbox{\hyperlink{structcs__symbolic_a4f723af5f9ae0047f678a82a146d17b0}{lnz}}\ =\ 0\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01732}01732\ \ \ \ \ S-\/>\mbox{\hyperlink{structcs__symbolic_aa0227f03661c17f047757cad80d6f4d9}{m2}}\ =\ m\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01733}01733\ \ \ \ \ \textcolor{keywordflow}{for}\ (k\ =\ 0\ ;\ k\ <\ n\ ;\ k++)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ find\ row\ permutation\ and\ nnz(V)*/}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01734}01734\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01735}01735\ \ \ \ \ \ \ \ \ i\ =\ head\ [k]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ remove\ row\ i\ from\ queue\ k\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01736}01736\ \ \ \ \ \ \ \ \ S-\/>\mbox{\hyperlink{structcs__symbolic_a4f723af5f9ae0047f678a82a146d17b0}{lnz}}++\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ count\ V(k,k)\ as\ nonzero\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01737}01737\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ <\ 0)\ i\ =\ S-\/>\mbox{\hyperlink{structcs__symbolic_aa0227f03661c17f047757cad80d6f4d9}{m2}}++\ ;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ add\ a\ fictitious\ row\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01738}01738\ \ \ \ \ \ \ \ \ pinv\ [i]\ =\ k\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ associate\ row\ i\ with\ V(:,k)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01739}01739\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (-\/-\/nque\ [k]\ <=\ 0)\ continue\ ;\ \ \ \ \ \textcolor{comment}{/*\ skip\ if\ V(k+1:m,k)\ is\ empty\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01740}01740\ \ \ \ \ \ \ \ \ S-\/>\mbox{\hyperlink{structcs__symbolic_a4f723af5f9ae0047f678a82a146d17b0}{lnz}}\ +=\ nque\ [k]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ nque\ [k]\ is\ nnz\ (V(k+1:m,k))\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01741}01741\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((pa\ =\ parent\ [k])\ !=\ -\/1)\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ move\ all\ rows\ to\ parent\ of\ k\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01742}01742\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01743}01743\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (nque\ [pa]\ ==\ 0)\ tail\ [pa]\ =\ tail\ [k]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01744}01744\ \ \ \ \ \ \ \ \ \ \ \ \ next\ [tail\ [k]]\ =\ head\ [pa]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01745}01745\ \ \ \ \ \ \ \ \ \ \ \ \ head\ [pa]\ =\ next\ [i]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01746}01746\ \ \ \ \ \ \ \ \ \ \ \ \ nque\ [pa]\ +=\ nque\ [k]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01747}01747\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01748}01748\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01749}01749\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0\ ;\ i\ <\ m\ ;\ i++)\ \textcolor{keywordflow}{if}\ (pinv\ [i]\ <\ 0)\ pinv\ [i]\ =\ k++\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01750}01750\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (w)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01751}01751\ \ \ \ \ \textcolor{keywordflow}{return}\ (1)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01752}01752\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01753}01753\ }
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01754}01754\ \textcolor{comment}{/*\ symbolic\ ordering\ and\ analysis\ for\ QR\ or\ LU\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01755}\mbox{\hyperlink{cs_8c_a7cb77fc595740853b9d5f49df6d5f64c}{01755}}\ \mbox{\hyperlink{structcs__symbolic}{css}}\ *\mbox{\hyperlink{cs_8c_a7cb77fc595740853b9d5f49df6d5f64c}{cs\_sqr}}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ order,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ qr)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01756}01756\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01757}01757\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ n,\ k,\ ok\ =\ 1,\ *post\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01758}01758\ \ \ \ \ \mbox{\hyperlink{structcs__symbolic}{css}}\ *S\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01759}01759\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A))\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01760}01760\ \ \ \ \ n\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01761}01761\ \ \ \ \ S\ =\ \mbox{\hyperlink{cs_8c_a071e69dcb222391d3add6c5220a79f51}{cs\_calloc}}\ (1,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{structcs__symbolic}{css}}))\ ;\ \ \ \ \ \ \ \textcolor{comment}{/*\ allocate\ result\ S\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01762}01762\ \ \ \ \ \textcolor{keywordflow}{if}\ (!S)\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ out\ of\ memory\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01763}01763\ \ \ \ \ S-\/>\mbox{\hyperlink{structcs__symbolic_a28f8bda67a6e43eac6bac66980f57163}{q}}\ =\ \mbox{\hyperlink{cs_8c_a8c0812b53c0937ab04dc22eae0fb5259}{cs\_amd}}\ (order,\ A)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ fill-\/reducing\ ordering\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01764}01764\ \ \ \ \ \textcolor{keywordflow}{if}\ (order\ \&\&\ !S-\/>\mbox{\hyperlink{structcs__symbolic_a28f8bda67a6e43eac6bac66980f57163}{q}})\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_a2eebf0dae1d9ee505a016630e4fa5748}{cs\_sfree}}\ (S))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01765}01765\ \ \ \ \ \textcolor{keywordflow}{if}\ (qr)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ QR\ symbolic\ analysis\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01766}01766\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01767}01767\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structcs__sparse}{cs}}\ *C\ =\ order\ ?\ \mbox{\hyperlink{cs_8c_aa09de703c0e946fe0d8a61dacbd78aa4}{cs\_permute}}\ (A,\ NULL,\ S-\/>\mbox{\hyperlink{structcs__symbolic_a28f8bda67a6e43eac6bac66980f57163}{q}},\ 0)\ :\ ((\mbox{\hyperlink{structcs__sparse}{cs}}\ *)\ A)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01768}01768\ \ \ \ \ \ \ \ \ S-\/>\mbox{\hyperlink{structcs__symbolic_aec9034130e3a364799c96d3bae5f3809}{parent}}\ =\ \mbox{\hyperlink{cs_8c_a86d7b84d5a4cdf928556bcd30a413a84}{cs\_etree}}\ (C,\ 1)\ ;\ \ \ \ \ \ \ \textcolor{comment}{/*\ etree\ of\ C'*C,\ where\ C=A(:,q)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01769}01769\ \ \ \ \ \ \ \ \ post\ =\ \mbox{\hyperlink{cs_8c_ae8e3fc0a5f911aa66a95391b1be0c780}{cs\_post}}\ (S-\/>\mbox{\hyperlink{structcs__symbolic_aec9034130e3a364799c96d3bae5f3809}{parent}},\ n)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01770}01770\ \ \ \ \ \ \ \ \ S-\/>\mbox{\hyperlink{structcs__symbolic_af019d6662511b698efe705ad93b4e27b}{cp}}\ =\ \mbox{\hyperlink{cs_8c_ad97e14775c7d6b9f8f1e8c5ee0d63aa7}{cs\_counts}}\ (C,\ S-\/>\mbox{\hyperlink{structcs__symbolic_aec9034130e3a364799c96d3bae5f3809}{parent}},\ post,\ 1)\ ;\ \ \textcolor{comment}{/*\ col\ counts\ chol(C'*C)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01771}01771\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (post)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01772}01772\ \ \ \ \ \ \ \ \ ok\ =\ C\ \&\&\ S-\/>\mbox{\hyperlink{structcs__symbolic_aec9034130e3a364799c96d3bae5f3809}{parent}}\ \&\&\ S-\/>\mbox{\hyperlink{structcs__symbolic_af019d6662511b698efe705ad93b4e27b}{cp}}\ \&\&\ \mbox{\hyperlink{cs_8c_aa12cda78613dc6d703cc57606a6d944f}{cs\_vcount}}\ (C,\ S)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01773}01773\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ok)\ \textcolor{keywordflow}{for}\ (S-\/>\mbox{\hyperlink{structcs__symbolic_a75ba99f8c206d85c4936e11053e7f5e3}{unz}}\ =\ 0,\ k\ =\ 0\ ;\ k\ <\ n\ ;\ k++)\ S-\/>\mbox{\hyperlink{structcs__symbolic_a75ba99f8c206d85c4936e11053e7f5e3}{unz}}\ +=\ S-\/>\mbox{\hyperlink{structcs__symbolic_af019d6662511b698efe705ad93b4e27b}{cp}}\ [k]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01774}01774\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (order)\ \mbox{\hyperlink{cs_8c_a01a74117bb6004b0b844de5940ddee0a}{cs\_spfree}}\ (C)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01775}01775\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01776}01776\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01777}01777\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01778}01778\ \ \ \ \ \ \ \ \ S-\/>\mbox{\hyperlink{structcs__symbolic_a75ba99f8c206d85c4936e11053e7f5e3}{unz}}\ =\ 4*(A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ [n])\ +\ n\ ;\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ for\ LU\ factorization\ only,\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01779}01779\ \ \ \ \ \ \ \ \ S-\/>\mbox{\hyperlink{structcs__symbolic_a4f723af5f9ae0047f678a82a146d17b0}{lnz}}\ =\ S-\/>\mbox{\hyperlink{structcs__symbolic_a75ba99f8c206d85c4936e11053e7f5e3}{unz}}\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ guess\ nnz(L)\ and\ nnz(U)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01780}01780\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01781}01781\ \ \ \ \ \textcolor{keywordflow}{return}\ (ok\ ?\ S\ :\ \mbox{\hyperlink{cs_8c_a2eebf0dae1d9ee505a016630e4fa5748}{cs\_sfree}}\ (S))\ ;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ return\ result\ S\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01782}01782\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01783}01783\ \textcolor{comment}{/*\ C\ =\ A(p,p)\ where\ A\ and\ C\ are\ symmetric\ the\ upper\ part\ stored;\ pinv\ not\ p\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01784}\mbox{\hyperlink{cs_8c_ad19ab7e30ae8e32fe9b000a1e7e30a1f}{01784}}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *\mbox{\hyperlink{cs_8c_ad19ab7e30ae8e32fe9b000a1e7e30a1f}{cs\_symperm}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *pinv,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ values)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01785}01785\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01786}01786\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ i,\ j,\ p,\ q,\ i2,\ j2,\ n,\ *Ap,\ *Ai,\ *Cp,\ *Ci,\ *w\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01787}01787\ \ \ \ \ \textcolor{keywordtype}{double}\ *Cx,\ *Ax\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01788}01788\ \ \ \ \ \mbox{\hyperlink{structcs__sparse}{cs}}\ *C\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01789}01789\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A))\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01790}01790\ \ \ \ \ n\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;\ Ap\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Ai\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Ax\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01791}01791\ \ \ \ \ C\ =\ \mbox{\hyperlink{cs_8c_af3ed6e2936760b1b53b79fe3ed5cc8b6}{cs\_spalloc}}\ (n,\ n,\ Ap\ [n],\ values\ \&\&\ (Ax\ !=\ NULL),\ 0)\ ;\ \textcolor{comment}{/*\ alloc\ result*/}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01792}01792\ \ \ \ \ w\ =\ \mbox{\hyperlink{cs_8c_a071e69dcb222391d3add6c5220a79f51}{cs\_calloc}}\ (n,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ get\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01793}01793\ \ \ \ \ \textcolor{keywordflow}{if}\ (!C\ ||\ !w)\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_afa27f1bfd7e5be4f160c24b0828d9178}{cs\_done}}\ (C,\ w,\ NULL,\ 0))\ ;\ \ \ \ \textcolor{comment}{/*\ out\ of\ memory\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01794}01794\ \ \ \ \ Cp\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Ci\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Cx\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01795}01795\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0\ ;\ j\ <\ n\ ;\ j++)\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ count\ entries\ in\ each\ column\ of\ C\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01796}01796\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01797}01797\ \ \ \ \ \ \ \ \ j2\ =\ pinv\ ?\ pinv\ [j]\ :\ j\ ;\ \ \ \ \ \ \textcolor{comment}{/*\ column\ j\ of\ A\ is\ column\ j2\ of\ C\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01798}01798\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Ap\ [j]\ ;\ p\ <\ Ap\ [j+1]\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01799}01799\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01800}01800\ \ \ \ \ \ \ \ \ \ \ \ \ i\ =\ Ai\ [p]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01801}01801\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ >\ j)\ continue\ ;\ \ \ \ \ \ \ \textcolor{comment}{/*\ skip\ lower\ triangular\ part\ of\ A\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01802}01802\ \ \ \ \ \ \ \ \ \ \ \ \ i2\ =\ pinv\ ?\ pinv\ [i]\ :\ i\ ;\ \ \textcolor{comment}{/*\ row\ i\ of\ A\ is\ row\ i2\ of\ C\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01803}01803\ \ \ \ \ \ \ \ \ \ \ \ \ w\ [\mbox{\hyperlink{cs_8h_a7447e0bed6bf453743551d158e019e8b}{CS\_MAX}}\ (i2,\ j2)]++\ ;\ \ \ \ \ \textcolor{comment}{/*\ column\ count\ of\ C\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01804}01804\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01805}01805\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01806}01806\ \ \ \ \ \mbox{\hyperlink{cs_8c_a4c92d1dd47385e119da4d37ca82c2baa}{cs\_cumsum}}\ (Cp,\ w,\ n)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ compute\ column\ pointers\ of\ C\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01807}01807\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0\ ;\ j\ <\ n\ ;\ j++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01808}01808\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01809}01809\ \ \ \ \ \ \ \ \ j2\ =\ pinv\ ?\ pinv\ [j]\ :\ j\ ;\ \ \ \ \ \ \textcolor{comment}{/*\ column\ j\ of\ A\ is\ column\ j2\ of\ C\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01810}01810\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Ap\ [j]\ ;\ p\ <\ Ap\ [j+1]\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01811}01811\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01812}01812\ \ \ \ \ \ \ \ \ \ \ \ \ i\ =\ Ai\ [p]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01813}01813\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ >\ j)\ continue\ ;\ \ \ \ \ \ \ \textcolor{comment}{/*\ skip\ lower\ triangular\ part\ of\ A*/}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01814}01814\ \ \ \ \ \ \ \ \ \ \ \ \ i2\ =\ pinv\ ?\ pinv\ [i]\ :\ i\ ;\ \ \textcolor{comment}{/*\ row\ i\ of\ A\ is\ row\ i2\ of\ C\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01815}01815\ \ \ \ \ \ \ \ \ \ \ \ \ Ci\ [q\ =\ w\ [\mbox{\hyperlink{cs_8h_a7447e0bed6bf453743551d158e019e8b}{CS\_MAX}}\ (i2,\ j2)]++]\ =\ \mbox{\hyperlink{cs_8h_a2635aa5c35f05bb0e4c88be5aabae949}{CS\_MIN}}\ (i2,\ j2)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01816}01816\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (Cx)\ Cx\ [q]\ =\ Ax\ [p]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01817}01817\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01818}01818\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01819}01819\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_afa27f1bfd7e5be4f160c24b0828d9178}{cs\_done}}\ (C,\ w,\ NULL,\ 1))\ ;\ \ \textcolor{comment}{/*\ success;\ free\ workspace,\ return\ C\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01820}01820\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01821}01821\ \textcolor{comment}{/*\ depth-\/first\ search\ and\ postorder\ of\ a\ tree\ rooted\ at\ node\ j\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01822}\mbox{\hyperlink{cs_8c_a763cce1cc37a21b58c8493c6c28e4afe}{01822}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_a763cce1cc37a21b58c8493c6c28e4afe}{cs\_tdfs}}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ j,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ k,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *head,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *next,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *post,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *stack)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01823}01823\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01824}01824\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ i,\ p,\ top\ =\ 0\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01825}01825\ \ \ \ \ \textcolor{keywordflow}{if}\ (!head\ ||\ !next\ ||\ !post\ ||\ !stack)\ \textcolor{keywordflow}{return}\ (-\/1)\ ;\ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01826}01826\ \ \ \ \ stack\ [0]\ =\ j\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ place\ j\ on\ the\ stack\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01827}01827\ \ \ \ \ \textcolor{keywordflow}{while}\ (top\ >=\ 0)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ while\ (stack\ is\ not\ empty)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01828}01828\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01829}01829\ \ \ \ \ \ \ \ \ p\ =\ stack\ [top]\ ;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ p\ =\ top\ of\ stack\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01830}01830\ \ \ \ \ \ \ \ \ i\ =\ head\ [p]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ i\ =\ youngest\ child\ of\ p\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01831}01831\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ ==\ -\/1)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01832}01832\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01833}01833\ \ \ \ \ \ \ \ \ \ \ \ \ top-\/-\/\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ p\ has\ no\ unordered\ children\ left\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01834}01834\ \ \ \ \ \ \ \ \ \ \ \ \ post\ [k++]\ =\ p\ ;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ node\ p\ is\ the\ kth\ postordered\ node\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01835}01835\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01836}01836\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01837}01837\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01838}01838\ \ \ \ \ \ \ \ \ \ \ \ \ head\ [p]\ =\ next\ [i]\ ;\ \ \ \textcolor{comment}{/*\ remove\ i\ from\ children\ of\ p\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01839}01839\ \ \ \ \ \ \ \ \ \ \ \ \ stack\ [++top]\ =\ i\ ;\ \ \ \ \ \textcolor{comment}{/*\ start\ dfs\ on\ child\ node\ i\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01840}01840\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01841}01841\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01842}01842\ \ \ \ \ \textcolor{keywordflow}{return}\ (k)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01843}01843\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01844}01844\ \textcolor{comment}{/*\ C\ =\ A'\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01845}\mbox{\hyperlink{cs_8c_a838dfaabdae54c408a4a696dfffa3dea}{01845}}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *\mbox{\hyperlink{cs_8c_a838dfaabdae54c408a4a696dfffa3dea}{cs\_transpose}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ values)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01846}01846\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01847}01847\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ p,\ q,\ j,\ *Cp,\ *Ci,\ n,\ m,\ *Ap,\ *Ai,\ *w\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01848}01848\ \ \ \ \ \textcolor{keywordtype}{double}\ *Cx,\ *Ax\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01849}01849\ \ \ \ \ \mbox{\hyperlink{structcs__sparse}{cs}}\ *C\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01850}01850\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A))\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01851}01851\ \ \ \ \ m\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a8dab81f7d781bd65c7cb4f103db87ade}{m}}\ ;\ n\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;\ Ap\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Ai\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Ax\ =\ A-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01852}01852\ \ \ \ \ C\ =\ \mbox{\hyperlink{cs_8c_af3ed6e2936760b1b53b79fe3ed5cc8b6}{cs\_spalloc}}\ (n,\ m,\ Ap\ [n],\ values\ \&\&\ Ax,\ 0)\ ;\ \ \ \ \ \ \ \textcolor{comment}{/*\ allocate\ result\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01853}01853\ \ \ \ \ w\ =\ \mbox{\hyperlink{cs_8c_a071e69dcb222391d3add6c5220a79f51}{cs\_calloc}}\ (m,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ get\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01854}01854\ \ \ \ \ \textcolor{keywordflow}{if}\ (!C\ ||\ !w)\ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_afa27f1bfd7e5be4f160c24b0828d9178}{cs\_done}}\ (C,\ w,\ NULL,\ 0))\ ;\ \ \ \ \ \ \ \textcolor{comment}{/*\ out\ of\ memory\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01855}01855\ \ \ \ \ Cp\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Ci\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Cx\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01856}01856\ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ 0\ ;\ p\ <\ Ap\ [n]\ ;\ p++)\ w\ [Ai\ [p]]++\ ;\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ row\ counts\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01857}01857\ \ \ \ \ \mbox{\hyperlink{cs_8c_a4c92d1dd47385e119da4d37ca82c2baa}{cs\_cumsum}}\ (Cp,\ w,\ m)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ row\ pointers\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01858}01858\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0\ ;\ j\ <\ n\ ;\ j++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01859}01859\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01860}01860\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Ap\ [j]\ ;\ p\ <\ Ap\ [j+1]\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01861}01861\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01862}01862\ \ \ \ \ \ \ \ \ \ \ \ \ Ci\ [q\ =\ w\ [Ai\ [p]]++]\ =\ j\ ;\ \textcolor{comment}{/*\ place\ A(i,j)\ as\ entry\ C(j,i)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01863}01863\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (Cx)\ Cx\ [q]\ =\ Ax\ [p]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01864}01864\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01865}01865\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01866}01866\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{cs_8c_afa27f1bfd7e5be4f160c24b0828d9178}{cs\_done}}\ (C,\ w,\ NULL,\ 1))\ ;\ \ \textcolor{comment}{/*\ success;\ free\ w\ and\ return\ C\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01867}01867\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01868}01868\ \textcolor{comment}{/*\ sparse\ Cholesky\ update/downdate,\ L*L'\ +\ sigma*w*w'\ (sigma\ =\ +1\ or\ -\/1)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01869}\mbox{\hyperlink{cs_8c_a2bb008386ca2830501510aaa9a604976}{01869}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_a2bb008386ca2830501510aaa9a604976}{cs\_updown}}\ (\mbox{\hyperlink{structcs__sparse}{cs}}\ *L,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ sigma,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *C,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *parent)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01870}01870\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01871}01871\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ n,\ p,\ f,\ j,\ *Lp,\ *Li,\ *Cp,\ *Ci\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01872}01872\ \ \ \ \ \textcolor{keywordtype}{double}\ *Lx,\ *Cx,\ alpha,\ beta\ =\ 1,\ delta,\ gamma,\ w1,\ w2,\ *w,\ beta2\ =\ 1\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01873}01873\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (L)\ ||\ !\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (C)\ ||\ !parent)\ \textcolor{keywordflow}{return}\ (0)\ ;\ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01874}01874\ \ \ \ \ Lp\ =\ L-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Li\ =\ L-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Lx\ =\ L-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;\ n\ =\ L-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01875}01875\ \ \ \ \ Cp\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Ci\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Cx\ =\ C-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01876}01876\ \ \ \ \ \textcolor{keywordflow}{if}\ ((p\ =\ Cp\ [0])\ >=\ Cp\ [1])\ \textcolor{keywordflow}{return}\ (1)\ ;\ \ \ \ \ \ \ \ \textcolor{comment}{/*\ return\ if\ C\ empty\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01877}01877\ \ \ \ \ w\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (n,\ \textcolor{keyword}{sizeof}\ (\textcolor{keywordtype}{double}))\ ;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ get\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01878}01878\ \ \ \ \ \textcolor{keywordflow}{if}\ (!w)\ \textcolor{keywordflow}{return}\ (0)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ out\ of\ memory\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01879}01879\ \ \ \ \ f\ =\ Ci\ [p]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01880}01880\ \ \ \ \ \textcolor{keywordflow}{for}\ (\ ;\ p\ <\ Cp\ [1]\ ;\ p++)\ f\ =\ \mbox{\hyperlink{cs_8h_a2635aa5c35f05bb0e4c88be5aabae949}{CS\_MIN}}\ (f,\ Ci\ [p])\ ;\ \ \textcolor{comment}{/*\ f\ =\ min\ (find\ (C))\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01881}01881\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ f\ ;\ j\ !=\ -\/1\ ;\ j\ =\ parent\ [j])\ w\ [j]\ =\ 0\ ;\ \ \textcolor{comment}{/*\ clear\ workspace\ w\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01882}01882\ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Cp\ [0]\ ;\ p\ <\ Cp\ [1]\ ;\ p++)\ w\ [Ci\ [p]]\ =\ Cx\ [p]\ ;\ \textcolor{comment}{/*\ w\ =\ C\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01883}01883\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ f\ ;\ j\ !=\ -\/1\ ;\ j\ =\ parent\ [j])\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ walk\ path\ f\ up\ to\ root\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01884}01884\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01885}01885\ \ \ \ \ \ \ \ \ p\ =\ Lp\ [j]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01886}01886\ \ \ \ \ \ \ \ \ alpha\ =\ w\ [j]\ /\ Lx\ [p]\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ alpha\ =\ w(j)\ /\ L(j,j)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01887}01887\ \ \ \ \ \ \ \ \ beta2\ =\ beta*beta\ +\ sigma*alpha*alpha\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01888}01888\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (beta2\ <=\ 0)\ break\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ not\ positive\ definite\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01889}01889\ \ \ \ \ \ \ \ \ beta2\ =\ sqrt\ (beta2)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01890}01890\ \ \ \ \ \ \ \ \ delta\ =\ (sigma\ >\ 0)\ ?\ (beta\ /\ beta2)\ :\ (beta2\ /\ beta)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01891}01891\ \ \ \ \ \ \ \ \ gamma\ =\ sigma\ *\ alpha\ /\ (beta2\ *\ beta)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01892}01892\ \ \ \ \ \ \ \ \ Lx\ [p]\ =\ delta\ *\ Lx\ [p]\ +\ ((sigma\ >\ 0)\ ?\ (gamma\ *\ w\ [j])\ :\ 0)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01893}01893\ \ \ \ \ \ \ \ \ beta\ =\ beta2\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01894}01894\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p++\ ;\ p\ <\ Lp\ [j+1]\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01895}01895\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01896}01896\ \ \ \ \ \ \ \ \ \ \ \ \ w1\ =\ w\ [Li\ [p]]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01897}01897\ \ \ \ \ \ \ \ \ \ \ \ \ w\ [Li\ [p]]\ =\ w2\ =\ w1\ -\/\ alpha\ *\ Lx\ [p]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01898}01898\ \ \ \ \ \ \ \ \ \ \ \ \ Lx\ [p]\ =\ delta\ *\ Lx\ [p]\ +\ gamma\ *\ ((sigma\ >\ 0)\ ?\ w1\ :\ w2)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01899}01899\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01900}01900\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01901}01901\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (w)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01902}01902\ \ \ \ \ \textcolor{keywordflow}{return}\ (beta2\ >\ 0)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01903}01903\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01904}01904\ \textcolor{comment}{/*\ solve\ Ux=b\ where\ x\ and\ b\ are\ dense.\ \ x=b\ on\ input,\ solution\ on\ output.\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01905}\mbox{\hyperlink{cs_8c_aace9cc447db7e3e293431a31f6965730}{01905}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_aace9cc447db7e3e293431a31f6965730}{cs\_usolve}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *U,\ \textcolor{keywordtype}{double}\ *x)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01906}01906\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01907}01907\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ p,\ j,\ n,\ *Up,\ *Ui\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01908}01908\ \ \ \ \ \textcolor{keywordtype}{double}\ *Ux\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01909}01909\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (U)\ ||\ !x)\ \textcolor{keywordflow}{return}\ (0)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01910}01910\ \ \ \ \ n\ =\ U-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;\ Up\ =\ U-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Ui\ =\ U-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Ux\ =\ U-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01911}01911\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ n-\/1\ ;\ j\ >=\ 0\ ;\ j-\/-\/)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01912}01912\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01913}01913\ \ \ \ \ \ \ \ \ x\ [j]\ /=\ Ux\ [Up\ [j+1]-\/1]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01914}01914\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Up\ [j]\ ;\ p\ <\ Up\ [j+1]-\/1\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01915}01915\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01916}01916\ \ \ \ \ \ \ \ \ \ \ \ \ x\ [Ui\ [p]]\ -\/=\ Ux\ [p]\ *\ x\ [j]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01917}01917\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01918}01918\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01919}01919\ \ \ \ \ \textcolor{keywordflow}{return}\ (1)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01920}01920\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01921}01921\ \textcolor{comment}{/*\ allocate\ a\ sparse\ matrix\ (triplet\ form\ or\ compressed-\/column\ form)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01922}\mbox{\hyperlink{cs_8c_af3ed6e2936760b1b53b79fe3ed5cc8b6}{01922}}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *\mbox{\hyperlink{cs_8c_af3ed6e2936760b1b53b79fe3ed5cc8b6}{cs\_spalloc}}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ m,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ n,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ nzmax,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ values,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ triplet)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01923}01923\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01924}01924\ \ \ \ \ \mbox{\hyperlink{structcs__sparse}{cs}}\ *A\ =\ \mbox{\hyperlink{cs_8c_a071e69dcb222391d3add6c5220a79f51}{cs\_calloc}}\ (1,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{structcs__sparse}{cs}}))\ ;\ \ \ \ \textcolor{comment}{/*\ allocate\ the\ cs\ struct\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01925}01925\ \ \ \ \ \textcolor{keywordflow}{if}\ (!A)\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ out\ of\ memory\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01926}01926\ \ \ \ \ A-\/>\mbox{\hyperlink{structcs__sparse_a8dab81f7d781bd65c7cb4f103db87ade}{m}}\ =\ m\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ define\ dimensions\ and\ nzmax\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01927}01927\ \ \ \ \ A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ =\ n\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01928}01928\ \ \ \ \ A-\/>\mbox{\hyperlink{structcs__sparse_a4d98fb7ac430adab928f42e45d7c5504}{nzmax}}\ =\ nzmax\ =\ \mbox{\hyperlink{cs_8h_a7447e0bed6bf453743551d158e019e8b}{CS\_MAX}}\ (nzmax,\ 1)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01929}01929\ \ \ \ \ A-\/>\mbox{\hyperlink{structcs__sparse_a8eb7205d5e8fbb0c08a80e9fd52d2963}{nz}}\ =\ triplet\ ?\ 0\ :\ -\/1\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ allocate\ triplet\ or\ comp.col\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01930}01930\ \ \ \ \ A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (triplet\ ?\ nzmax\ :\ n+1,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01931}01931\ \ \ \ \ A-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (nzmax,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01932}01932\ \ \ \ \ A-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ =\ values\ ?\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (nzmax,\ \textcolor{keyword}{sizeof}\ (\textcolor{keywordtype}{double}))\ :\ NULL\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01933}01933\ \ \ \ \ \textcolor{keywordflow}{return}\ ((!A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ||\ !A-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ||\ (values\ \&\&\ !A-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}))\ ?\ \mbox{\hyperlink{cs_8c_a01a74117bb6004b0b844de5940ddee0a}{cs\_spfree}}\ (A)\ :\ A)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01934}01934\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01935}01935\ }
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01936}01936\ \textcolor{comment}{/*\ change\ the\ max\ \#\ of\ entries\ sparse\ matrix\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01937}\mbox{\hyperlink{cs_8c_a4f6f6d0b8acba23772fd254ec794e966}{01937}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_a4f6f6d0b8acba23772fd254ec794e966}{cs\_sprealloc}}\ (\mbox{\hyperlink{structcs__sparse}{cs}}\ *A,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ nzmax)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01938}01938\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01939}01939\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ ok,\ oki,\ okj\ =\ 1,\ okx\ =\ 1\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01940}01940\ \ \ \ \ \textcolor{keywordflow}{if}\ (!A)\ \textcolor{keywordflow}{return}\ (0)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01941}01941\ \ \ \ \ \textcolor{keywordflow}{if}\ (nzmax\ <=\ 0)\ nzmax\ =\ (\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (A))\ ?\ (A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ [A-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}])\ :\ A-\/>\mbox{\hyperlink{structcs__sparse_a8eb7205d5e8fbb0c08a80e9fd52d2963}{nz}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01942}01942\ \ \ \ \ nzmax\ =\ \mbox{\hyperlink{cs_8h_a7447e0bed6bf453743551d158e019e8b}{CS\_MAX}}\ (nzmax,\ 1)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01943}01943\ \ \ \ \ A-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ =\ \mbox{\hyperlink{cs_8c_a6e24151b1b4d6711299022113e3c26d6}{cs\_realloc}}\ (A-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}},\ nzmax,\ sizeof\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}),\ \&oki)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01944}01944\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{cs_8h_a62bab576c9482f6e11c4cee5a1b5a39a}{CS\_TRIPLET}}\ (A))\ A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ =\ \mbox{\hyperlink{cs_8c_a6e24151b1b4d6711299022113e3c26d6}{cs\_realloc}}\ (A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}},\ nzmax,\ sizeof\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}),\ \&okj)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01945}01945\ \ \ \ \ \textcolor{keywordflow}{if}\ (A-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}})\ A-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ =\ \mbox{\hyperlink{cs_8c_a6e24151b1b4d6711299022113e3c26d6}{cs\_realloc}}\ (A-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}},\ nzmax,\ sizeof\ (\textcolor{keywordtype}{double}),\ \&okx)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01946}01946\ \ \ \ \ ok\ =\ (oki\ \&\&\ okj\ \&\&\ okx)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01947}01947\ \ \ \ \ \textcolor{keywordflow}{if}\ (ok)\ A-\/>\mbox{\hyperlink{structcs__sparse_a4d98fb7ac430adab928f42e45d7c5504}{nzmax}}\ =\ nzmax\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01948}01948\ \ \ \ \ \textcolor{keywordflow}{return}\ (ok)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01949}01949\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01950}01950\ }
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01951}01951\ \textcolor{comment}{/*\ free\ a\ sparse\ matrix\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01952}\mbox{\hyperlink{cs_8c_a01a74117bb6004b0b844de5940ddee0a}{01952}}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *\mbox{\hyperlink{cs_8c_a01a74117bb6004b0b844de5940ddee0a}{cs\_spfree}}\ (\mbox{\hyperlink{structcs__sparse}{cs}}\ *A)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01953}01953\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01954}01954\ \ \ \ \ \textcolor{keywordflow}{if}\ (!A)\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \ \textcolor{comment}{/*\ do\ nothing\ if\ A\ already\ NULL\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01955}01955\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (A-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}})\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01956}01956\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (A-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}})\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01957}01957\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (A-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}})\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01958}01958\ \ \ \ \ \textcolor{keywordflow}{return}\ ((\mbox{\hyperlink{structcs__sparse}{cs}}\ *)\ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (A))\ ;\ \ \ \textcolor{comment}{/*\ free\ the\ cs\ struct\ and\ return\ NULL\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01959}01959\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01960}01960\ }
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01961}01961\ \textcolor{comment}{/*\ free\ a\ numeric\ factorization\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01962}\mbox{\hyperlink{cs_8c_adabc8e810cec49307537b5e3368d53aa}{01962}}\ \mbox{\hyperlink{structcs__numeric}{csn}}\ *\mbox{\hyperlink{cs_8c_adabc8e810cec49307537b5e3368d53aa}{cs\_nfree}}\ (\mbox{\hyperlink{structcs__numeric}{csn}}\ *N)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01963}01963\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01964}01964\ \ \ \ \ \textcolor{keywordflow}{if}\ (!N)\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \ \textcolor{comment}{/*\ do\ nothing\ if\ N\ already\ NULL\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01965}01965\ \ \ \ \ \mbox{\hyperlink{cs_8c_a01a74117bb6004b0b844de5940ddee0a}{cs\_spfree}}\ (N-\/>\mbox{\hyperlink{structcs__numeric_a93a8cf26f01d3df51b41acc690f120d7}{L}})\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01966}01966\ \ \ \ \ \mbox{\hyperlink{cs_8c_a01a74117bb6004b0b844de5940ddee0a}{cs\_spfree}}\ (N-\/>\mbox{\hyperlink{structcs__numeric_a1e07204edb10064ca1e471289fced1cb}{U}})\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01967}01967\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (N-\/>\mbox{\hyperlink{structcs__numeric_a30fd2e151d4170f569260261bb18d955}{pinv}})\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01968}01968\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (N-\/>\mbox{\hyperlink{structcs__numeric_ad81bc354670c58c7e715293e98316152}{B}})\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01969}01969\ \ \ \ \ \textcolor{keywordflow}{return}\ ((\mbox{\hyperlink{structcs__numeric}{csn}}\ *)\ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (N))\ ;\ \ \textcolor{comment}{/*\ free\ the\ csn\ struct\ and\ return\ NULL\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01970}01970\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01971}01971\ }
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01972}01972\ \textcolor{comment}{/*\ free\ a\ symbolic\ factorization\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01973}\mbox{\hyperlink{cs_8c_a2eebf0dae1d9ee505a016630e4fa5748}{01973}}\ \mbox{\hyperlink{structcs__symbolic}{css}}\ *\mbox{\hyperlink{cs_8c_a2eebf0dae1d9ee505a016630e4fa5748}{cs\_sfree}}\ (\mbox{\hyperlink{structcs__symbolic}{css}}\ *S)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01974}01974\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01975}01975\ \ \ \ \ \textcolor{keywordflow}{if}\ (!S)\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \ \textcolor{comment}{/*\ do\ nothing\ if\ S\ already\ NULL\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01976}01976\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (S-\/>\mbox{\hyperlink{structcs__symbolic_aaec943329f58d681893838030e3e273c}{pinv}})\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01977}01977\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (S-\/>\mbox{\hyperlink{structcs__symbolic_a28f8bda67a6e43eac6bac66980f57163}{q}})\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01978}01978\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (S-\/>\mbox{\hyperlink{structcs__symbolic_aec9034130e3a364799c96d3bae5f3809}{parent}})\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01979}01979\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (S-\/>\mbox{\hyperlink{structcs__symbolic_af019d6662511b698efe705ad93b4e27b}{cp}})\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01980}01980\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (S-\/>\mbox{\hyperlink{structcs__symbolic_a06a2d29d73a501796269bc02638dbf97}{leftmost}})\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01981}01981\ \ \ \ \ \textcolor{keywordflow}{return}\ ((\mbox{\hyperlink{structcs__symbolic}{css}}\ *)\ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (S))\ ;\ \ \textcolor{comment}{/*\ free\ the\ css\ struct\ and\ return\ NULL\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01982}01982\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01983}01983\ }
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01984}01984\ \textcolor{comment}{/*\ allocate\ a\ cs\_dmperm\ or\ cs\_scc\ result\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01985}\mbox{\hyperlink{cs_8c_a5b17812b02b3c113ce0088870aaeffd9}{01985}}\ \mbox{\hyperlink{structcs__dmperm__results}{csd}}\ *\mbox{\hyperlink{cs_8c_a5b17812b02b3c113ce0088870aaeffd9}{cs\_dalloc}}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ m,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ n)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01986}01986\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01987}01987\ \ \ \ \ \mbox{\hyperlink{structcs__dmperm__results}{csd}}\ *D\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01988}01988\ \ \ \ \ D\ =\ \mbox{\hyperlink{cs_8c_a071e69dcb222391d3add6c5220a79f51}{cs\_calloc}}\ (1,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{structcs__dmperm__results}{csd}}))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01989}01989\ \ \ \ \ \textcolor{keywordflow}{if}\ (!D)\ \textcolor{keywordflow}{return}\ (NULL)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01990}01990\ \ \ \ \ D-\/>\mbox{\hyperlink{structcs__dmperm__results_aa1cdef46dad146c0d64d64dbda23f44e}{p}}\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (m,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01991}01991\ \ \ \ \ D-\/>\mbox{\hyperlink{structcs__dmperm__results_a193ebe355ad15e9408fdf705e197833f}{r}}\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (m+6,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01992}01992\ \ \ \ \ D-\/>\mbox{\hyperlink{structcs__dmperm__results_a76216ad1101a5b930eaf062ae3d48c99}{q}}\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (n,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01993}01993\ \ \ \ \ D-\/>\mbox{\hyperlink{structcs__dmperm__results_a6dd273f5ba6466e85e5ac158703911d0}{s}}\ =\ \mbox{\hyperlink{cs_8c_aeaf304feeab73b22eed3e64c0371884b}{cs\_malloc}}\ (n+6,\ \textcolor{keyword}{sizeof}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}))\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01994}01994\ \ \ \ \ \textcolor{keywordflow}{return}\ ((!D-\/>\mbox{\hyperlink{structcs__dmperm__results_aa1cdef46dad146c0d64d64dbda23f44e}{p}}\ ||\ !D-\/>\mbox{\hyperlink{structcs__dmperm__results_a193ebe355ad15e9408fdf705e197833f}{r}}\ ||\ !D-\/>\mbox{\hyperlink{structcs__dmperm__results_a76216ad1101a5b930eaf062ae3d48c99}{q}}\ ||\ !D-\/>\mbox{\hyperlink{structcs__dmperm__results_a6dd273f5ba6466e85e5ac158703911d0}{s}})\ ?\ \mbox{\hyperlink{cs_8c_a30f07e6f09ffa0de8a961de63e624c8e}{cs\_dfree}}\ (D)\ :\ D)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01995}01995\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01996}01996\ }
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01997}01997\ \textcolor{comment}{/*\ free\ a\ cs\_dmperm\ or\ cs\_scc\ result\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01998}\mbox{\hyperlink{cs_8c_a30f07e6f09ffa0de8a961de63e624c8e}{01998}}\ \mbox{\hyperlink{structcs__dmperm__results}{csd}}\ *\mbox{\hyperlink{cs_8c_a30f07e6f09ffa0de8a961de63e624c8e}{cs\_dfree}}\ (\mbox{\hyperlink{structcs__dmperm__results}{csd}}\ *D)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l01999}01999\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02000}02000\ \ \ \ \ \textcolor{keywordflow}{if}\ (!D)\ \textcolor{keywordflow}{return}\ (NULL)\ ;\ \ \ \ \ \textcolor{comment}{/*\ do\ nothing\ if\ D\ already\ NULL\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02001}02001\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (D-\/>\mbox{\hyperlink{structcs__dmperm__results_aa1cdef46dad146c0d64d64dbda23f44e}{p}})\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02002}02002\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (D-\/>\mbox{\hyperlink{structcs__dmperm__results_a76216ad1101a5b930eaf062ae3d48c99}{q}})\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02003}02003\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (D-\/>\mbox{\hyperlink{structcs__dmperm__results_a193ebe355ad15e9408fdf705e197833f}{r}})\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02004}02004\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (D-\/>\mbox{\hyperlink{structcs__dmperm__results_a6dd273f5ba6466e85e5ac158703911d0}{s}})\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02005}02005\ \ \ \ \ \textcolor{keywordflow}{return}\ ((\mbox{\hyperlink{structcs__dmperm__results}{csd}}\ *)\ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (D))\ ;\ \ \textcolor{comment}{/*\ free\ the\ csd\ struct\ and\ return\ NULL\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02006}02006\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02007}02007\ }
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02008}02008\ \textcolor{comment}{/*\ free\ workspace\ and\ return\ a\ sparse\ matrix\ result\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02009}\mbox{\hyperlink{cs_8c_afa27f1bfd7e5be4f160c24b0828d9178}{02009}}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *\mbox{\hyperlink{cs_8c_afa27f1bfd7e5be4f160c24b0828d9178}{cs\_done}}\ (\mbox{\hyperlink{structcs__sparse}{cs}}\ *C,\ \textcolor{keywordtype}{void}\ *w,\ \textcolor{keywordtype}{void}\ *x,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ ok)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02010}02010\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02011}02011\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (w)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ free\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02012}02012\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (x)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02013}02013\ \ \ \ \ \textcolor{keywordflow}{return}\ (ok\ ?\ C\ :\ \mbox{\hyperlink{cs_8c_a01a74117bb6004b0b844de5940ddee0a}{cs\_spfree}}\ (C))\ ;\ \ \ \textcolor{comment}{/*\ return\ result\ if\ OK,\ else\ free\ it\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02014}02014\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02015}02015\ }
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02016}02016\ \textcolor{comment}{/*\ free\ workspace\ and\ return\ csi\ array\ result\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02017}\mbox{\hyperlink{cs_8c_a5f172de9436558173ef0b873d9e1a5db}{02017}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *\mbox{\hyperlink{cs_8c_a5f172de9436558173ef0b873d9e1a5db}{cs\_idone}}\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *p,\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *C,\ \textcolor{keywordtype}{void}\ *w,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ ok)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02018}02018\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02019}02019\ \ \ \ \ \mbox{\hyperlink{cs_8c_a01a74117bb6004b0b844de5940ddee0a}{cs\_spfree}}\ (C)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ free\ temporary\ matrix\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02020}02020\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (w)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ free\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02021}02021\ \ \ \ \ \textcolor{keywordflow}{return}\ (ok\ ?\ p\ :\ (\mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ *)\ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (p))\ ;\ \textcolor{comment}{/*\ return\ result,\ or\ free\ it\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02022}02022\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02023}02023\ }
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02024}02024\ \textcolor{comment}{/*\ free\ workspace\ and\ return\ a\ numeric\ factorization\ (Cholesky,\ LU,\ or\ QR)\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02025}\mbox{\hyperlink{cs_8c_a694a09c9515e8fd862bd5270ee35cbc8}{02025}}\ \mbox{\hyperlink{structcs__numeric}{csn}}\ *\mbox{\hyperlink{cs_8c_a694a09c9515e8fd862bd5270ee35cbc8}{cs\_ndone}}\ (\mbox{\hyperlink{structcs__numeric}{csn}}\ *N,\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *C,\ \textcolor{keywordtype}{void}\ *w,\ \textcolor{keywordtype}{void}\ *x,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ ok)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02026}02026\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02027}02027\ \ \ \ \ \mbox{\hyperlink{cs_8c_a01a74117bb6004b0b844de5940ddee0a}{cs\_spfree}}\ (C)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ free\ temporary\ matrix\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02028}02028\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (w)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ free\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02029}02029\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (x)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02030}02030\ \ \ \ \ \textcolor{keywordflow}{return}\ (ok\ ?\ N\ :\ \mbox{\hyperlink{cs_8c_adabc8e810cec49307537b5e3368d53aa}{cs\_nfree}}\ (N))\ ;\ \ \ \ \textcolor{comment}{/*\ return\ result\ if\ OK,\ else\ free\ it\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02031}02031\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02032}02032\ }
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02033}02033\ \textcolor{comment}{/*\ free\ workspace\ and\ return\ a\ csd\ result\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02034}\mbox{\hyperlink{cs_8c_aa848643a3fad58acb3b400c36de5dd3e}{02034}}\ \mbox{\hyperlink{structcs__dmperm__results}{csd}}\ *\mbox{\hyperlink{cs_8c_aa848643a3fad58acb3b400c36de5dd3e}{cs\_ddone}}\ (\mbox{\hyperlink{structcs__dmperm__results}{csd}}\ *D,\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *C,\ \textcolor{keywordtype}{void}\ *w,\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ ok)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02035}02035\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02036}02036\ \ \ \ \ \mbox{\hyperlink{cs_8c_a01a74117bb6004b0b844de5940ddee0a}{cs\_spfree}}\ (C)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ free\ temporary\ matrix\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02037}02037\ \ \ \ \ \mbox{\hyperlink{cs_8c_adfe5c16cc6d8a8b545b35940a0702be1}{cs\_free}}\ (w)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ free\ workspace\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02038}02038\ \ \ \ \ \textcolor{keywordflow}{return}\ (ok\ ?\ D\ :\ \mbox{\hyperlink{cs_8c_a30f07e6f09ffa0de8a961de63e624c8e}{cs\_dfree}}\ (D))\ ;\ \ \ \ \textcolor{comment}{/*\ return\ result\ if\ OK,\ else\ free\ it\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02039}02039\ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02040}02040\ \textcolor{comment}{/*\ solve\ U'x=b\ where\ x\ and\ b\ are\ dense.\ \ x=b\ on\ input,\ solution\ on\ output.\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02041}\mbox{\hyperlink{cs_8c_a63f6ad02ef0d33f9166966af3756c4d6}{02041}}\ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ \mbox{\hyperlink{cs_8c_a63f6ad02ef0d33f9166966af3756c4d6}{cs\_utsolve}}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structcs__sparse}{cs}}\ *U,\ \textcolor{keywordtype}{double}\ *x)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02042}02042\ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02043}02043\ \ \ \ \ \mbox{\hyperlink{cs_8h_a95c7aeda659645c4dbdb55da86fddcc0}{csi}}\ p,\ j,\ n,\ *Up,\ *Ui\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02044}02044\ \ \ \ \ \textcolor{keywordtype}{double}\ *Ux\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02045}02045\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{cs_8h_a11fc95c9740a561d409f89b987d8072f}{CS\_CSC}}\ (U)\ ||\ !x)\ \textcolor{keywordflow}{return}\ (0)\ ;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ check\ inputs\ */}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02046}02046\ \ \ \ \ n\ =\ U-\/>\mbox{\hyperlink{structcs__sparse_ad9d0192b240c4ea51984ad0d09f56a02}{n}}\ ;\ Up\ =\ U-\/>\mbox{\hyperlink{structcs__sparse_a645e83714f71e7ab788ee75c6fc46dac}{p}}\ ;\ Ui\ =\ U-\/>\mbox{\hyperlink{structcs__sparse_a95cad038b1ec034f444ab517822040b1}{i}}\ ;\ Ux\ =\ U-\/>\mbox{\hyperlink{structcs__sparse_a0d6d06e4893a7d4d86e94ce49358d9c1}{x}}\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02047}02047\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0\ ;\ j\ <\ n\ ;\ j++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02048}02048\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02049}02049\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (p\ =\ Up\ [j]\ ;\ p\ <\ Up\ [j+1]-\/1\ ;\ p++)}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02050}02050\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02051}02051\ \ \ \ \ \ \ \ \ \ \ \ \ x\ [j]\ -\/=\ Ux\ [p]\ *\ x\ [Ui\ [p]]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02052}02052\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02053}02053\ \ \ \ \ \ \ \ \ x\ [j]\ /=\ Ux\ [Up\ [j+1]-\/1]\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02054}02054\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02055}02055\ \ \ \ \ \textcolor{keywordflow}{return}\ (1)\ ;}
\DoxyCodeLine{\Hypertarget{cs_8c_source_l02056}02056\ \}}

\end{DoxyCode}
