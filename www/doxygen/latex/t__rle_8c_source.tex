\doxysection{t\+\_\+rle.\+c}
\hypertarget{t__rle_8c_source}{}\label{t__rle_8c_source}\index{t\_rle.c@{t\_rle.c}}
\mbox{\hyperlink{t__rle_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00001}00001\ \textcolor{comment}{/*-\/-\/-\/-\/-\/-\/\ Definition\ of\ a\ template\ for\ Matrix\_rle\_[di](...)\ :\ *}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00002}00002\ \textcolor{comment}{\ *\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/\ \ \ \ \ \string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00003}00003\ \textcolor{comment}{\ *\ i.e.,\ included\ several\ times\ from\ ./abIndex.c}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00004}00004\ \textcolor{comment}{\ *\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \string~\string~\string~\string~\string~\string~\string~\string~\string~\string~\string~}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00005}00005\ \textcolor{comment}{\ */}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00007}00007\ \textcolor{comment}{/*\ for\ all\ cases\ with\ an\ 'x'\ slot\ -\/-\/\ i.e.\ almost\ all\ cases\ ;}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00008}00008\ \textcolor{comment}{\ *\ just\ redefine\ this\ in\ the\ other\ cases:}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00009}00009\ \textcolor{comment}{\ */}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00010}00010\ }
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00011}00011\ \textcolor{preprocessor}{\#ifdef\ \_rle\_d\_}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00013}00013\ \textcolor{preprocessor}{\#\ define\ Matrix\_RLE\_\ Matrix\_rle\_d}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00014}00014\ \textcolor{preprocessor}{\#\ define\ Type\_x\_\ double}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00015}00015\ \textcolor{preprocessor}{\#\ define\ STYP\_x\_\ REAL}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00016}00016\ \textcolor{preprocessor}{\#\ define\ SXP\_ans\ \ REALSXP}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00018}00018\ \textcolor{preprocessor}{\#elif\ defined\ \_rle\_i\_}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00019}00019\ }
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00020}00020\ \textcolor{preprocessor}{\#\ define\ Matrix\_RLE\_\ Matrix\_rle\_i}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00021}00021\ \textcolor{preprocessor}{\#\ define\ Type\_x\_\ int}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00022}00022\ \textcolor{preprocessor}{\#\ define\ STYP\_x\_\ INTEGER}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00023}00023\ \textcolor{preprocessor}{\#\ define\ SXP\_ans\ \ INTSXP}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00024}00024\ }
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00025}00025\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00026}00026\ \textcolor{preprocessor}{\#\ \ error\ "{}invalid\ \_rle\_\ macro\ logic"{}}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00027}00027\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00028}00028\ }
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00037}\mbox{\hyperlink{t__rle_8c_a846ddc6554134fb4f45e1185514b60da}{00037}}\ SEXP\ \mbox{\hyperlink{t__rle_8c_a846ddc6554134fb4f45e1185514b60da}{Matrix\_RLE\_}}(SEXP\ x\_,\ SEXP\ force\_)}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00038}00038\ \{}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00039}00039\ \ \ \ \ \textcolor{keywordtype}{int}\ n\ =\ LENGTH(PROTECT(x\_\ =\ Rf\_coerceVector(x\_,\ SXP\_ans)));}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00040}00040\ \ \ \ \ Rboolean\ no\_force\ =\ !Rf\_asLogical(force\_);}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00041}00041\ \ \ \ \ \textcolor{keywordflow}{if}\ (no\_force\ \&\&\ n\ <\ 3)\ \{}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00042}00042\ \ \ \ \ UNPROTECT(1);\ \textcolor{keywordflow}{return}\ R\_NilValue;}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00043}00043\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00044}00044\ \ \ \ \ \textcolor{keyword}{register}\ Type\_x\_\ lv;}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00045}00045\ \ \ \ \ \textcolor{keyword}{register}\ \textcolor{keywordtype}{int}\ ln,\ i,\ \mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00046}00046\ \ \ \ \ \textcolor{keywordtype}{int}\ n2\ =\ (no\_force)\ ?\ n\ /\ 3\ :\ n;}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00047}00047\ \ \ \ \ \textcolor{comment}{/*\ upper\ bound:\ ==>\ max\ RAM\ requirement\ 2\ x\ n2,\ (=\ 2/3\ n);}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00048}00048\ \textcolor{comment}{\ \ \ \ \ *\ using\ 2\ instead\ of\ 3\ would\ need\ 50\%\ more\ time,\ have\ max}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00049}00049\ \textcolor{comment}{\ \ \ \ \ *\ RAM\ requirement\ 2.5x\ for\ savings\ of\ any\ size\ */}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00050}00050\ \ \ \ \ Type\_x\_\ *x\ =\ STYP\_x\_(x\_),\ *val;}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00051}00051\ \ \ \ \ \textcolor{keywordtype}{int}\ *len;}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00052}00052\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *res\_nms[]\ =\ \{\textcolor{stringliteral}{"{}lengths"{}},\ \textcolor{stringliteral}{"{}values"{}},\ \textcolor{stringliteral}{"{}"{}}\};}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00053}00053\ \ \ \ \ SEXP\ ans;}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00054}00054\ \ \ \ \ \textcolor{keywordflow}{if}(n\ >\ 0)\ \{\ \textcolor{comment}{/*\ needed\ for\ force=TRUE\ */}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00055}00055\ \ \ \ \ \ \ \ \ len\ =\ R\_Calloc(n2,\ \textcolor{keywordtype}{int});}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00056}00056\ \ \ \ \ \ \ \ \ val\ =\ R\_Calloc(n2,\ Type\_x\_);}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00057}00057\ }
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00058}00058\ \ \ \ \ \ \ \ \ lv\ =\ x[0];}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00059}00059\ \ \ \ \ \ \ \ \ ln\ =\ 1;}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00060}00060\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(i\ =\ 1;\ i\ <\ n;\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00061}00061\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x[i]\ ==\ lv)\ \{}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00062}00062\ \ \ \ \ \ \ \ \ \ \ \ \ ln++;}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00063}00063\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ val[\mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}}]\ =\ lv;}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00065}00065\ \ \ \ \ \ \ \ \ \ \ \ \ len[\mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}}]\ =\ ln;}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00066}00066\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}}++;}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (no\_force\ \&\&\ \mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}}\ ==\ n2)\ \{\ \textcolor{comment}{/*\ reached\ the\ "{}efficiency\ bound"{}\ */}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \ \ R\_Free(len);}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00069}00069\ \ \ \ \ \ \ \ \ \ \ \ \ R\_Free(val);}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00070}00070\ \ \ \ \ \ \ \ \ \ \ \ \ UNPROTECT(1);\ \textcolor{keywordflow}{return}\ R\_NilValue;}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00071}00071\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00072}00072\ \ \ \ \ \ \ \ \ \ \ \ \ lv\ =\ x[i];}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \ \ \ ln\ =\ 1;}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00074}00074\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00075}00075\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00076}00076\ \ \ \ \ \ \ \ \ val[\mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}}]\ =\ lv;}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00077}00077\ \ \ \ \ \ \ \ \ len[\mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}}]\ =\ ln;}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00078}00078\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}}++;}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00079}00079\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00080}00080\ \ \ \ \ ans\ =\ PROTECT(Rf\_mkNamed(VECSXP,\ res\_nms));}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00081}00081\ \ \ \ \ SET\_VECTOR\_ELT(ans,\ 0,\ Rf\_allocVector(INTSXP,\ \mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}}));\ \textcolor{comment}{/*\ lengths\ */}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00082}00082\ \ \ \ \ SET\_VECTOR\_ELT(ans,\ 1,\ Rf\_allocVector(SXP\_ans,\ \mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}}));\ \textcolor{comment}{/*\ values\ */}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00083}00083\ \ \ \ \ \textcolor{keywordflow}{if}(n\ >\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00084}00084\ \ \ \ \ \ \ \ \ Memcpy(INTEGER(VECTOR\_ELT(ans,\ 0)),\ len,\ \mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}});}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00085}00085\ \ \ \ \ \ \ \ \ Memcpy(STYP\_x\_(VECTOR\_ELT(ans,\ 1)),\ val,\ \mbox{\hyperlink{cholmod-etc_8c_ac2b5dcf1f18e620b15b2e284dd9f6bd4}{c}});}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00086}00086\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00087}00087\ \ \ \ \ Rf\_setAttrib(ans,\ R\_ClassSymbol,\ Rf\_mkString(\textcolor{stringliteral}{"{}rle"{}}));}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00088}00088\ }
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00089}00089\ \ \ \ \ \textcolor{keywordflow}{if}(n\ >\ 0)\ \{\ R\_Free(len);\ R\_Free(val);\ \}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00090}00090\ \ \ \ \ UNPROTECT(2);}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00091}00091\ \ \ \ \ \textcolor{keywordflow}{return}\ ans;}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00092}00092\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00093}00093\ \}\ \textcolor{comment}{/*\ Matrix\_RLE\_()\ template\ */}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00094}00094\ }
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00095}00095\ \textcolor{preprocessor}{\#undef\ Matrix\_RLE\_}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00096}00096\ \textcolor{preprocessor}{\#undef\ Type\_x\_}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00097}00097\ \textcolor{preprocessor}{\#undef\ STYP\_x\_}}
\DoxyCodeLine{\Hypertarget{t__rle_8c_source_l00098}00098\ \textcolor{preprocessor}{\#undef\ SXP\_ans}}

\end{DoxyCode}
